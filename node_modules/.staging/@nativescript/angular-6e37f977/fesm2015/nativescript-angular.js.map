{"version":3,"file":"nativescript-angular.js","sources":["../../trace.ts","../../dom-adapter.ts","../../polyfills/console.ts","../../platform-providers.ts","../../app-host-view.ts","../../platform-common.ts","../../platform.ts","../../file-system/ns-file-system.ts","../../resource-loader.ts","../../lang-facade.ts","../../frame.service.ts","../../router/ns-location-utils.ts","../../router/ns-location-strategy.ts","../../common/detached-loader.ts","../../common/utils.ts","../../directives/dialogs.ts","../../element-registry.ts","../../directives/templated-items-comp.ts","../../directives/list-view-comp.ts","../../directives/tab-view.ts","../../directives/action-bar.ts","../../directives/platform-filters.ts","../../directives/index.ts","../../common.ts","../../view-util.ts","../../renderer.ts","../../renderer-emulated.ts","../../renderer-factory.ts","../../nativescript.module.ts","../../animations/utils.ts","../../animations/animation-player.ts","../../animations/animation-driver.ts","../../animations/animations.module.ts","../../http-client/http-utils.ts","../../http-client/ns-http-backend.ts","../../http-client/http-client.module.ts","../../forms/value-accessors/base-value-accessor.ts","../../forms/value-accessors/text-value-accessor.ts","../../forms/value-accessors/checked-value-accessor.ts","../../forms/value-accessors/date-value-accessor.ts","../../forms/value-accessors/time-value-accessor.ts","../../forms/value-accessors/number-value-accessor.ts","../../forms/value-accessors/selectedIndex-value-accessor.ts","../../forms/forms.module.ts","../../router/page-router-outlet-utils.ts","../../router/router-extensions.ts","../../router/ns-router-link.ts","../../router/private-imports/router-url-tree.ts","../../router/ns-router-link-active.ts","../../router/ns-route-reuse-strategy.ts","../../router/page-router-outlet.ts","../../router/ns-platform-location.ts","../../router/ns-empty-outlet.component.ts","../../router/ns-module-factory-loader.ts","../../router/router.module.ts","../../index.ts","../../nativescript-angular.ts"],"sourcesContent":["import { Trace } from '@nativescript/core';\n\nexport namespace NativeScriptDebug {\n\texport const animationsTraceCategory = 'ns-animations';\n\texport const rendererTraceCategory = 'ns-renderer';\n\texport const viewUtilCategory = 'ns-view-util';\n\texport const routerTraceCategory = 'ns-router';\n\texport const routeReuseStrategyTraceCategory = 'ns-route-reuse-strategy';\n\texport const listViewTraceCategory = 'ns-list-view';\n\texport const bootstrapCategory = 'bootstrap';\n\t// TODO: migrate all usage to this - avoids extraneous method executions\n\texport const enabled = Trace.isEnabled();\n\n\texport function isLogEnabled() {\n\t\treturn Trace.isEnabled();\n\t}\n\n\texport function animationsLog(message: string): void {\n\t\tTrace.write(message, animationsTraceCategory);\n\t}\n\n\texport function rendererLog(msg): void {\n\t\tTrace.write(msg, rendererTraceCategory);\n\t}\n\n\texport function rendererError(message: string): void {\n\t\tTrace.write(message, rendererTraceCategory, Trace.messageType.error);\n\t}\n\n\texport function viewUtilLog(msg): void {\n\t\tTrace.write(msg, viewUtilCategory);\n\t}\n\n\texport function routerLog(message: string): void {\n\t\tTrace.write(message, routerTraceCategory);\n\t}\n\n\texport function routerError(message: string): void {\n\t\tTrace.write(message, routerTraceCategory, Trace.messageType.error);\n\t}\n\n\texport function routeReuseStrategyLog(message: string): void {\n\t\tTrace.write(message, routeReuseStrategyTraceCategory);\n\t}\n\n\texport function styleError(message: string): void {\n\t\tTrace.write(message, Trace.categories.Style, Trace.messageType.error);\n\t}\n\n\texport function listViewLog(message: string): void {\n\t\tTrace.write(message, listViewTraceCategory);\n\t}\n\n\texport function listViewError(message: string): void {\n\t\tTrace.write(message, listViewTraceCategory, Trace.messageType.error);\n\t}\n\n\texport function bootstrapLog(message: string): void {\n\t\tTrace.write(message, bootstrapCategory);\n\t}\n\n\texport function bootstrapLogError(message: string): void {\n\t\tTrace.write(message, bootstrapCategory, Trace.messageType.error);\n\t}\n}\n","/* tslint:disable */\nimport { Type } from '@angular/core';\nimport { ɵDomAdapter, ɵsetRootDomAdapter } from '@angular/common';\nimport { NativeScriptDebug } from './trace';\n\nexport class NativeScriptDomAdapter implements ɵDomAdapter {\n\tstatic makeCurrent() {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog('Setting root DOM adapter...');\n\t\t}\n\n\t\tɵsetRootDomAdapter(new NativeScriptDomAdapter());\n\t}\n\n\thasProperty(_element: any, _name: string) {\n\t\t// TODO: actually check if the property exists.\n\t\treturn true;\n\t}\n\n\tlog(arg: any): void {\n\t\tconsole.log(arg);\n\t}\n\n\tlogError(arg: any): void {\n\t\tconsole.log(arg);\n\t}\n\n\tlogGroup(arg: any): void {\n\t\tconsole.log(arg);\n\t}\n\n\tlogGroupEnd(): void {}\n\n\tget attrToPropMap(): { [key: string]: string } {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tset attrToPropMap(_value: { [key: string]: string }) {\n\t\tthrow new Error('Not implemented!');\n\t}\n\n\tpublic resourceLoaderType: Type<any> = null;\n\tsetProperty(_el: Element, _name: string, _value: any): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetProperty(_el: Element, _name: string): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tinvoke(_el: Element, _methodName: string, _args: any[]): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\n\tcontains(_nodeA: any, _nodeB: any): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tparse(_templateHtml: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tquery(_selector: string): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tquerySelector(_el: any /** TODO #9100 */, _selector: string): HTMLElement {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tquerySelectorAll(_el: any /** TODO #9100 */, _selector: string): any[] {\n\t\tthrow new Error('Not implemented!');\n\t}\n\ton(_el: any /** TODO #9100 */, _evt: any /** TODO #9100 */, _listener: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tonAndCancel(_el: any /** TODO #9100 */, _evt: any /** TODO #9100 */, _listener: any /** TODO #9100 */): Function {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tdispatchEvent(_el: any /** TODO #9100 */, _evt: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateMouseEvent(_eventType: any /** TODO #9100 */): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateEvent(_eventType: string): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tpreventDefault(_evt: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tisPrevented(_evt: any /** TODO #9100 */): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetInnerHTML(_el: any /** TODO #9100 */): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\n\tgetTemplateContent(_el: any /** TODO #9100 */): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetOuterHTML(_el: any /** TODO #9100 */): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tnodeName(_node: any /** TODO #9100 */): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tnodeValue(_node: any /** TODO #9100 */): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\ttype(_node: any /** TODO #9100 */): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcontent(_node: any /** TODO #9100 */): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tfirstChild(_el: any /** TODO #9100 */): Node {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tnextSibling(_el: any /** TODO #9100 */): Node {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tparentElement(_el: any /** TODO #9100 */): Node {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tchildNodes(_el: any /** TODO #9100 */): Node[] {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tchildNodesAsList(_el: any /** TODO #9100 */): Node[] {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tclearNodes(_el: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tappendChild(_el: any /** TODO #9100 */, _node: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tremoveChild(_el: any /** TODO #9100 */, _node: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\treplaceChild(_el: any /** TODO #9100 */, _newNode: any /** TODO #9100 */, _oldNode: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tremove(_el: any /** TODO #9100 */): Node {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tinsertBefore(_el: any /** TODO #9100 */, _node: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tinsertAllBefore(_el: any /** TODO #9100 */, _nodes: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tinsertAfter(_el: any /** TODO #9100 */, _node: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsetInnerHTML(_el: any /** TODO #9100 */, _value: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetText(_el: any /** TODO #9100 */): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsetText(_el: any /** TODO #9100 */, _value: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetValue(_el: any /** TODO #9100 */): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsetValue(_el: any /** TODO #9100 */, _value: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetChecked(_el: any /** TODO #9100 */): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsetChecked(_el: any /** TODO #9100 */, _value: boolean): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateComment(_text: string): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateTemplate(_html: any /** TODO #9100 */): HTMLElement {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateElement(_tagName: any /** TODO #9100 */, _doc?: any /** TODO #9100 */): HTMLElement {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateElementNS(_ns: string, _tagName: string, _doc?: any /** TODO #9100 */): Element {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateTextNode(_text: string, _doc?: any /** TODO #9100 */): Text {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateScriptTag(_attrName: string, _attrValue: string, _doc?: any /** TODO #9100 */): HTMLElement {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateStyleElement(_css: string, _doc?: any /** TODO #9100 */): HTMLStyleElement {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateShadowRoot(_el: any /** TODO #9100 */): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetShadowRoot(_el: any /** TODO #9100 */): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetHost(_el: any /** TODO #9100 */): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetDistributedNodes(_el: any /** TODO #9100 */): Node[] {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tclone /*<T extends Node>*/(_node: Node /*T*/): Node /*T*/ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetElementsByClassName(_element: any /** TODO #9100 */, _name: string): HTMLElement[] {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetElementsByTagName(_element: any /** TODO #9100 */, _name: string): HTMLElement[] {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tclassList(_element: any /** TODO #9100 */): any[] {\n\t\tthrow new Error('Not implemented!');\n\t}\n\taddClass(_element: any /** TODO #9100 */, _className: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tremoveClass(_element: any /** TODO #9100 */, _className: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\thasClass(_element: any /** TODO #9100 */, _className: string): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsetStyle(_element: any /** TODO #9100 */, _styleName: string, _styleValue: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tremoveStyle(_element: any /** TODO #9100 */, _styleName: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetStyle(_element: any /** TODO #9100 */, _styleName: string): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\thasStyle(_element: any /** TODO #9100 */, _styleName: string, _styleValue?: string): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\ttagName(_element: any /** TODO #9100 */): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tattributeMap(_element: any /** TODO #9100 */): Map<string, string> {\n\t\tthrow new Error('Not implemented!');\n\t}\n\thasAttribute(_element: any /** TODO #9100 */, _attribute: string): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\thasAttributeNS(_element: any /** TODO #9100 */, _ns: string, _attribute: string): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetAttribute(_element: any /** TODO #9100 */, _attribute: string): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetAttributeNS(_element: any /** TODO #9100 */, _ns: string, _attribute: string): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsetAttribute(_element: any /** TODO #9100 */, _name: string, _value: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsetAttributeNS(_element: any /** TODO #9100 */, _ns: string, _name: string, _value: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tremoveAttribute(_element: any /** TODO #9100 */, _attribute: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tremoveAttributeNS(_element: any /** TODO #9100 */, _ns: string, _attribute: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\ttemplateAwareRoot(_el: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tcreateHtmlDocument(): HTMLDocument {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tdefaultDoc(): HTMLDocument {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetDefaultDocument(): Document {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetBoundingClientRect(_el: any /** TODO #9100 */): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetTitle(): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsetTitle(_doc: Document, _newTitle: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\telementMatches(_n: any /** TODO #9100 */, _selector: string): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tisTemplateElement(_el: any): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tisTextNode(_node: any /** TODO #9100 */): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tisCommentNode(_node: any /** TODO #9100 */): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tisElementNode(_node: any /** TODO #9100 */): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\thasShadowRoot(_node: any /** TODO #9100 */): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tisShadowRoot(_node: any /** TODO #9100 */): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\timportIntoDoc /*<T extends Node>*/(_node: Node /*T*/): Node /*T*/ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tadoptNode /*<T extends Node>*/(_node: Node /*T*/): Node /*T*/ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetHref(_element: any /** TODO #9100 */): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetEventKey(_event: any /** TODO #9100 */): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tresolveAndSetHref(_element: any /** TODO #9100 */, _baseUrl: string, _href: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsupportsDOMEvents(): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsupportsNativeShadowDOM(): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetGlobalEventTarget(_doc: Document, _target: string): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetHistory(): History {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetLocation(): Location {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetBaseHref(): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tresetBaseElement(): void {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetUserAgent(): string {\n\t\treturn 'Fake user agent';\n\t}\n\tsetData(_element: any /** TODO #9100 */, _name: string, _value: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetComputedStyle(_element: any /** TODO #9100 */): any {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetData(_element: any /** TODO #9100 */, _name: string): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsetGlobalVar(_name: string, _value: any): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsupportsWebAnimation(): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tperformanceNow(): number {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetAnimationPrefix(): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tgetTransitionEnd(): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsupportsAnimation(): boolean {\n\t\tthrow new Error('Not implemented!');\n\t}\n\n\tsupportsCookies(): boolean {\n\t\treturn false;\n\t}\n\tgetCookie(_name: string): string {\n\t\tthrow new Error('Not implemented!');\n\t}\n\tsetCookie(_name: string, _value: string): any /** TODO #9100 */ {\n\t\tthrow new Error('Not implemented!');\n\t}\n}\n\nNativeScriptDomAdapter.makeCurrent();\n","if (!console.group) {\n\tconsole.group = () => {};\n}\n\nif (!console.groupEnd) {\n\tconsole.groupEnd = () => {};\n}\n","import { InjectionToken, Injectable, OnDestroy } from '@angular/core';\n\nimport { Frame, View, Page, IDevice, Device } from '@nativescript/core';\n\nexport const APP_ROOT_VIEW = new InjectionToken<View>('NativeScriptAppRootView');\nexport const DeviceToken = new InjectionToken<IDevice>('NativeScriptPlatformDeviceToken');\n\nexport type PageFactory = (options: PageFactoryOptions) => Page;\nexport interface PageFactoryOptions {\n\tisBootstrap?: boolean;\n\tisLivesync?: boolean;\n\tisModal?: boolean;\n\tisNavigation?: boolean;\n\tcomponentType?: any;\n}\nexport const PAGE_FACTORY = new InjectionToken<PageFactory>('NativeScriptPageFactory');\nexport const defaultPageFactory: PageFactory = function (_opts: PageFactoryOptions) {\n\treturn new Page();\n};\nexport const defaultPageFactoryProvider = { provide: PAGE_FACTORY, useValue: defaultPageFactory };\n\nlet _rootPageRef: WeakRef<Page>;\n\nexport function setRootPage(page: Page): void {\n\t_rootPageRef = new WeakRef(page);\n}\n\nexport function getRootPage(): Page {\n\treturn _rootPageRef && _rootPageRef.get();\n}\n\n// Use an exported function to make the AoT compiler happy.\nexport function getDefaultPage(): Page {\n\tconst rootPage = getRootPage();\n\tif (rootPage instanceof Page) {\n\t\treturn rootPage;\n\t}\n\t// if (rootPage) {\n\t// \treturn rootPage;\n\t// }\n\n\tconst frame = Frame.topmost();\n\tif (frame && frame.currentPage) {\n\t\treturn frame.currentPage;\n\t}\n\n\treturn null;\n}\n\nexport const defaultPageProvider = { provide: Page, useFactory: getDefaultPage };\n\n// Use an exported function to make the AoT compiler happy.\nexport function getDefaultFrame(): Frame {\n\treturn Frame.topmost();\n}\n\nexport const defaultFrameProvider = { provide: Frame, useFactory: getDefaultFrame };\n\n// Use an exported function to make the AoT compiler happy.\nexport function getDefaultDevice(): IDevice {\n\treturn Device;\n}\n\nexport const defaultDeviceProvider = { provide: DeviceToken, useFactory: getDefaultDevice };\n","import { ContentView, View, ProxyViewContainer, GridLayout, Color } from '@nativescript/core';\n\nexport class AppHostView extends ContentView {\n\tprivate _ngAppRoot: View;\n\tprivate _content: View;\n\n\tconstructor(backgroundColor: Color) {\n\t\tsuper();\n\t\tthis.backgroundColor = backgroundColor;\n\t}\n\n\tget ngAppRoot(): View {\n\t\treturn this._ngAppRoot;\n\t}\n\n\tset ngAppRoot(value: View) {\n\t\tthis._ngAppRoot = value;\n\t}\n\n\tget content(): View {\n\t\treturn this._content;\n\t}\n\n\tset content(value: View) {\n\t\tif (this._content) {\n\t\t\tthis._content.parentNode = undefined;\n\t\t}\n\n\t\tthis._content = value;\n\n\t\tif (value) {\n\t\t\tthis._content.parentNode = <any>this;\n\t\t}\n\n\t\tthis.ngAppRoot = value;\n\n\t\tif (this._content instanceof ProxyViewContainer) {\n\t\t\tconst grid = new GridLayout();\n\t\t\tgrid.backgroundColor = this.backgroundColor;\n\t\t\tgrid.addChild(this._content);\n\t\t\tthis.ngAppRoot = grid;\n\t\t}\n\t}\n}\n\nexport class AppHostAsyncView extends GridLayout {\n\tconstructor(backgroundColor: Color) {\n\t\tsuper();\n\t\tthis.backgroundColor = backgroundColor;\n\t}\n\n\tget ngAppRoot(): View {\n\t\treturn this;\n\t}\n\n\tset ngAppRoot(value: View) {\n\t\t// ignored\n\t}\n}\n","import { Application, TextView, Color, View, Frame, GridLayout, LaunchEventData, ApplicationEventData, profile, profilingUptime, Page, LayoutBase } from '@nativescript/core';\n// import './dom-adapter';\n// import 'nativescript-intl';\n\nimport { Type, Injector, CompilerOptions, PlatformRef, NgModuleFactory, NgModuleRef, EventEmitter, Sanitizer, InjectionToken, StaticProvider } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\n\nimport { NativeScriptDebug } from './trace';\nimport { defaultPageFactoryProvider, setRootPage, PageFactory, PAGE_FACTORY, getRootPage } from './platform-providers';\nimport { AppHostView, AppHostAsyncView } from './app-host-view';\n\nexport const onBeforeLivesync = new EventEmitter<NgModuleRef<any>>();\nexport const onAfterLivesync = new EventEmitter<{\n\tmoduleRef?: NgModuleRef<any>;\n\terror?: Error;\n}>();\nlet lastBootstrappedModule: WeakRef<NgModuleRef<any>>;\ntype BootstrapperAction = () => Promise<NgModuleRef<any>>;\n\n// Work around a TS bug requiring an import of OpaqueToken without using it\n// if ((<any>global).___TS_UNUSED) {\n//     (() => {\n//         return InjectionToken;\n//     })();\n// }\n\n// tslint:disable:max-line-length\n/**\n * Options to be passed when HMR is enabled\n */\nexport interface HmrOptions {\n\t/**\n\t * A factory function that returns either Module type or NgModuleFactory type.\n\t * This needs to be a factory function as the types will change when modules are replaced.\n\t */\n\tmoduleTypeFactory?: () => Type<any> | NgModuleFactory<any>;\n\n\t/**\n\t * A livesync callback that will be called instead of the original livesync.\n\t * It gives the HMR a hook to apply the module replacement.\n\t * @param bootstrapPlatform - A bootstrap callback to be called after HMR is done. It will bootstrap a new angular app within the exisiting platform, using the moduleTypeFactory to get the Module or NgModuleFactory to be used.\n\t */\n\tlivesyncCallback: (bootstrapPlatform: () => void) => void;\n}\n// tslint:enable:max-line-length\n\nexport interface AppLaunchView extends LayoutBase {\n\t// called when the animation is to begin\n\tstartAnimation?: () => void;\n\t// called when bootstrap is complete and cleanup can begin\n\t// should resolve when animation is completely finished\n\tcleanup?: () => Promise<any>;\n}\n\nexport interface AppOptions {\n\tbootInExistingPage?: boolean;\n\tcssFile?: string;\n\tstartPageActionBarHidden?: boolean;\n\thmrOptions?: HmrOptions;\n\t/**\n\t * Background color of the root view\n\t */\n\tbackgroundColor?: string;\n\t/**\n\t * Use animated launch view (async by default)\n\t */\n\tlaunchView?: AppLaunchView;\n\t/**\n\t * When using Async APP_INITIALIZER, set this to `true`.\n\t * (Not needed when using launchView)\n\t */\n\tasync?: boolean;\n}\n\nexport type PlatformFactory = (extraProviders?: StaticProvider[]) => PlatformRef;\n\nexport class NativeScriptSanitizer extends Sanitizer {\n\tsanitize(_context: any, value: string): string {\n\t\treturn value;\n\t}\n}\n\nexport class NativeScriptDocument {\n\t// Required by the AnimationDriver\n\tpublic body: any = {\n\t\tisOverride: true,\n\t};\n\n\tcreateElement(tag: string) {\n\t\tthrow new Error('NativeScriptDocument is not DOM Document. There is no createElement() method.');\n\t}\n}\n\nexport const COMMON_PROVIDERS = [defaultPageFactoryProvider, { provide: Sanitizer, useClass: NativeScriptSanitizer, deps: [] }, { provide: DOCUMENT, useClass: NativeScriptDocument, deps: [] }];\n\nexport class NativeScriptPlatformRef extends PlatformRef {\n\tprivate _bootstrapper: BootstrapperAction;\n\n\tconstructor(private platform: PlatformRef, private appOptions: AppOptions = {}) {\n\t\tsuper();\n\t}\n\n\t@profile\n\tbootstrapModuleFactory<M>(moduleFactory: NgModuleFactory<M>): Promise<NgModuleRef<M>> {\n\t\tthis._bootstrapper = () => {\n\t\t\tlet bootstrapFactory = moduleFactory;\n\t\t\tif (this.appOptions.hmrOptions) {\n\t\t\t\tbootstrapFactory = <NgModuleFactory<M>>this.appOptions.hmrOptions.moduleTypeFactory();\n\t\t\t}\n\n\t\t\treturn this.platform.bootstrapModuleFactory(bootstrapFactory);\n\t\t};\n\n\t\tthis.bootstrapApp();\n\n\t\treturn null; // Make the compiler happy\n\t}\n\n\t@profile\n\tbootstrapModule<M>(moduleType: Type<M>, compilerOptions: CompilerOptions | CompilerOptions[] = []): Promise<NgModuleRef<M>> {\n\t\tthis._bootstrapper = () => {\n\t\t\tlet bootstrapType = moduleType;\n\t\t\tif (this.appOptions.hmrOptions) {\n\t\t\t\tbootstrapType = <Type<M>>this.appOptions.hmrOptions.moduleTypeFactory();\n\t\t\t}\n\n\t\t\treturn this.platform.bootstrapModule(bootstrapType, compilerOptions);\n\t\t};\n\t\tthis.bootstrapApp();\n\n\t\treturn null; // Make the compiler happy\n\t}\n\n\t@profile\n\tprivate bootstrapApp() {\n\t\t(<any>global).__onLiveSyncCore = () => {\n\t\t\tif (this.appOptions.hmrOptions) {\n\t\t\t\tconst rootView = Application.getRootView();\n\t\t\t\tif (rootView) {\n\t\t\t\t\trootView._closeAllModalViewsInternal();\n\t\t\t\t}\n\n\t\t\t\tthis.appOptions.hmrOptions.livesyncCallback(() => this._livesync());\n\t\t\t} else {\n\t\t\t\tthis._livesync();\n\t\t\t}\n\t\t};\n\n\t\tif (this.appOptions && typeof this.appOptions.cssFile === 'string') {\n\t\t\tApplication.setCssFileName(this.appOptions.cssFile);\n\t\t}\n\n\t\tthis.bootstrapNativeScriptApp();\n\t}\n\n\tonDestroy(callback: () => void): void {\n\t\tthis.platform.onDestroy(callback);\n\t}\n\n\tget injector(): Injector {\n\t\treturn this.platform.injector;\n\t}\n\n\tdestroy(): void {\n\t\tthis.platform.destroy();\n\t}\n\n\tget destroyed(): boolean {\n\t\treturn this.platform.destroyed;\n\t}\n\n\t@profile\n\tprivate bootstrapNativeScriptApp() {\n\t\tlet rootContent: View;\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.bootstrapLog('NativeScriptPlatform bootstrap started.');\n\t\t}\n\t\tconst launchCallback = profile('@nativescript/angular/platform-common.launchCallback', (args: LaunchEventData) => {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.bootstrapLog('Application launch event fired');\n\t\t\t}\n\n\t\t\t// Create a temp page for root of the renderer\n\t\t\tlet tempAppHostView: AppHostView;\n\t\t\tlet tempAppHostAsyncView: AppHostAsyncView;\n\t\t\tif (this.appOptions && (this.appOptions.async || this.appOptions.launchView)) {\n\t\t\t\ttempAppHostAsyncView = new AppHostAsyncView(new Color(this.appOptions && this.appOptions.backgroundColor ? this.appOptions.backgroundColor : '#fff'));\n\t\t\t\tif (this.appOptions.launchView) {\n\t\t\t\t\tthis.appOptions.launchView.style.zIndex = 1000;\n\t\t\t\t\ttempAppHostAsyncView.addChild(this.appOptions.launchView);\n\t\t\t\t}\n\t\t\t\trootContent = tempAppHostAsyncView.ngAppRoot;\n\t\t\t\tsetRootPage(<any>tempAppHostAsyncView);\n\t\t\t} else {\n\t\t\t\ttempAppHostView = new AppHostView(new Color(this.appOptions && this.appOptions.backgroundColor ? this.appOptions.backgroundColor : '#fff'));\n\t\t\t\tsetRootPage(<any>tempAppHostView);\n\t\t\t}\n\n\t\t\tlet bootstrapPromiseCompleted = false;\n\t\t\tconst bootstrap = () => {\n\t\t\t\tthis._bootstrapper().then(\n\t\t\t\t\t(moduleRef) => {\n\t\t\t\t\t\tbootstrapPromiseCompleted = true;\n\t\t\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\t\t\tNativeScriptDebug.bootstrapLog(`Angular bootstrap bootstrap done. uptime: ${profilingUptime()}`);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.appOptions.launchView && this.appOptions.launchView.cleanup) {\n\t\t\t\t\t\t\tthis.appOptions.launchView.cleanup().then(() => {\n\t\t\t\t\t\t\t\t// cleanup any custom launch views\n\t\t\t\t\t\t\t\ttempAppHostAsyncView.removeChild(this.appOptions.launchView);\n\t\t\t\t\t\t\t\tthis.appOptions.launchView = null;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (tempAppHostView) {\n\t\t\t\t\t\t\trootContent = tempAppHostView.content;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlastBootstrappedModule = new WeakRef(moduleRef);\n\t\t\t\t\t},\n\t\t\t\t\t(err) => {\n\t\t\t\t\t\tbootstrapPromiseCompleted = true;\n\t\t\t\t\t\tconst errorMessage = err.message + '\\n\\n' + err.stack;\n\t\t\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\t\t\tNativeScriptDebug.bootstrapLogError('ERROR BOOTSTRAPPING ANGULAR');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\t\t\tNativeScriptDebug.bootstrapLogError(errorMessage);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trootContent = this.createErrorUI(errorMessage);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\tNativeScriptDebug.bootstrapLog('bootstrapAction called, draining micro tasks queue. Root: ' + rootContent);\n\t\t\t\t}\n\t\t\t\t(<any>global).Zone.drainMicroTaskQueue();\n\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\tNativeScriptDebug.bootstrapLog('bootstrapAction called, draining micro tasks queue finished! Root: ' + rootContent);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (this.appOptions && this.appOptions.launchView && this.appOptions.launchView.startAnimation) {\n\t\t\t\t// start animations on next tick (after initial boot)\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t// ensure launch animation is executed after launchView added to view stack\n\t\t\t\t\tthis.appOptions.launchView.startAnimation();\n\t\t\t\t});\n\t\t\t}\n\t\t\tbootstrap();\n\t\t\t// if (!bootstrapPromiseCompleted) {\n\t\t\t// \tconst errorMessage = \"Bootstrap promise didn't resolve\";\n\t\t\t// \tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t// \t\tNativeScriptDebug.bootstrapLogError(errorMessage);\n\t\t\t// \t}\n\t\t\t// \trootContent = this.createErrorUI(errorMessage);\n\t\t\t// }\n\t\t\targs.root = rootContent;\n\t\t});\n\t\tconst exitCallback = profile('@nativescript/angular/platform-common.exitCallback', (args: ApplicationEventData) => {\n\t\t\tconst androidActivity = args.android;\n\t\t\tif (androidActivity && !androidActivity.isFinishing()) {\n\t\t\t\t// Exit event was triggered as a part of a restart of the app.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst lastModuleRef = lastBootstrappedModule ? lastBootstrappedModule.get() : null;\n\t\t\tif (lastModuleRef) {\n\t\t\t\t// Make sure the module is only destroyed once\n\t\t\t\tlastBootstrappedModule = null;\n\n\t\t\t\tlastModuleRef.destroy();\n\t\t\t}\n\n\t\t\trootContent = null;\n\t\t});\n\n\t\tApplication.on(Application.launchEvent, launchCallback);\n\t\tApplication.on(Application.exitEvent, exitCallback);\n\n\t\tApplication.run();\n\t}\n\n\t@profile\n\tpublic _livesync() {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.bootstrapLog('Angular livesync started.');\n\t\t}\n\n\t\tconst lastModuleRef = lastBootstrappedModule ? lastBootstrappedModule.get() : null;\n\t\tonBeforeLivesync.next(lastModuleRef);\n\t\tif (lastModuleRef) {\n\t\t\tlastModuleRef.destroy();\n\t\t}\n\n\t\tthis._bootstrapper().then(\n\t\t\t(moduleRef) => {\n\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\tNativeScriptDebug.bootstrapLog('Angular livesync done.');\n\t\t\t\t}\n\t\t\t\tonAfterLivesync.next({ moduleRef });\n\n\t\t\t\tlastBootstrappedModule = new WeakRef(moduleRef);\n\t\t\t\tApplication.resetRootView({\n\t\t\t\t\tcreate: () => getRootPage(),\n\t\t\t\t});\n\t\t\t},\n\t\t\t(error) => {\n\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\tNativeScriptDebug.bootstrapLogError('ERROR LIVESYNC BOOTSTRAPPING ANGULAR');\n\t\t\t\t}\n\t\t\t\tconst errorMessage = error.message + '\\n\\n' + error.stack;\n\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\tNativeScriptDebug.bootstrapLogError(errorMessage);\n\t\t\t\t}\n\n\t\t\t\tApplication.resetRootView({\n\t\t\t\t\tcreate: () => this.createErrorUI(errorMessage),\n\t\t\t\t});\n\t\t\t\tonAfterLivesync.next({ error });\n\t\t\t}\n\t\t);\n\t}\n\n\tprivate createErrorUI(message: string): View {\n\t\tconst errorTextBox = new TextView();\n\t\terrorTextBox.text = message;\n\t\terrorTextBox.color = new Color('red');\n\t\treturn errorTextBox;\n\t}\n\n\tprivate createFrameAndPage(isLivesync: boolean) {\n\t\tconst frame = new Frame();\n\t\tconst pageFactory: PageFactory = this.platform.injector.get(PAGE_FACTORY);\n\t\tconst page = pageFactory({ isBootstrap: true, isLivesync });\n\n\t\tframe.navigate({\n\t\t\tcreate: () => {\n\t\t\t\treturn page;\n\t\t\t},\n\t\t});\n\t\treturn { page, frame };\n\t}\n}\n","import { PlatformRef, platformCore, createPlatformFactory } from '@angular/core';\n\nimport { NativeScriptPlatformRef, AppOptions, PlatformFactory, COMMON_PROVIDERS } from './platform-common';\n\n// \"Static\" platform\nconst _platformNativeScript: PlatformFactory = createPlatformFactory(platformCore, 'nativeScript', [...COMMON_PROVIDERS]);\n\nexport function platformNativeScriptDynamic(options?: AppOptions, extraProviders?: any[]): PlatformRef {\n\t// Return raw platform to advanced users only if explicitly requested\n\tif (options && options.bootInExistingPage === true) {\n\t\treturn _platformNativeScript(extraProviders);\n\t} else {\n\t\treturn new NativeScriptPlatformRef(_platformNativeScript(extraProviders), options);\n\t}\n}\n","import { Injectable } from '@angular/core';\nimport { knownFolders, Folder, File } from '@nativescript/core';\n\n// Allows greater flexibility with `file-system` and Angular\n// Also provides a way for `file-system` to be mocked for testing\n\n@Injectable()\nexport class NSFileSystem {\n\tpublic currentApp(): Folder {\n\t\treturn knownFolders.currentApp();\n\t}\n\n\tpublic fileFromPath(path: string): File {\n\t\treturn File.fromPath(path);\n\t}\n\n\tpublic fileExists(path: string): boolean {\n\t\treturn File.exists(path);\n\t}\n}\n","import { Injectable } from '@angular/core';\nimport { ResourceLoader } from '@angular/compiler';\nimport { path } from '@nativescript/core';\n\nimport { NSFileSystem } from './file-system/ns-file-system';\n\nconst sourceExtensionsMap = {\n\t'.scss': '.css',\n\t'.sass': '.css',\n\t'.less': '.css',\n};\n\n@Injectable()\nexport class FileSystemResourceLoader extends ResourceLoader {\n\tconstructor(private fs: NSFileSystem) {\n\t\tsuper();\n\t}\n\n\tget(url: string): string {\n\t\tconst resolvedPath = this.resolve(url);\n\n\t\tconst templateFile = this.fs.fileFromPath(resolvedPath);\n\n\t\treturn templateFile.readTextSync();\n\t}\n\n\tresolve(url: string): string {\n\t\tconst normalizedSourceUrl = this.resolveRelativeUrls(url);\n\t\tconst normalizedCompiledFileUrl = normalizedSourceUrl.replace(/\\.\\w+$/, (ext) => sourceExtensionsMap[ext] || ext);\n\t\tif (normalizedCompiledFileUrl !== normalizedSourceUrl && this.fs.fileExists(normalizedCompiledFileUrl)) {\n\t\t\treturn normalizedCompiledFileUrl;\n\t\t}\n\t\tif (this.fs.fileExists(normalizedSourceUrl)) {\n\t\t\treturn normalizedSourceUrl;\n\t\t}\n\n\t\tif (normalizedCompiledFileUrl === normalizedSourceUrl) {\n\t\t\tthrow new Error(`Could not resolve ${url}. Looked for: ${normalizedSourceUrl}.`);\n\t\t} else {\n\t\t\tthrow new Error(`Could not resolve ${url}.` + `Looked for: ${normalizedCompiledFileUrl}, ${normalizedSourceUrl}.`);\n\t\t}\n\t}\n\n\tprivate resolveRelativeUrls(url: string): string {\n\t\t// Angular assembles absolute URLs and prefixes them with //\n\t\tif (url.indexOf('/') !== 0) {\n\t\t\t// Resolve relative URLs based on the app root.\n\t\t\treturn path.join(this.fs.currentApp().path, url);\n\t\t} else {\n\t\t\treturn url;\n\t\t}\n\t}\n}\n","export function isPresent(obj: any): boolean {\n\treturn obj !== undefined && obj !== null;\n}\n\nexport function isBlank(obj: any): boolean {\n\treturn obj === undefined || obj === null;\n}\n","import { Injectable } from '@angular/core';\nimport { Frame } from '@nativescript/core';\n\n@Injectable({\n\tprovidedIn: 'root',\n})\nexport class FrameService {\n\t// TODO: Add any methods that are needed to handle frame/page navigation\n\tgetFrame(): Frame {\n\t\tlet topmostFrame = Frame.topmost();\n\t\treturn topmostFrame;\n\t}\n}\n","import { Frame, NavigationTransition } from '@nativescript/core';\nimport { DefaultUrlSerializer, UrlSegmentGroup, UrlTree, ActivatedRouteSnapshot, Params } from '@angular/router';\n\nexport interface LocationState {\n\tqueryParams: Params;\n\tsegmentGroup: UrlSegmentGroup;\n\tisRootSegmentGroup: boolean;\n\tisPageNavigation: boolean;\n\tframe?: Frame;\n}\n\nexport interface NavigationOptions {\n\tclearHistory?: boolean;\n\tanimated?: boolean;\n\ttransition?: NavigationTransition;\n}\n\nexport class Outlet {\n\tshowingModal: boolean;\n\tmodalNavigationDepth: number;\n\tparent: Outlet;\n\tisPageNavigationBack: boolean;\n\n\t// More than one key available when using NSEmptyOutletComponent component\n\t// in module that lazy loads children (loadChildren) and has outlet name.\n\toutletKeys: Array<string>;\n\n\t// More than one frame available when using NSEmptyOutletComponent component\n\t// in module that lazy loads children (loadChildren) and has outlet name.\n\tframes: Array<Frame> = [];\n\t// The url path to the Outlet.\n\t// E.G: the path to Outlet3 that is nested Outlet1(home)->Outlet2(nested1)->Outlet3(nested2)\n\t// will be 'home/nested1'\n\tpath: string;\n\tpathByOutlets: string;\n\tstates: Array<LocationState> = [];\n\tisNSEmptyOutlet: boolean;\n\n\t// Used in reuse-strategy by its children to determine if they should be detached too.\n\tshouldDetach: boolean = true;\n\tconstructor(outletKey: string, path: string, pathByOutlets: string, modalNavigationDepth?: number) {\n\t\tthis.outletKeys = [outletKey];\n\t\tthis.isPageNavigationBack = false;\n\t\tthis.showingModal = false;\n\t\tthis.modalNavigationDepth = modalNavigationDepth || 0;\n\t\tthis.pathByOutlets = pathByOutlets;\n\t\tthis.path = path;\n\t}\n\n\tcontainsFrame(frame: Frame): boolean {\n\t\treturn this.frames.indexOf(frame) > -1;\n\t}\n\n\tpeekState(): LocationState {\n\t\tif (this.states.length > 0) {\n\t\t\treturn this.states[this.states.length - 1];\n\t\t}\n\t\treturn null;\n\t}\n\n\tcontainsTopState(stateUrl: string): boolean {\n\t\tconst lastState = this.peekState();\n\t\treturn lastState && lastState.segmentGroup.toString() === stateUrl;\n\t}\n\n\t// Search for frame that can go back.\n\t// Nested 'primary' outlets could result in Outlet with multiple navigatable frames.\n\tgetFrameToBack(): Frame {\n\t\tlet frame = this.frames[this.frames.length - 1];\n\n\t\tif (!this.isNSEmptyOutlet) {\n\t\t\tfor (let index = this.frames.length - 1; index >= 0; index--) {\n\t\t\t\tconst currentFrame = this.frames[index];\n\t\t\t\tif (currentFrame.canGoBack()) {\n\t\t\t\t\tframe = currentFrame;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn frame;\n\t}\n}\n\nexport const defaultNavOptions: NavigationOptions = {\n\tclearHistory: false,\n\tanimated: true,\n};\n","import { Injectable } from '@angular/core';\nimport { LocationStrategy } from '@angular/common';\nimport { DefaultUrlSerializer, UrlSegmentGroup, UrlTree, ActivatedRouteSnapshot, Params } from '@angular/router';\nimport { Frame } from '@nativescript/core';\nimport { NativeScriptDebug } from '../trace';\nimport { isPresent } from '../lang-facade';\nimport { FrameService } from '../frame.service';\nimport { Outlet, NavigationOptions, LocationState, defaultNavOptions } from './ns-location-utils';\n\n@Injectable({\n\tprovidedIn: 'root',\n})\nexport class NSLocationStrategy extends LocationStrategy {\n\tprivate outlets: Array<Outlet> = [];\n\tprivate currentOutlet: Outlet;\n\n\tprivate popStateCallbacks = new Array<(_: any) => any>();\n\tprivate _currentNavigationOptions: NavigationOptions;\n\tprivate currentUrlTree: UrlTree;\n\n\tpublic _modalNavigationDepth = 0;\n\n\tconstructor(private frameService: FrameService) {\n\t\tsuper();\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.constructor()');\n\t\t}\n\t}\n\n\tpath(): string {\n\t\tif (!this.currentUrlTree) {\n\t\t\treturn '/';\n\t\t}\n\n\t\tconst state = this.currentOutlet && this.currentOutlet.peekState();\n\t\tif (!state) {\n\t\t\treturn '/';\n\t\t}\n\n\t\tlet tree = this.currentUrlTree;\n\t\tlet changedOutlet = this.getSegmentGroupByOutlet(this.currentOutlet);\n\n\t\t// Handle case where the user declares a component at path \"/\".\n\t\t// The url serializer doesn't parse this url as having a primary outlet.\n\t\tif (state.isRootSegmentGroup) {\n\t\t\ttree.root = state.segmentGroup;\n\t\t} else if (changedOutlet) {\n\t\t\tthis.updateSegmentGroup(tree.root, changedOutlet, state.segmentGroup);\n\t\t}\n\n\t\tconst urlSerializer = new DefaultUrlSerializer();\n\t\ttree.queryParams = state.queryParams;\n\t\tconst url = urlSerializer.serialize(tree);\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.path(): ' + url);\n\t\t}\n\t\treturn url;\n\t}\n\n\tprepareExternalUrl(internal: string): string {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.prepareExternalUrl() internal: ' + internal);\n\t\t}\n\t\treturn internal;\n\t}\n\n\tpushState(state: any, title: string, url: string, queryParams: string): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.pushState state: ' + `${state}, title: ${title}, url: ${url}, queryParams: ${queryParams}`);\n\t\t}\n\t\tthis.pushStateInternal(state, title, url, queryParams);\n\t}\n\n\tpushStateInternal(state: any, title: string, url: string, queryParams: string): void {\n\t\tconst urlSerializer = new DefaultUrlSerializer();\n\t\tthis.currentUrlTree = urlSerializer.parse(url);\n\t\tconst urlTreeRoot = this.currentUrlTree.root;\n\n\t\t// Handle case where the user declares a component at path \"/\".\n\t\t// The url serializer doesn't parse this url as having a primary outlet.\n\t\tif (!Object.keys(urlTreeRoot.children).length) {\n\t\t\tconst segmentGroup = this.currentUrlTree && this.currentUrlTree.root;\n\t\t\tconst outletKey = this.getOutletKey(this.getSegmentGroupFullPath(segmentGroup), 'primary');\n\t\t\tconst outlet = this.findOutlet(outletKey);\n\n\t\t\tif (outlet && this.updateStates(outlet, segmentGroup, this.currentUrlTree.queryParams)) {\n\t\t\t\tthis.currentOutlet = outlet; // If states updated\n\t\t\t} else if (!outlet) {\n\t\t\t\t// tslint:disable-next-line:max-line-length\n\t\t\t\tconst rootOutlet = this.createOutlet('primary', null, segmentGroup, null, null, this.currentUrlTree.queryParams);\n\t\t\t\tthis.currentOutlet = rootOutlet;\n\t\t\t}\n\n\t\t\tthis.currentOutlet.peekState().isRootSegmentGroup = true;\n\t\t\treturn;\n\t\t}\n\n\t\tconst queue = [];\n\t\tlet currentTree = <any>urlTreeRoot;\n\n\t\twhile (currentTree) {\n\t\t\tObject.keys(currentTree.children).forEach((outletName) => {\n\t\t\t\tconst currentSegmentGroup = currentTree.children[outletName];\n\t\t\t\tcurrentSegmentGroup.outlet = outletName;\n\t\t\t\tcurrentSegmentGroup.root = urlTreeRoot;\n\n\t\t\t\tconst outletPath = this.getSegmentGroupFullPath(currentTree);\n\t\t\t\tlet outletKey = this.getOutletKey(outletPath, outletName);\n\t\t\t\tlet outlet = this.findOutlet(outletKey);\n\n\t\t\t\tconst parentOutletName = currentTree.outlet || '';\n\t\t\t\tconst parentOutletPath = this.getSegmentGroupFullPath(currentTree.parent);\n\t\t\t\tconst parentOutletKey = this.getOutletKey(parentOutletPath, parentOutletName);\n\t\t\t\tconst parentOutlet = this.findOutlet(parentOutletKey);\n\n\t\t\t\tconst containsLastState = outlet && outlet.containsTopState(currentSegmentGroup.toString());\n\t\t\t\tif (!outlet) {\n\t\t\t\t\t// tslint:disable-next-line:max-line-length\n\t\t\t\t\toutlet = this.createOutlet(outletKey, outletPath, currentSegmentGroup, parentOutlet, this._modalNavigationDepth, this.currentUrlTree.queryParams);\n\t\t\t\t\tthis.currentOutlet = outlet;\n\t\t\t\t} else if (this._modalNavigationDepth > 0 && outlet.showingModal && !containsLastState) {\n\t\t\t\t\t// Navigation inside modal view.\n\t\t\t\t\tthis.upsertModalOutlet(outlet, currentSegmentGroup, this.currentUrlTree.queryParams);\n\t\t\t\t} else {\n\t\t\t\t\toutlet.parent = parentOutlet;\n\n\t\t\t\t\tif (this.updateStates(outlet, currentSegmentGroup, this.currentUrlTree.queryParams)) {\n\t\t\t\t\t\tthis.currentOutlet = outlet; // If states updated\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tqueue.push(currentSegmentGroup);\n\t\t\t});\n\n\t\t\tcurrentTree = queue.shift();\n\t\t}\n\t}\n\n\treplaceState(state: any, title: string, url: string, queryParams: string): void {\n\t\tconst states = this.currentOutlet && this.currentOutlet.states;\n\n\t\tif (states && states.length > 0) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.replaceState changing existing state: ' + `${state}, title: ${title}, url: ${url}, queryParams: ${queryParams}`);\n\t\t\t}\n\t\t} else {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.replaceState pushing new state: ' + `${state}, title: ${title}, url: ${url}, queryParams: ${queryParams}`);\n\t\t\t}\n\t\t\tthis.pushStateInternal(state, title, url, queryParams);\n\t\t}\n\t}\n\n\tforward(): void {\n\t\tthrow new Error('NSLocationStrategy.forward() - not implemented');\n\t}\n\n\tback(outlet?: Outlet, frame?: Frame): void {\n\t\tthis.currentOutlet = outlet || this.currentOutlet;\n\n\t\tif (this.currentOutlet.isPageNavigationBack) {\n\t\t\tconst states = this.currentOutlet.states;\n\t\t\t// We are navigating to the previous page\n\t\t\t// clear the stack until we get to a page navigation state\n\t\t\tlet state = states.pop();\n\t\t\tlet count = 1;\n\n\t\t\tif (frame) {\n\t\t\t\twhile (state.frame && state.frame !== frame) {\n\t\t\t\t\tstate = states.pop();\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twhile (!state.isPageNavigation) {\n\t\t\t\tstate = states.pop();\n\t\t\t\tcount++;\n\t\t\t}\n\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerLog(`NSLocationStrategy.back() while navigating back. States popped: ${count}`);\n\t\t\t}\n\t\t\tthis.callPopState(state, true);\n\t\t} else {\n\t\t\tlet state = this.currentOutlet.peekState();\n\t\t\tif (state && state.isPageNavigation) {\n\t\t\t\t// This was a page navigation - so navigate through frame.\n\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.back() while not navigating back but top' + ' state is page - will call frame.goBack()');\n\t\t\t\t}\n\n\t\t\t\tif (!outlet) {\n\t\t\t\t\tconst topmostFrame = this.frameService.getFrame();\n\t\t\t\t\tthis.currentOutlet = this.getOutletByFrame(topmostFrame) || this.currentOutlet;\n\t\t\t\t}\n\n\t\t\t\tconst frameToBack: Frame = this.currentOutlet.getFrameToBack();\n\t\t\t\tif (frameToBack) {\n\t\t\t\t\tframeToBack.goBack();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Nested navigation - just pop the state\n\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.back() while not navigating back but top' + ' state is not page - just pop');\n\t\t\t\t}\n\n\t\t\t\tthis.callPopState(this.currentOutlet.states.pop(), true);\n\t\t\t}\n\t\t}\n\t}\n\n\tcanGoBack(outlet?: Outlet) {\n\t\toutlet = outlet || this.currentOutlet;\n\t\treturn outlet.states.length > 1;\n\t}\n\n\tonPopState(fn: (_: any) => any): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.onPopState');\n\t\t}\n\t\tthis.popStateCallbacks.push(fn);\n\t}\n\n\tgetBaseHref(): string {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.getBaseHref()');\n\t\t}\n\t\treturn '';\n\t}\n\n\tprivate callPopState(state: LocationState, pop: boolean = true, outlet?: Outlet) {\n\t\toutlet = outlet || this.currentOutlet;\n\t\tconst urlSerializer = new DefaultUrlSerializer();\n\t\tlet changedOutlet = this.getSegmentGroupByOutlet(outlet);\n\n\t\tif (state && changedOutlet) {\n\t\t\tthis.updateSegmentGroup(this.currentUrlTree.root, changedOutlet, state.segmentGroup);\n\t\t} else if (changedOutlet) {\n\t\t\t// when closing modal view there are scenarios (e.g. root viewContainerRef) when we need\n\t\t\t// to clean up the named page router outlet to make sure we will open the modal properly again if needed.\n\t\t\tthis.updateSegmentGroup(this.currentUrlTree.root, changedOutlet, null);\n\t\t}\n\n\t\tconst url = urlSerializer.serialize(this.currentUrlTree);\n\t\tconst change = { url: url, pop: pop };\n\t\tfor (let fn of this.popStateCallbacks) {\n\t\t\tfn(change);\n\t\t}\n\t}\n\n\tpublic toString() {\n\t\tlet result = [];\n\n\t\tthis.outlets.forEach((outlet) => {\n\t\t\tconst outletStates = outlet.states;\n\t\t\tconst outletLog = outletStates\n\t\t\t\t// tslint:disable-next-line:max-line-length\n\t\t\t\t.map((v, i) => `${outlet.outletKeys}.${i}.[${v.isPageNavigation ? 'PAGE' : 'INTERNAL'}].[${outlet.modalNavigationDepth ? 'MODAL' : 'BASE'}] \"${v.segmentGroup.toString()}\"`)\n\t\t\t\t.reverse();\n\n\t\t\tresult = result.concat(outletLog);\n\t\t});\n\n\t\treturn result.join('\\n');\n\t}\n\n\t// Methods for syncing with page navigation in PageRouterOutlet\n\tpublic _beginBackPageNavigation(frame: Frame) {\n\t\tconst outlet: Outlet = this.getOutletByFrame(frame);\n\n\t\tif (!outlet || outlet.isPageNavigationBack) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerError('Attempted to call startGoBack while going back.');\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.startGoBack()');\n\t\t}\n\t\toutlet.isPageNavigationBack = true;\n\n\t\tthis.currentOutlet = outlet;\n\t}\n\n\tpublic _finishBackPageNavigation(frame: Frame) {\n\t\tconst outlet: Outlet = this.getOutletByFrame(frame);\n\n\t\tif (!outlet || !outlet.isPageNavigationBack) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerError('Attempted to call endGoBack while not going back.');\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.finishBackPageNavigation()');\n\t\t}\n\t\toutlet.isPageNavigationBack = false;\n\t}\n\n\tpublic _beginModalNavigation(frame: Frame): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy._beginModalNavigation()');\n\t\t}\n\n\t\tthis.currentOutlet = this.getOutletByFrame(frame) || this.currentOutlet;\n\n\t\t// It is possible to have frame, but not corresponding Outlet, if\n\t\t// showing modal dialog on app.component.ts ngOnInit() e.g. In that case\n\t\t// the modal is treated as none modal navigation.\n\t\tif (this.currentOutlet) {\n\t\t\tthis.currentOutlet.showingModal = true;\n\t\t\tthis._modalNavigationDepth++;\n\t\t}\n\t}\n\n\tpublic _closeModalNavigation() {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.closeModalNavigation()');\n\t\t}\n\n\t\tconst isShowingModal = this._modalNavigationDepth > 0;\n\n\t\tif (isShowingModal) {\n\t\t\tthis._modalNavigationDepth--;\n\t\t}\n\n\t\t// currentOutlet should be the one that corresponds to the topmost frame\n\t\tconst topmostOutlet = this.getOutletByFrame(this.frameService.getFrame());\n\t\tconst outlet = this.findOutletByModal(this._modalNavigationDepth, isShowingModal) || topmostOutlet;\n\n\t\tif (outlet) {\n\t\t\tthis.currentOutlet = outlet;\n\t\t\tthis.currentOutlet.showingModal = false;\n\t\t\tthis.callPopState(this.currentOutlet.peekState(), false);\n\t\t}\n\t}\n\n\tpublic _beginPageNavigation(frame: Frame): NavigationOptions {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy._beginPageNavigation()');\n\t\t}\n\n\t\tthis.currentOutlet = this.getOutletByFrame(frame);\n\t\tconst lastState = this.currentOutlet.peekState();\n\n\t\tif (lastState) {\n\t\t\tlastState.isPageNavigation = true;\n\t\t}\n\n\t\tconst navOptions = this._currentNavigationOptions || defaultNavOptions;\n\t\tif (navOptions.clearHistory) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy._beginPageNavigation clearing states history');\n\t\t\t}\n\t\t\tthis.currentOutlet.states = [lastState];\n\t\t}\n\n\t\tthis._currentNavigationOptions = undefined;\n\t\treturn navOptions;\n\t}\n\n\tpublic _setNavigationOptions(options: NavigationOptions) {\n\t\tthis._currentNavigationOptions = {\n\t\t\tclearHistory: isPresent(options.clearHistory) ? options.clearHistory : false,\n\t\t\tanimated: isPresent(options.animated) ? options.animated : true,\n\t\t\ttransition: options.transition,\n\t\t};\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy._setNavigationOptions(' + `${JSON.stringify(this._currentNavigationOptions)})`);\n\t\t}\n\t}\n\n\tpublic _getOutlets(): Array<Outlet> {\n\t\treturn this.outlets;\n\t}\n\n\tupdateOutletFrame(outlet: Outlet, frame: Frame, isEmptyOutletFrame: boolean) {\n\t\tconst lastState = outlet.peekState();\n\n\t\tif (lastState && !lastState.frame && !isEmptyOutletFrame) {\n\t\t\tlastState.frame = frame;\n\t\t}\n\n\t\tif (!outlet.containsFrame(frame)) {\n\t\t\toutlet.frames.push(frame);\n\t\t}\n\t\tthis.currentOutlet = outlet;\n\t}\n\n\tclearOutlet(frame: Frame) {\n\t\tthis.outlets = this.outlets.filter((currentOutlet) => {\n\t\t\tlet isEqualToCurrent;\n\n\t\t\tif (this.currentOutlet) {\n\t\t\t\tisEqualToCurrent = currentOutlet.pathByOutlets === this.currentOutlet.pathByOutlets;\n\t\t\t}\n\n\t\t\t// Remove outlet from the url tree.\n\t\t\tif (currentOutlet.containsFrame(frame) && !isEqualToCurrent) {\n\t\t\t\tthis.callPopState(null, true, currentOutlet);\n\t\t\t}\n\n\t\t\t// Skip frames filtering since currentOutlet is <router-outlet> when no frames available.\n\t\t\tif (currentOutlet.frames.length && !currentOutlet.isNSEmptyOutlet) {\n\t\t\t\tcurrentOutlet.frames = currentOutlet.frames.filter((currentFrame) => currentFrame !== frame);\n\t\t\t\treturn currentOutlet.frames.length;\n\t\t\t}\n\n\t\t\treturn !currentOutlet.containsFrame(frame);\n\t\t});\n\t}\n\n\tgetSegmentGroupFullPath(segmentGroup: UrlSegmentGroup): string {\n\t\tlet fullPath = '';\n\n\t\twhile (segmentGroup) {\n\t\t\tconst url = segmentGroup.toString();\n\n\t\t\tif (fullPath) {\n\t\t\t\tfullPath = (url ? url + '/' : '') + fullPath;\n\t\t\t} else {\n\t\t\t\tfullPath = url;\n\t\t\t}\n\n\t\t\tsegmentGroup = segmentGroup.parent;\n\t\t}\n\n\t\treturn fullPath;\n\t}\n\n\tgetRouteFullPath(currentRoute: any): string {\n\t\tconst outletName = currentRoute.outlet;\n\t\tlet fullPath;\n\n\t\tcurrentRoute = currentRoute.parent;\n\t\twhile (currentRoute) {\n\t\t\tconst urls = currentRoute.url.value || currentRoute.url;\n\t\t\tlet url = urls;\n\n\t\t\tif (Array.isArray(urls)) {\n\t\t\t\turl = url.join('/');\n\t\t\t}\n\n\t\t\tfullPath = fullPath ? (url ? url + '/' : url) + fullPath : url;\n\t\t\tcurrentRoute = currentRoute.parent;\n\t\t}\n\n\t\treturn fullPath ? fullPath + '-' + outletName : outletName;\n\t}\n\n\tgetPathByOutlets(urlSegmentGroup: any): string {\n\t\tif (!urlSegmentGroup) {\n\t\t\treturn '';\n\t\t}\n\n\t\tlet pathToOutlet;\n\t\tlet lastPath = urlSegmentGroup.outlet || 'primary';\n\t\tlet parent = urlSegmentGroup.parent;\n\n\t\twhile (parent && urlSegmentGroup.root !== parent) {\n\t\t\tif (parent && parent.outlet !== lastPath) {\n\t\t\t\tif (lastPath === 'primary') {\n\t\t\t\t\tlastPath = parent.outlet;\n\t\t\t\t} else {\n\t\t\t\t\tlastPath = parent.outlet;\n\t\t\t\t\tpathToOutlet = lastPath + '-' + (pathToOutlet || urlSegmentGroup.outlet);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tparent = parent.parent;\n\t\t}\n\n\t\treturn pathToOutlet || lastPath;\n\t}\n\n\tfindOutlet(outletKey: string, activatedRouteSnapshot?: ActivatedRouteSnapshot): Outlet {\n\t\tlet outlet: Outlet = this.outlets.find((currentOutlet) => {\n\t\t\tlet equalModalDepth = currentOutlet.modalNavigationDepth === this._modalNavigationDepth;\n\t\t\treturn equalModalDepth && currentOutlet.outletKeys.indexOf(outletKey) > -1;\n\t\t});\n\n\t\t// No Outlet with the given outletKey could happen when using nested unnamed p-r-o\n\t\t// primary -> primary -> prymary\n\t\tif (!outlet && activatedRouteSnapshot) {\n\t\t\tconst pathByOutlets = this.getPathByOutlets(activatedRouteSnapshot);\n\t\t\toutlet = this.outlets.find((currentOutlet) => {\n\t\t\t\tlet equalModalDepth = currentOutlet.modalNavigationDepth === this._modalNavigationDepth;\n\t\t\t\treturn equalModalDepth && currentOutlet.pathByOutlets === pathByOutlets;\n\t\t\t});\n\t\t}\n\n\t\treturn outlet;\n\t}\n\n\tprivate findOutletByModal(modalNavigation: number, isShowingModal?: boolean): Outlet {\n\t\treturn this.outlets.find((outlet) => {\n\t\t\tlet equalModalDepth = outlet.modalNavigationDepth === modalNavigation;\n\t\t\treturn isShowingModal ? equalModalDepth && outlet.showingModal : equalModalDepth;\n\t\t});\n\t}\n\n\tprivate getOutletByFrame(frame: Frame): Outlet {\n\t\tlet outlet;\n\n\t\tfor (let index = 0; index < this.outlets.length; index++) {\n\t\t\tconst currentOutlet = this.outlets[index];\n\n\t\t\tif (currentOutlet.containsFrame(frame)) {\n\t\t\t\toutlet = currentOutlet;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn outlet;\n\t}\n\n\tprivate updateStates(outlet: Outlet, currentSegmentGroup: UrlSegmentGroup, queryParams: Params): boolean {\n\t\tconst isNewPage = outlet.states.length === 0;\n\t\tconst lastState = outlet.states[outlet.states.length - 1];\n\t\tconst equalStateUrls = outlet.containsTopState(currentSegmentGroup.toString());\n\n\t\tconst locationState: LocationState = {\n\t\t\tsegmentGroup: currentSegmentGroup,\n\t\t\tisRootSegmentGroup: false,\n\t\t\tisPageNavigation: isNewPage,\n\t\t\tqueryParams: { ...queryParams },\n\t\t};\n\n\t\tif (!lastState || !equalStateUrls) {\n\t\t\toutlet.states.push(locationState);\n\n\t\t\t// Update last state segmentGroup of parent Outlet.\n\t\t\tif (this._modalNavigationDepth === 0 && !outlet.showingModal) {\n\t\t\t\tthis.updateParentsStates(outlet, currentSegmentGroup.parent);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate updateParentsStates(outlet: Outlet, newSegmentGroup: UrlSegmentGroup) {\n\t\tlet parentOutlet = outlet.parent;\n\n\t\t// Update parents lastState segmentGroups\n\t\twhile (parentOutlet && newSegmentGroup) {\n\t\t\tconst state = parentOutlet.peekState();\n\n\t\t\tif (state) {\n\t\t\t\tstate.segmentGroup = newSegmentGroup;\n\t\t\t\tnewSegmentGroup = newSegmentGroup.parent;\n\t\t\t\tparentOutlet = parentOutlet.parent;\n\t\t\t}\n\t\t}\n\t}\n\n\t// tslint:disable-next-line:max-line-length\n\tprivate createOutlet(outletKey: string, path: string, segmentGroup: any, parent: Outlet, modalNavigation?: number, queryParams: Params = {}): Outlet {\n\t\tconst pathByOutlets = this.getPathByOutlets(segmentGroup);\n\t\tconst newOutlet = new Outlet(outletKey, path, pathByOutlets, modalNavigation);\n\n\t\tconst locationState: LocationState = {\n\t\t\tsegmentGroup: segmentGroup,\n\t\t\tisRootSegmentGroup: false,\n\t\t\tisPageNavigation: true, // It is a new OutletNode.\n\t\t\tqueryParams: { ...queryParams },\n\t\t};\n\n\t\tnewOutlet.states = [locationState];\n\t\tnewOutlet.parent = parent;\n\t\tthis.outlets.push(newOutlet);\n\n\t\t// Update last state segmentGroup of parent Outlet.\n\t\tif (this._modalNavigationDepth === 0 && !newOutlet.showingModal) {\n\t\t\tthis.updateParentsStates(newOutlet, segmentGroup.parent);\n\t\t}\n\n\t\treturn newOutlet;\n\t}\n\n\tprivate getSegmentGroupByOutlet(outlet: Outlet): UrlSegmentGroup {\n\t\tconst pathList = outlet.pathByOutlets.split('-');\n\t\tlet segmentGroup = this.currentUrlTree.root;\n\t\tlet pathToOutlet;\n\n\t\tfor (let index = 0; index < pathList.length; index++) {\n\t\t\tconst currentPath = pathList[index];\n\t\t\tconst childrenCount = Object.keys(segmentGroup.children).length;\n\n\t\t\tif (childrenCount && segmentGroup.children[currentPath]) {\n\t\t\t\tconst url = segmentGroup.toString();\n\t\t\t\tpathToOutlet = pathToOutlet ? pathToOutlet + '/' + url : url;\n\t\t\t\tsegmentGroup = segmentGroup.children[currentPath];\n\t\t\t} else {\n\t\t\t\t// If no child outlet found with the given name - forget about all previously found outlets.\n\t\t\t\t// example: seaching for 'primary-second-primary' shouldn't return 'primary-second'\n\t\t\t\t// if no 'primary' child available on 'second'.\n\t\t\t\tsegmentGroup = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Paths should also match since there could be another Outlet\n\t\t// with the same pathByOutlets but different url path.\n\t\tif (segmentGroup && outlet.path && pathToOutlet && outlet.path !== pathToOutlet) {\n\t\t\tsegmentGroup = null;\n\t\t}\n\n\t\treturn segmentGroup;\n\t}\n\n\t// Traversal and replacement of segmentGroup.\n\tprivate updateSegmentGroup(rootNode: any, oldSegmentGroup: UrlSegmentGroup, newSegmentGroup: UrlSegmentGroup) {\n\t\tconst queue = [];\n\t\tlet currentTree = rootNode;\n\n\t\twhile (currentTree) {\n\t\t\tObject.keys(currentTree.children).forEach((outletName) => {\n\t\t\t\tif (currentTree.children[outletName] === oldSegmentGroup) {\n\t\t\t\t\tif (newSegmentGroup) {\n\t\t\t\t\t\tcurrentTree.children[outletName] = newSegmentGroup;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete currentTree.children[outletName];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tqueue.push(currentTree.children[outletName]);\n\t\t\t});\n\n\t\t\tcurrentTree = queue.shift();\n\t\t}\n\t}\n\n\tprivate upsertModalOutlet(parentOutlet: Outlet, segmentedGroup: UrlSegmentGroup, queryParams: Params) {\n\t\tlet currentModalOutlet = this.findOutletByModal(this._modalNavigationDepth);\n\n\t\t// We want to treat every p-r-o as a standalone Outlet.\n\t\tif (!currentModalOutlet) {\n\t\t\tif (this._modalNavigationDepth > 1) {\n\t\t\t\t// The parent of the current Outlet should be the previous opened modal (if any).\n\t\t\t\tparentOutlet = this.findOutletByModal(this._modalNavigationDepth - 1);\n\t\t\t}\n\n\t\t\t// No currentModalOutlet available when opening 'primary' p-r-o.\n\t\t\tconst outletName = 'primary';\n\t\t\tconst outletPath = parentOutlet.peekState().segmentGroup.toString();\n\t\t\tconst outletKey = this.getOutletKey(outletPath, outletName);\n\t\t\t// tslint:disable-next-line:max-line-length\n\t\t\tcurrentModalOutlet = this.createOutlet(outletKey, outletPath, segmentedGroup, parentOutlet, this._modalNavigationDepth, queryParams);\n\t\t\tthis.currentOutlet = currentModalOutlet;\n\t\t} else if (this.updateStates(currentModalOutlet, segmentedGroup, queryParams)) {\n\t\t\tthis.currentOutlet = currentModalOutlet; // If states updated\n\t\t}\n\t}\n\n\tprivate getOutletKey(path: string, outletName: string): string {\n\t\treturn path ? path + '-' + outletName : outletName;\n\t}\n\n\tngOnDestroy() {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NSLocationStrategy.ngOnDestroy()');\n\t\t}\n\n\t\tthis.outlets = [];\n\t\tthis.currentOutlet = null;\n\t}\n}\n","import { ComponentRef, ComponentFactory, ViewContainerRef, Component, Type, ComponentFactoryResolver, ChangeDetectorRef } from '@angular/core';\nimport { Trace } from '@nativescript/core';\n\n/**\n * Wrapper component used for loading components when navigating\n * It uses DetachedContainer as selector so that it is containerRef is not attached to\n * the visual tree.\n */\n@Component({\n\tselector: 'DetachedContainer',\n\ttemplate: `<Placeholder #loader></Placeholder>`,\n})\nexport class DetachedLoader {\n\t// tslint:disable-line:component-class-suffix\n\tconstructor(private resolver: ComponentFactoryResolver, private changeDetector: ChangeDetectorRef, private containerRef: ViewContainerRef) {}\n\n\tprivate loadInLocation(componentType: Type<any>): Promise<ComponentRef<any>> {\n\t\tconst factory = this.resolver.resolveComponentFactory(componentType);\n\t\tconst componentRef = this.containerRef.createComponent(factory, this.containerRef.length, this.containerRef.injector);\n\n\t\t// Component is created, built may not be checked if we are loading\n\t\t// inside component with OnPush CD strategy. Mark us for check to be sure CD will reach us.\n\t\t// We are inside a promise here so no need for setTimeout - CD should trigger\n\t\t// after the promise.\n\t\tTrace.write('DetachedLoader.loadInLocation component loaded -> markForCheck', 'detached-loader');\n\n\t\treturn Promise.resolve(componentRef);\n\t}\n\n\tpublic detectChanges() {\n\t\tthis.changeDetector.markForCheck();\n\t}\n\n\t// TODO: change this API -- async promises not needed here anymore.\n\tpublic loadComponent(componentType: Type<any>): Promise<ComponentRef<any>> {\n\t\tTrace.write('DetachedLoader.loadComponent', 'detached-loader');\n\t\treturn this.loadInLocation(componentType);\n\t}\n\n\tpublic loadWithFactory<T>(factory: ComponentFactory<T>): ComponentRef<T> {\n\t\treturn this.containerRef.createComponent(factory, this.containerRef.length, this.containerRef.injector, null);\n\t}\n}\n","/**\n * Utility method to ensure a NgModule is only imported once in a codebase, otherwise will throw to help prevent accidental double importing\n * @param parentModule Parent module name\n * @param moduleName The module name\n */\nexport function throwIfAlreadyLoaded(parentModule: any, moduleName: string) {\n\tif (parentModule) {\n\t\tthrow new Error(`${moduleName} has already been loaded. Import ${moduleName} in the AppModule only.`);\n\t}\n}\n\n/**\n * Utility method which will only fire the callback once ever\n * @param fn callback to call only once\n */\nexport function once(fn: Function) {\n\tlet wasCalled = false;\n\n\treturn function wrapper() {\n\t\tif (wasCalled) {\n\t\t\treturn;\n\t\t}\n\n\t\twasCalled = true;\n\t\tfn.apply(null, arguments);\n\t};\n}\n","import { ComponentFactoryResolver, ComponentRef, Injectable, Injector, NgModuleRef, Type, ViewContainerRef } from '@angular/core';\nimport { Frame, View, ViewBase, ProxyViewContainer, ShowModalOptions } from '@nativescript/core';\n\nimport { NSLocationStrategy } from '../router/ns-location-strategy';\nimport { AppHostView, AppHostAsyncView } from '../app-host-view';\nimport { DetachedLoader } from '../common/detached-loader';\nimport { PageFactory, PAGE_FACTORY } from '../platform-providers';\nimport { once } from '../common/utils';\n\nexport type BaseShowModalOptions = Pick<ShowModalOptions, Exclude<keyof ShowModalOptions, 'closeCallback' | 'context'>>;\n\nexport interface ModalDialogOptions extends BaseShowModalOptions {\n\tcontext?: any;\n\tviewContainerRef?: ViewContainerRef;\n\tmoduleRef?: NgModuleRef<any>;\n\ttarget?: View;\n}\n\nexport interface ShowDialogOptions extends BaseShowModalOptions {\n\tcontainerRef: ViewContainerRef;\n\tcontext: any;\n\tdoneCallback;\n\tpageFactory: PageFactory;\n\tparentView: ViewBase;\n\tresolver: ComponentFactoryResolver;\n\ttype: Type<any>;\n}\n\nexport class ModalDialogParams {\n\tconstructor(public context: any = {}, public closeCallback: (...args) => any) {}\n}\n\n@Injectable()\nexport class ModalDialogService {\n\tconstructor(private location: NSLocationStrategy) {}\n\n\tpublic showModal(type: Type<any>, options: ModalDialogOptions): Promise<any> {\n\t\tif (!options.viewContainerRef) {\n\t\t\tthrow new Error('No viewContainerRef: ' + 'Make sure you pass viewContainerRef in ModalDialogOptions.');\n\t\t}\n\n\t\tlet parentView = options.viewContainerRef.element.nativeElement;\n\t\tif (options.target) {\n\t\t\tparentView = options.target;\n\t\t}\n\n\t\tif ((parentView instanceof AppHostView || parentView instanceof AppHostAsyncView) && parentView.ngAppRoot) {\n\t\t\tparentView = parentView.ngAppRoot;\n\t\t}\n\n\t\t// _ngDialogRoot is the first child of the previously detached proxy.\n\t\t// It should have 'viewController' (iOS) or '_dialogFragment' (Android) available for\n\t\t// presenting future modal views.\n\t\tif (parentView._ngDialogRoot) {\n\t\t\tparentView = parentView._ngDialogRoot;\n\t\t}\n\n\t\tconst pageFactory: PageFactory = options.viewContainerRef.injector.get(PAGE_FACTORY);\n\n\t\t// resolve from particular module (moduleRef)\n\t\t// or from same module as parentView (viewContainerRef)\n\t\tconst componentContainer = options.moduleRef || options.viewContainerRef;\n\t\tconst resolver = componentContainer.injector.get(ComponentFactoryResolver);\n\n\t\tlet frame = parentView;\n\t\tif (!(parentView instanceof Frame)) {\n\t\t\tframe = (parentView.page && parentView.page.frame) || Frame.topmost();\n\t\t}\n\n\t\tthis.location._beginModalNavigation(frame);\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\ttry {\n\t\t\t\t\tthis._showDialog({\n\t\t\t\t\t\t...options,\n\t\t\t\t\t\tcontainerRef: options.viewContainerRef,\n\t\t\t\t\t\tcontext: options.context,\n\t\t\t\t\t\tdoneCallback: resolve,\n\t\t\t\t\t\tpageFactory,\n\t\t\t\t\t\tparentView,\n\t\t\t\t\t\tresolver,\n\t\t\t\t\t\ttype,\n\t\t\t\t\t});\n\t\t\t\t} catch (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t});\n\t}\n\n\tprivate _showDialog(options: ShowDialogOptions): void {\n\t\tlet componentView: View;\n\t\tlet detachedLoaderRef: ComponentRef<DetachedLoader>;\n\n\t\tconst closeCallback = once((...args) => {\n\t\t\toptions.doneCallback.apply(undefined, args);\n\t\t\tif (componentView) {\n\t\t\t\tcomponentView.closeModal();\n\t\t\t\tthis.location._closeModalNavigation();\n\t\t\t\tdetachedLoaderRef.instance.detectChanges();\n\t\t\t\tdetachedLoaderRef.destroy();\n\t\t\t}\n\t\t});\n\n\t\tconst modalParams = new ModalDialogParams(options.context, closeCallback);\n\n\t\tconst childInjector = Injector.create({\n\t\t\tproviders: [{ provide: ModalDialogParams, useValue: modalParams }],\n\t\t\tparent: options.containerRef.injector,\n\t\t});\n\t\tconst detachedFactory = options.resolver.resolveComponentFactory(DetachedLoader);\n\t\tdetachedLoaderRef = options.containerRef.createComponent(detachedFactory, 0, childInjector, null);\n\t\tdetachedLoaderRef.instance.loadComponent(options.type).then((compRef) => {\n\t\t\tconst detachedProxy = <ProxyViewContainer>compRef.location.nativeElement;\n\n\t\t\tif (detachedProxy.getChildrenCount() > 1) {\n\t\t\t\tthrow new Error('Modal content has more than one root view.');\n\t\t\t}\n\t\t\tcomponentView = detachedProxy.getChildAt(0);\n\n\t\t\tif (componentView.parent) {\n\t\t\t\t(<any>componentView.parent)._ngDialogRoot = componentView;\n\t\t\t\t(<any>componentView.parent).removeChild(componentView);\n\t\t\t}\n\n\t\t\toptions.parentView.showModal(componentView, { ...options, closeCallback });\n\t\t});\n\t}\n}\n","import { View, LayoutBase, Page, Frame, AbsoluteLayout, ActivityIndicator, BottomNavigation, Button, ContentView, DatePicker, DockLayout, GridLayout, HtmlView, Image, Label, ListPicker, ListView, Placeholder, Progress, ProxyViewContainer, Repeater, ScrollView, SearchBar, SegmentedBar, SegmentedBarItem, Slider, StackLayout, FlexboxLayout, Switch, TabView, TabStrip, TabStripItem, TabContentItem, Tabs, TextField, TextView, TimePicker, WebView, WrapLayout, FormattedString, Span } from '@nativescript/core';\n\nexport interface ViewClass {\n\tnew (): View;\n}\nexport interface ViewExtensions {\n\tmeta: ViewClassMeta;\n\tnodeType: number;\n\tnodeName: string;\n\tparentNode: NgView;\n\tnextSibling: NgView;\n\tfirstChild: NgView;\n\tlastChild: NgView;\n\tngCssClasses: Map<string, boolean>;\n}\n\nexport type NgView = View & ViewExtensions;\n\nexport abstract class InvisibleNode extends View implements NgView {\n\tmeta: { skipAddToDom: boolean };\n\tnodeType: number;\n\tnodeName: string;\n\tparentNode: NgView;\n\tnextSibling: NgView;\n\tfirstChild: NgView;\n\tlastChild: NgView;\n\tngCssClasses: Map<string, boolean>;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.nodeType = 1;\n\t\tthis.nodeName = getClassName(this);\n\t}\n\n\ttoString() {\n\t\treturn `${this.nodeName}(${this.id})`;\n\t}\n}\n\nexport class CommentNode extends InvisibleNode {\n\tprotected static id = 0;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.meta = {\n\t\t\tskipAddToDom: true,\n\t\t};\n\t\tthis.id = CommentNode.id.toString();\n\t\tCommentNode.id += 1;\n\t}\n}\n\nexport class TextNode extends InvisibleNode {\n\tprotected static id = 0;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.meta = {\n\t\t\tskipAddToDom: true,\n\t\t};\n\t\tthis.id = TextNode.id.toString();\n\t\tTextNode.id += 1;\n\t}\n}\n\nconst getClassName = (instance) => instance.constructor.name;\n\nexport interface ViewClassMeta {\n\tskipAddToDom?: boolean;\n\tinsertChild?: (parent: any, child: any, next?: any) => void;\n\tremoveChild?: (parent: any, child: any) => void;\n}\n\nexport function isDetachedElement(element): boolean {\n\treturn element && element.meta && element.meta.skipAddToDom;\n}\n\nexport function isView(view: any): view is NgView {\n\treturn view instanceof View;\n}\n\nexport function isInvisibleNode(view: any): view is InvisibleNode {\n\treturn view instanceof InvisibleNode;\n}\n\nexport type ViewResolver = () => any;\n\nconst elementMap = new Map<string, { resolver: ViewResolver; meta?: ViewClassMeta }>();\nconst camelCaseSplit = /([a-z0-9])([A-Z])/g;\nconst defaultViewMeta: ViewClassMeta = { skipAddToDom: false };\n\nexport function registerElement(elementName: string, resolver: ViewResolver, meta?: ViewClassMeta): void {\n\tconst entry = { resolver, meta };\n\telementMap.set(elementName, entry);\n\telementMap.set(elementName.toLowerCase(), entry);\n\telementMap.set(elementName.replace(camelCaseSplit, '$1-$2').toLowerCase(), entry);\n}\n\nexport function getViewClass(elementName: string): any {\n\tconst entry = elementMap.get(elementName) || elementMap.get(elementName.toLowerCase());\n\tif (!entry) {\n\t\tthrow new TypeError(`No known component for element ${elementName}.`);\n\t}\n\n\ttry {\n\t\treturn entry.resolver();\n\t} catch (e) {\n\t\tthrow new TypeError(`Could not load view for: ${elementName}.${e}`);\n\t}\n}\n\nexport function getViewMeta(nodeName: string): ViewClassMeta {\n\tconst entry = elementMap.get(nodeName) || elementMap.get(nodeName.toLowerCase());\n\treturn (entry && entry.meta) || defaultViewMeta;\n}\n\nexport function isKnownView(elementName: string): boolean {\n\treturn elementMap.has(elementName) || elementMap.has(elementName.toLowerCase());\n}\n\nexport function getSingleViewRecursive(nodes: Array<any>, nestLevel: number): View {\n\tconst actualNodes = nodes.filter((node) => !(node instanceof InvisibleNode));\n\n\tif (actualNodes.length === 0) {\n\t\tthrow new Error(`No suitable views found in list template! ` + `Nesting level: ${nestLevel}`);\n\t} else if (actualNodes.length > 1) {\n\t\tthrow new Error(`More than one view found in list template!` + `Nesting level: ${nestLevel}`);\n\t}\n\n\tconst rootLayout = actualNodes[0];\n\tif (!rootLayout) {\n\t\treturn getSingleViewRecursive(rootLayout.children, nestLevel + 1);\n\t}\n\n\tconst parentLayout = rootLayout.parent;\n\tif (parentLayout instanceof LayoutBase) {\n\t\tlet node = rootLayout.parentNode;\n\t\tparentLayout.removeChild(rootLayout);\n\t\trootLayout.parentNode = node;\n\t}\n\n\treturn rootLayout;\n}\n\nconst frameMeta: ViewClassMeta = {\n\tinsertChild: (parent: Frame, child: NgView, next: any) => {\n\t\t// Page cannot be added to Frame with _addChildFromBuilder (thwos \"use defaultPage\" error)\n\t\tif (isInvisibleNode(child)) {\n\t\t\treturn;\n\t\t} else if (child instanceof Page) {\n\t\t\tparent.navigate({ create: () => child });\n\t\t} else {\n\t\t\tthrow new Error('Only a Page can be a child of Frame');\n\t\t}\n\t},\n};\n\n// Register default NativeScript components\n// Note: ActionBar related components are registerd together with action-bar directives.\nregisterElement('AbsoluteLayout', () => AbsoluteLayout);\nregisterElement('ActivityIndicator', () => ActivityIndicator);\nregisterElement('BottomNavigation', () => BottomNavigation);\nregisterElement('Button', () => Button);\nregisterElement('ContentView', () => ContentView);\nregisterElement('DatePicker', () => DatePicker);\nregisterElement('DockLayout', () => DockLayout);\nregisterElement('Frame', () => <any>Frame, frameMeta);\nregisterElement('GridLayout', () => GridLayout);\nregisterElement('HtmlView', () => HtmlView);\nregisterElement('Image', () => Image);\n// Parse5 changes <Image> tags to <img>. WTF!\nregisterElement('img', () => Image);\nregisterElement('Label', () => Label);\nregisterElement('ListPicker', () => ListPicker);\nregisterElement('ListView', () => ListView);\nregisterElement('Page', () => Page);\nregisterElement('Placeholder', () => Placeholder);\nregisterElement('Progress', () => Progress);\nregisterElement('ProxyViewContainer', () => ProxyViewContainer);\nregisterElement('Repeater', () => Repeater);\nregisterElement('ScrollView', () => ScrollView);\nregisterElement('SearchBar', () => SearchBar);\nregisterElement('SegmentedBar', () => SegmentedBar);\nregisterElement('SegmentedBarItem', () => <any>SegmentedBarItem);\nregisterElement('Slider', () => Slider);\nregisterElement('StackLayout', () => StackLayout);\nregisterElement('FlexboxLayout', () => FlexboxLayout);\nregisterElement('Switch', () => Switch);\nregisterElement('TabView', () => TabView);\nregisterElement('TabStrip', () => TabStrip);\nregisterElement('TabStripItem', () => TabStripItem);\nregisterElement('TabContentItem', () => TabContentItem);\nregisterElement('Tabs', () => Tabs);\nregisterElement('TextField', () => TextField);\nregisterElement('TextView', () => TextView);\nregisterElement('TimePicker', () => TimePicker);\nregisterElement('WebView', () => WebView);\nregisterElement('WrapLayout', () => WrapLayout);\nregisterElement('FormattedString', () => <any>FormattedString);\nregisterElement('Span', () => <any>Span);\n\nregisterElement('DetachedContainer', () => ProxyViewContainer, {\n\tskipAddToDom: true,\n});\n\nregisterElement('page-router-outlet', () => <any>Frame);\n","import { AfterContentInit, ContentChild, Directive, DoCheck, ElementRef, EmbeddedViewRef, EventEmitter, Host, Inject, InjectionToken, Input, IterableDiffer, IterableDiffers, OnDestroy, Output, TemplateRef, ViewChild, ViewContainerRef, ɵisListLikeIterable as isListLikeIterable, Injectable } from '@angular/core';\nimport { ObservableArray, View, KeyedTemplate, LayoutBase, ItemEventData, TemplatedItemsView, profile } from '@nativescript/core';\n\nimport { getSingleViewRecursive } from '../element-registry';\nimport { NativeScriptDebug } from '../trace';\n\nconst NG_VIEW = '_ngViewRef';\n\nexport class ItemContext {\n\tconstructor(public $implicit?: any, public item?: any, public index?: number, public even?: boolean, public odd?: boolean) {}\n}\n\nexport interface SetupItemViewArgs {\n\tview: EmbeddedViewRef<any>;\n\tdata: any;\n\tindex: number;\n\tcontext: ItemContext;\n}\n\n@Directive()\nexport abstract class TemplatedItemsComponent implements DoCheck, OnDestroy, AfterContentInit {\n\tpublic abstract get nativeElement(): TemplatedItemsView;\n\n\tprotected templatedItemsView: TemplatedItemsView;\n\tprotected _items: any;\n\tprotected _differ: IterableDiffer<KeyedTemplate>;\n\tprotected _templateMap: Map<string, KeyedTemplate>;\n\n\t@ViewChild('loader', { read: ViewContainerRef, static: false }) loader: ViewContainerRef;\n\n\t@Output() public setupItemView = new EventEmitter<SetupItemViewArgs>();\n\n\t@ContentChild(TemplateRef, { read: TemplateRef, static: false }) itemTemplateQuery: TemplateRef<ItemContext>;\n\n\titemTemplate: TemplateRef<ItemContext>;\n\n\t@Input()\n\tget items() {\n\t\treturn this._items;\n\t}\n\n\tset items(value: any) {\n\t\tthis._items = value;\n\t\tlet needDiffer = true;\n\t\tif (value instanceof ObservableArray) {\n\t\t\tneedDiffer = false;\n\t\t}\n\t\tif (needDiffer && !this._differ && isListLikeIterable(value)) {\n\t\t\tthis._differ = this._iterableDiffers.find(this._items).create((_index, item) => {\n\t\t\t\treturn item;\n\t\t\t});\n\t\t}\n\n\t\tthis.templatedItemsView.items = this._items;\n\t}\n\n\tconstructor(_elementRef: ElementRef, private _iterableDiffers: IterableDiffers) {\n\t\tthis.templatedItemsView = _elementRef.nativeElement;\n\n\t\tthis.templatedItemsView.on('itemLoading', this.onItemLoading, this);\n\t}\n\n\tngAfterContentInit() {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.listViewLog('TemplatedItemsView.ngAfterContentInit()');\n\t\t}\n\n\t\tthis.setItemTemplates();\n\t}\n\n\tngOnDestroy() {\n\t\tthis.templatedItemsView.off('itemLoading', this.onItemLoading, this);\n\t\tthis.templatedItemsView = null;\n\n\t\tif (this._templateMap) {\n\t\t\tthis._templateMap.clear();\n\t\t}\n\t}\n\n\tprivate setItemTemplates() {\n\t\t// The itemTemplateQuery may be changed after list items are added that contain <template> inside,\n\t\t// so cache and use only the original template to avoid errors.\n\t\tthis.itemTemplate = this.itemTemplateQuery;\n\n\t\tif (this._templateMap) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.listViewLog('Setting templates');\n\t\t\t}\n\n\t\t\tconst templates: KeyedTemplate[] = [];\n\t\t\tthis._templateMap.forEach((value) => {\n\t\t\t\ttemplates.push(value);\n\t\t\t});\n\t\t\tthis.templatedItemsView.itemTemplates = templates;\n\t\t}\n\t}\n\n\tpublic registerTemplate(key: string, template: TemplateRef<ItemContext>) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.listViewLog(`registerTemplate for key: ${key}`);\n\t\t}\n\n\t\tif (!this._templateMap) {\n\t\t\tthis._templateMap = new Map<string, KeyedTemplate>();\n\t\t}\n\n\t\tconst keyedTemplate = {\n\t\t\tkey,\n\t\t\tcreateView: this.getItemTemplateViewFactory(template),\n\t\t};\n\n\t\tthis._templateMap.set(key, keyedTemplate);\n\t}\n\n\t@profile\n\tpublic onItemLoading(args: ItemEventData) {\n\t\tif (!args.view && !this.itemTemplate) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst index = args.index;\n\t\tconst items = (<any>args.object).items;\n\t\tconst currentItem = typeof items.getItem === 'function' ? items.getItem(index) : items[index];\n\t\tlet viewRef: EmbeddedViewRef<ItemContext>;\n\n\t\tif (args.view) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.listViewLog(`onItemLoading: ${index} - Reusing existing view`);\n\t\t\t}\n\n\t\t\tviewRef = args.view[NG_VIEW];\n\n\t\t\t// Getting angular view from original element (in cases when ProxyViewContainer\n\t\t\t// is used NativeScript internally wraps it in a StackLayout)\n\t\t\tif (!viewRef && args.view instanceof LayoutBase && args.view.getChildrenCount() > 0) {\n\t\t\t\tviewRef = args.view.getChildAt(0)[NG_VIEW];\n\t\t\t}\n\n\t\t\tif (!viewRef && NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.listViewError(`ViewReference not found for item ${index}. View recycling is not working`);\n\t\t\t}\n\n\t\t\t// No ng-template is setup, continue with 'defaultTemplate'\n\t\t\tif (!viewRef) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (!viewRef) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.listViewLog(`onItemLoading: ${index} - Creating view from template`);\n\t\t\t}\n\n\t\t\tviewRef = this.loader.createEmbeddedView(this.itemTemplate, new ItemContext(), 0);\n\t\t\targs.view = getItemViewRoot(viewRef);\n\t\t\targs.view[NG_VIEW] = viewRef;\n\t\t}\n\n\t\tthis.setupViewRef(viewRef, currentItem, index);\n\n\t\tthis.detectChangesOnChild(viewRef, index);\n\t}\n\n\tpublic setupViewRef(viewRef: EmbeddedViewRef<ItemContext>, data: any, index: number): void {\n\t\tconst context = viewRef.context;\n\t\tcontext.$implicit = data;\n\t\tcontext.item = data;\n\t\tcontext.index = index;\n\t\tcontext.even = index % 2 === 0;\n\t\tcontext.odd = !context.even;\n\n\t\tthis.setupItemView.next({ view: viewRef, data: data, index: index, context: context });\n\t}\n\n\tprotected getItemTemplateViewFactory(template: TemplateRef<ItemContext>): () => View {\n\t\treturn () => {\n\t\t\tconst viewRef = this.loader.createEmbeddedView(template, new ItemContext(), 0);\n\t\t\tconst resultView = getItemViewRoot(viewRef);\n\t\t\tresultView[NG_VIEW] = viewRef;\n\n\t\t\treturn resultView;\n\t\t};\n\t}\n\n\t@profile\n\tprivate detectChangesOnChild(viewRef: EmbeddedViewRef<ItemContext>, index: number) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.listViewLog(`Manually detect changes in child: ${index}`);\n\t\t}\n\n\t\tviewRef.markForCheck();\n\t\tviewRef.detectChanges();\n\t}\n\n\tngDoCheck() {\n\t\tif (this._differ) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.listViewLog('ngDoCheck() - execute differ');\n\t\t\t}\n\n\t\t\tconst changes = this._differ.diff(this._items);\n\t\t\tif (changes) {\n\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\tNativeScriptDebug.listViewLog('ngDoCheck() - refresh');\n\t\t\t\t}\n\n\t\t\t\tthis.templatedItemsView.refresh();\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport interface ComponentView {\n\trootNodes: Array<any>;\n\tdestroy(): void;\n}\n\nexport type RootLocator = (nodes: Array<any>, nestLevel: number) => View;\n\nexport function getItemViewRoot(viewRef: ComponentView, rootLocator: RootLocator = getSingleViewRecursive): View {\n\tconst rootView = rootLocator(viewRef.rootNodes, 0);\n\treturn rootView;\n}\n\nexport const TEMPLATED_ITEMS_COMPONENT = new InjectionToken<TemplatedItemsComponent>('TemplatedItemsComponent');\n\n@Directive({ selector: '[nsTemplateKey]' })\nexport class TemplateKeyDirective {\n\tconstructor(private templateRef: TemplateRef<any>, @Inject(TEMPLATED_ITEMS_COMPONENT) @Host() private comp: TemplatedItemsComponent) {}\n\n\t@Input()\n\tset nsTemplateKey(value: any) {\n\t\tif (this.comp && this.templateRef) {\n\t\t\tthis.comp.registerTemplate(value, this.templateRef);\n\t\t}\n\t}\n}\n","import { ChangeDetectionStrategy, Component, ElementRef, IterableDiffers, forwardRef } from '@angular/core';\nimport { ListView } from '@nativescript/core';\nimport { TEMPLATED_ITEMS_COMPONENT, TemplatedItemsComponent } from './templated-items-comp';\n\n@Component({\n\tselector: 'ListView',\n\ttemplate: ` <DetachedContainer>\n\t\t<Placeholder #loader></Placeholder>\n\t</DetachedContainer>`,\n\tchangeDetection: ChangeDetectionStrategy.OnPush,\n\tproviders: [{ provide: TEMPLATED_ITEMS_COMPONENT, useExisting: forwardRef(() => ListViewComponent) }],\n})\nexport class ListViewComponent extends TemplatedItemsComponent {\n\tpublic get nativeElement(): ListView {\n\t\treturn this.templatedItemsView;\n\t}\n\n\tprotected templatedItemsView: ListView;\n\n\tconstructor(_elementRef: ElementRef, _iterableDiffers: IterableDiffers) {\n\t\tsuper(_elementRef, _iterableDiffers);\n\t}\n}\n","import { AfterViewInit, Directive, ElementRef, Input, OnInit, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { TabView, TabViewItem } from '@nativescript/core';\n\nimport { InvisibleNode } from '../element-registry';\nimport { NativeScriptDebug } from '../trace';\nimport { isBlank } from '../lang-facade';\n\ntype TextTransform = 'initial' | 'none' | 'capitalize' | 'uppercase' | 'lowercase';\nexport interface TabViewItemDef {\n\ttitle?: string;\n\ticonSource?: string;\n\ttextTransform?: TextTransform;\n}\n\n@Directive({\n\tselector: 'TabView', // tslint:disable-line:directive-selector\n})\nexport class TabViewDirective implements AfterViewInit {\n\tpublic tabView: TabView;\n\tprivate _selectedIndex: number;\n\tprivate viewInitialized: boolean;\n\n\t@Input()\n\tget selectedIndex(): number {\n\t\treturn this._selectedIndex;\n\t}\n\n\tset selectedIndex(value) {\n\t\tthis._selectedIndex = value;\n\t\tif (this.viewInitialized) {\n\t\t\tthis.tabView.selectedIndex = this._selectedIndex;\n\t\t}\n\t}\n\n\tconstructor(element: ElementRef) {\n\t\tthis.tabView = element.nativeElement;\n\t}\n\n\tngAfterViewInit() {\n\t\tthis.viewInitialized = true;\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog('this._selectedIndex: ' + this._selectedIndex);\n\t\t}\n\t\tif (!isBlank(this._selectedIndex)) {\n\t\t\tthis.tabView.selectedIndex = this._selectedIndex;\n\t\t}\n\t}\n}\n\n@Directive({\n\tselector: '[tabItem]', // tslint:disable-line:directive-selector\n})\nexport class TabViewItemDirective implements OnInit {\n\tprivate item: TabViewItem;\n\tprivate _config: TabViewItemDef;\n\n\tconstructor(private owner: TabViewDirective, private templateRef: TemplateRef<any>, private viewContainer: ViewContainerRef) {}\n\n\t@Input('tabItem')\n\tset config(config: TabViewItemDef) {\n\t\tif (!this._config || this._config.iconSource !== config.iconSource || this._config.title !== config.title || this._config.textTransform !== config.textTransform) {\n\t\t\tthis._config = config;\n\t\t\tthis.applyConfig();\n\t\t}\n\t}\n\n\tget config(): TabViewItemDef {\n\t\t// tslint:disable-line:no-input-rename\n\t\treturn this._config || {};\n\t}\n\n\t@Input()\n\tset title(title: string) {\n\t\tthis.config = Object.assign(this.config, { title });\n\t}\n\n\tget title() {\n\t\treturn this.config.title;\n\t}\n\n\t@Input()\n\tset iconSource(iconSource: string) {\n\t\tthis.config = Object.assign(this.config, { iconSource });\n\t}\n\n\tget iconSource() {\n\t\treturn this.config.iconSource;\n\t}\n\n\t@Input()\n\tset textTransform(textTransform: TextTransform) {\n\t\tthis.config = Object.assign(this.config, { textTransform });\n\t}\n\n\tget textTransform() {\n\t\treturn this.config.textTransform;\n\t}\n\n\tprivate ensureItem() {\n\t\tif (!this.item) {\n\t\t\tthis.item = new TabViewItem();\n\t\t}\n\t}\n\n\tprivate applyConfig() {\n\t\tthis.ensureItem();\n\n\t\tif (this.config.title) {\n\t\t\tthis.item.title = this.config.title;\n\t\t}\n\n\t\tif (this.config.iconSource) {\n\t\t\tthis.item.iconSource = this.config.iconSource;\n\t\t}\n\n\t\t//  TabViewItem textTransform has a default value for Android that kick in\n\t\t// only if no value (even a null value) is set.\n\t\tif (this.config.textTransform) {\n\t\t\tthis.item.textTransform = this.config.textTransform;\n\t\t}\n\t}\n\n\tngOnInit() {\n\t\tthis.applyConfig();\n\n\t\tconst viewRef = this.viewContainer.createEmbeddedView(this.templateRef);\n\t\t// Filter out text nodes and comments\n\t\tconst realViews = viewRef.rootNodes.filter((node) => !(node instanceof InvisibleNode));\n\n\t\tif (realViews.length > 0) {\n\t\t\tthis.item.view = realViews[0];\n\n\t\t\tconst newItems = (this.owner.tabView.items || []).concat([this.item]);\n\t\t\tthis.owner.tabView.items = newItems;\n\t\t}\n\t}\n}\n","import { Directive, Component, ElementRef, Optional, OnDestroy } from '@angular/core';\nimport { ActionBar, ActionItem, ActionItems, NavigationButton, Page } from '@nativescript/core';\n\nimport { isBlank } from '../lang-facade';\nimport { NgView, ViewClassMeta, ViewExtensions, isInvisibleNode, isView, registerElement } from '../element-registry';\n\nexport function isActionItem(view: any): view is ActionItem {\n\treturn view instanceof ActionItem;\n}\n\nexport function isNavigationButton(view: any): view is NavigationButton {\n\treturn view instanceof NavigationButton;\n}\n\ntype NgActionBar = ActionBar & ViewExtensions;\n\nconst actionBarMeta: ViewClassMeta = {\n\tskipAddToDom: true,\n\tinsertChild: (parent: NgActionBar, child: NgView, next: any) => {\n\t\tif (isInvisibleNode(child)) {\n\t\t\treturn;\n\t\t} else if (isNavigationButton(child)) {\n\t\t\tparent.navigationButton = child;\n\t\t\tchild.parentNode = parent;\n\t\t} else if (isActionItem(child)) {\n\t\t\taddActionItem(parent, child, next);\n\t\t\tchild.parentNode = parent;\n\t\t} else if (isView(child)) {\n\t\t\tparent.titleView = child;\n\t\t}\n\t},\n\tremoveChild: (parent: NgActionBar, child: NgView) => {\n\t\tif (isInvisibleNode(child)) {\n\t\t\treturn;\n\t\t} else if (isNavigationButton(child)) {\n\t\t\tif (parent.navigationButton === child) {\n\t\t\t\tparent.navigationButton = null;\n\t\t\t}\n\n\t\t\tchild.parentNode = null;\n\t\t} else if (isActionItem(child)) {\n\t\t\tparent.actionItems.removeItem(child);\n\t\t\tchild.parentNode = null;\n\t\t} else if (isView(child) && parent.titleView && parent.titleView === child) {\n\t\t\tparent.titleView = null;\n\t\t}\n\t},\n};\n\nconst addActionItem = (bar: NgActionBar, item: ActionItem, next: ActionItem) => {\n\tif (next) {\n\t\tinsertActionItemBefore(bar, item, next);\n\t} else {\n\t\tappendActionItem(bar, item);\n\t}\n};\n\nconst insertActionItemBefore = (bar: NgActionBar, item: ActionItem, next: ActionItem) => {\n\tconst actionItems: ActionItems = bar.actionItems;\n\tconst actionItemsCollection: ActionItem[] = actionItems.getItems();\n\n\tconst indexToInsert = actionItemsCollection.indexOf(next);\n\tactionItemsCollection.splice(indexToInsert, 0, item);\n\n\t(<any>actionItems).setItems(actionItemsCollection);\n};\n\nconst appendActionItem = (bar: NgActionBar, item: ActionItem) => {\n\tbar.actionItems.addItem(item);\n};\n\nregisterElement('ActionBar', () => ActionBar, actionBarMeta);\nregisterElement('ActionItem', () => <any>ActionItem);\nregisterElement('NavigationButton', () => <any>NavigationButton);\n\n@Component({\n\tselector: 'ActionBar',\n\ttemplate: '<ng-content></ng-content>',\n})\nexport class ActionBarComponent {\n\tconstructor(public element: ElementRef, private page: Page) {\n\t\tif (!this.page) {\n\t\t\tthrow new Error('Inside ActionBarComponent but no Page found in DI.');\n\t\t}\n\n\t\tif (isBlank(this.page.actionBarHidden)) {\n\t\t\tthis.page.actionBarHidden = false;\n\t\t}\n\t\tthis.page.actionBar = this.element.nativeElement;\n\t\tthis.page.actionBar.update();\n\t}\n}\n\n@Component({\n\tselector: 'ActionBarExtension',\n\ttemplate: '',\n})\nexport class ActionBarScope {\n\t// tslint:disable-line:component-class-suffix\n\tconstructor(private page: Page) {\n\t\tif (!this.page) {\n\t\t\tthrow new Error('Inside ActionBarScope but no Page found in DI.');\n\t\t}\n\t}\n\n\tpublic onNavButtonInit(navBtn: NavigationButtonDirective) {\n\t\tthis.page.actionBar.navigationButton = navBtn.element.nativeElement;\n\t}\n\n\tpublic onNavButtonDestroy(navBtn: NavigationButtonDirective) {\n\t\tconst nav = <NavigationButton>navBtn.element.nativeElement;\n\t\tif (nav && this.page.actionBar.navigationButton === nav) {\n\t\t\tthis.page.actionBar.navigationButton = null;\n\t\t}\n\t}\n\n\tpublic onActionInit(item: ActionItemDirective) {\n\t\tthis.page.actionBar.actionItems.addItem(item.element.nativeElement);\n\t}\n\n\tpublic onActionDestroy(item: ActionItemDirective) {\n\t\tif (item.element.nativeElement.actionBar) {\n\t\t\tthis.page.actionBar.actionItems.removeItem(item.element.nativeElement);\n\t\t}\n\t}\n}\n\n@Directive({\n\tselector: 'ActionItem', // tslint:disable-line:directive-selector\n})\nexport class ActionItemDirective implements OnDestroy {\n\tconstructor(public element: ElementRef, @Optional() private ownerScope: ActionBarScope) {\n\t\tif (this.ownerScope) {\n\t\t\tthis.ownerScope.onActionInit(this);\n\t\t}\n\t}\n\n\tngOnDestroy() {\n\t\tif (this.ownerScope) {\n\t\t\tthis.ownerScope.onActionDestroy(this);\n\t\t}\n\t}\n}\n\n@Directive({\n\tselector: 'NavigationButton', // tslint:disable-line:directive-selector\n})\nexport class NavigationButtonDirective implements OnDestroy {\n\tconstructor(public element: ElementRef, @Optional() private ownerScope: ActionBarScope) {\n\t\tif (this.ownerScope) {\n\t\t\tthis.ownerScope.onNavButtonInit(this);\n\t\t}\n\t}\n\n\tngOnDestroy() {\n\t\tif (this.ownerScope) {\n\t\t\tthis.ownerScope.onNavButtonDestroy(this);\n\t\t}\n\t}\n}\n","import { Component, Inject } from '@angular/core';\nimport { isIOS, isAndroid } from '@nativescript/core';\n\n@Component({\n\tselector: 'android',\n\ttemplate: `<ng-content *ngIf=\"show\"></ng-content>`,\n})\nexport class AndroidFilterComponent {\n\tpublic show: boolean;\n\tconstructor() {\n\t\tthis.show = isAndroid;\n\t}\n}\n\n@Component({\n\tselector: 'ios',\n\ttemplate: `<ng-content *ngIf=\"show\"></ng-content>`,\n})\nexport class IosFilterComponent {\n\tpublic show: boolean;\n\tconstructor() {\n\t\tthis.show = isIOS;\n\t}\n}\n","import { ListViewComponent } from './list-view-comp';\nimport { TemplateKeyDirective, TemplatedItemsComponent } from './templated-items-comp';\nimport { TabViewDirective, TabViewItemDirective } from './tab-view';\nimport { ActionBarComponent, ActionBarScope, ActionItemDirective, NavigationButtonDirective } from './action-bar';\nimport { AndroidFilterComponent, IosFilterComponent } from './platform-filters';\nexport { ModalDialogOptions, ModalDialogParams, ModalDialogService } from './dialogs';\n\nexport const NS_DIRECTIVES = [ListViewComponent, TemplateKeyDirective, TabViewDirective, TabViewItemDirective, ActionBarComponent, ActionBarScope, ActionItemDirective, NavigationButtonDirective, AndroidFilterComponent, IosFilterComponent];\n\nexport { ListViewComponent, TemplateKeyDirective, TemplatedItemsComponent, TabViewDirective, TabViewItemDirective, ActionBarComponent, ActionBarScope, ActionItemDirective, NavigationButtonDirective, AndroidFilterComponent, IosFilterComponent };\n","import { CommonModule } from '@angular/common';\nimport { NO_ERRORS_SCHEMA, NgModule } from '@angular/core';\n\nimport { ModalDialogService } from './directives/dialogs';\nimport { defaultDeviceProvider, defaultFrameProvider, defaultPageProvider } from './platform-providers';\nimport { ListViewComponent } from './directives/list-view-comp';\nimport { TemplateKeyDirective } from './directives/templated-items-comp';\nimport { TabViewDirective, TabViewItemDirective } from './directives/tab-view';\nimport { ActionBarComponent, ActionBarScope, ActionItemDirective, NavigationButtonDirective } from './directives/action-bar';\nimport { AndroidFilterComponent, IosFilterComponent } from './directives/platform-filters';\n\n@NgModule({\n\tdeclarations: [ListViewComponent, TemplateKeyDirective, TabViewDirective, TabViewItemDirective, ActionBarComponent, ActionBarScope, ActionItemDirective, NavigationButtonDirective, AndroidFilterComponent, IosFilterComponent],\n\tproviders: [ModalDialogService, defaultDeviceProvider, defaultFrameProvider, defaultPageProvider],\n\timports: [CommonModule],\n\texports: [CommonModule, ListViewComponent, TemplateKeyDirective, TabViewDirective, TabViewItemDirective, ActionBarComponent, ActionBarScope, ActionItemDirective, NavigationButtonDirective, AndroidFilterComponent, IosFilterComponent],\n\tschemas: [NO_ERRORS_SCHEMA],\n})\nexport class NativeScriptCommonModule {}\n\nexport * from './directives';\n","import { View, unsetValue, Placeholder, ContentView, LayoutBase, platformNames, Device } from '@nativescript/core';\nimport { CommentNode, InvisibleNode, NgView, TextNode, ViewExtensions, getViewClass, getViewMeta, isDetachedElement, isInvisibleNode, isKnownView, isView } from './element-registry';\n\nimport { NativeScriptDebug } from './trace';\n\nconst ELEMENT_NODE_TYPE = 1;\nconst XML_ATTRIBUTES = Object.freeze(['style', 'rows', 'columns', 'fontAttributes']);\nconst whiteSpaceSplitter = /\\s+/;\n\n// export type ViewExtensions = ViewExtensions;\n// export type NgView = NgView;\nexport type NgLayoutBase = LayoutBase & ViewExtensions;\nexport type NgContentView = ContentView & ViewExtensions;\nexport type NgPlaceholder = Placeholder & ViewExtensions;\nexport type BeforeAttachAction = (view: View) => void;\n\nexport function isLayout(view: any): view is NgLayoutBase {\n\treturn view instanceof LayoutBase;\n}\n\nexport function isContentView(view: any): view is NgContentView {\n\treturn view instanceof ContentView;\n}\n\nconst propertyMaps: Map<Function, Map<string, string>> = new Map<Function, Map<string, string>>();\n\nexport class ViewUtil {\n\tprivate isIos: boolean;\n\tprivate isAndroid: boolean;\n\n\tconstructor(device: typeof Device) {\n\t\tthis.isIos = device.os === platformNames.ios;\n\t\tthis.isAndroid = device.os === platformNames.android;\n\t}\n\n\tpublic insertChild(parent: View, child: View, previous?: NgView, next?: NgView) {\n\t\tif (!parent) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst extendedParent = this.ensureNgViewExtensions(parent);\n\t\tconst extendedChild = this.ensureNgViewExtensions(child);\n\n\t\tif (!previous) {\n\t\t\tprevious = extendedParent.lastChild;\n\t\t}\n\t\tthis.addToQueue(extendedParent, extendedChild, previous, next);\n\n\t\tif (isInvisibleNode(child)) {\n\t\t\textendedChild.parentNode = extendedParent;\n\t\t}\n\n\t\tif (!isDetachedElement(child)) {\n\t\t\tconst nextVisual = this.findNextVisual(next);\n\t\t\tthis.addToVisualTree(extendedParent, extendedChild, nextVisual);\n\t\t}\n\t}\n\n\tprivate addToQueue(parent: NgView, child: NgView, previous: NgView, next: NgView): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`ViewUtil.addToQueue parent: ${parent}, view: ${child}, ` + `previous: ${previous}, next: ${next}`);\n\t\t}\n\n\t\tif (previous) {\n\t\t\tprevious.nextSibling = child;\n\t\t} else {\n\t\t\tparent.firstChild = child;\n\t\t}\n\n\t\tif (next) {\n\t\t\tchild.nextSibling = next;\n\t\t} else {\n\t\t\tthis.appendToQueue(parent, child);\n\t\t}\n\t}\n\n\tprivate appendToQueue(parent: NgView, view: NgView) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`ViewUtil.appendToQueue parent: ${parent} view: ${view}`);\n\t\t}\n\n\t\tif (parent.lastChild) {\n\t\t\tparent.lastChild.nextSibling = view;\n\t\t}\n\n\t\tparent.lastChild = view;\n\t}\n\n\tprivate addToVisualTree(parent: NgView, child: NgView, next: NgView): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`ViewUtil.addToVisualTree parent: ${parent}, view: ${child}, next: ${next}`);\n\t\t}\n\n\t\tif (parent.meta && parent.meta.insertChild) {\n\t\t\tparent.meta.insertChild(parent, child, next);\n\t\t} else if (isLayout(parent)) {\n\t\t\tthis.insertToLayout(parent, child, next);\n\t\t} else if (isContentView(parent)) {\n\t\t\tparent.content = child;\n\t\t} else if (parent && (<any>parent)._addChildFromBuilder) {\n\t\t\t(<any>parent)._addChildFromBuilder(child.nodeName, child);\n\t\t}\n\t}\n\n\tprivate insertToLayout(parent: NgLayoutBase, child: NgView, next: NgView): void {\n\t\tif (child.parent === parent) {\n\t\t\tthis.removeLayoutChild(parent, child);\n\t\t}\n\n\t\tconst nextVisual = this.findNextVisual(next);\n\t\tif (nextVisual) {\n\t\t\tconst index = parent.getChildIndex(nextVisual);\n\t\t\tparent.insertChild(child, index);\n\t\t} else {\n\t\t\tparent.addChild(child);\n\t\t}\n\t}\n\n\tprivate findNextVisual(view: NgView): NgView {\n\t\tlet next = view;\n\t\twhile (next && isDetachedElement(next)) {\n\t\t\tnext = next.nextSibling;\n\t\t}\n\n\t\treturn next;\n\t}\n\n\tpublic removeChild(parent: View, child: View) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`ViewUtil.removeChild parent: ${parent} child: ${child}`);\n\t\t}\n\n\t\tif (!parent) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst extendedParent = this.ensureNgViewExtensions(parent);\n\t\tconst extendedChild = this.ensureNgViewExtensions(child);\n\n\t\tthis.removeFromQueue(extendedParent, extendedChild);\n\t\tif (!isDetachedElement(extendedChild)) {\n\t\t\tthis.removeFromVisualTree(extendedParent, extendedChild);\n\t\t}\n\t}\n\n\tprivate removeFromQueue(parent: NgView, child: NgView) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`ViewUtil.removeFromQueue parent: ${parent} child: ${child}`);\n\t\t}\n\n\t\tif (parent.firstChild === child && parent.lastChild === child) {\n\t\t\tparent.firstChild = null;\n\t\t\tparent.lastChild = null;\n\t\t\tchild.nextSibling = null;\n\t\t\treturn;\n\t\t}\n\n\t\tif (parent.firstChild === child) {\n\t\t\tparent.firstChild = child.nextSibling;\n\t\t}\n\n\t\tconst previous = this.findPreviousElement(parent, child);\n\t\tif (parent.lastChild === child) {\n\t\t\tparent.lastChild = previous;\n\t\t}\n\n\t\tif (previous) {\n\t\t\tprevious.nextSibling = child.nextSibling;\n\t\t}\n\n\t\tchild.nextSibling = null;\n\t}\n\n\t// NOTE: This one is O(n) - use carefully\n\tprivate findPreviousElement(parent: NgView, child: NgView): NgView {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`ViewUtil.findPreviousElement parent: ${parent} child: ${child}`);\n\t\t}\n\n\t\tlet previousVisual;\n\t\tif (isLayout(parent)) {\n\t\t\tpreviousVisual = this.getPreviousVisualElement(parent, child);\n\t\t}\n\n\t\tlet previous = previousVisual || parent.firstChild;\n\n\t\t// since detached elements are not added to the visual tree,\n\t\t// we need to find the actual previous sibling of the view,\n\t\t// which may as well be an invisible node\n\t\twhile (previous && previous !== child && previous.nextSibling !== child) {\n\t\t\tprevious = previous.nextSibling;\n\t\t}\n\n\t\treturn previous;\n\t}\n\n\tprivate getPreviousVisualElement(parent: NgLayoutBase, child: NgView): NgView {\n\t\tconst elementIndex = parent.getChildIndex(child);\n\n\t\tif (elementIndex > 0) {\n\t\t\treturn parent.getChildAt(elementIndex - 1) as NgView;\n\t\t}\n\t}\n\n\t// NOTE: This one is O(n) - use carefully\n\tpublic getChildIndex(parent: any, child: NgView) {\n\t\tif (isLayout(parent)) {\n\t\t\treturn parent.getChildIndex(child);\n\t\t} else if (isContentView(parent)) {\n\t\t\treturn child === parent.content ? 0 : -1;\n\t\t}\n\t}\n\n\tprivate removeFromVisualTree(parent: NgView, child: NgView) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`ViewUtil.removeFromVisualTree parent: ${parent} child: ${child}`);\n\t\t}\n\n\t\tif (parent.meta && parent.meta.removeChild) {\n\t\t\tparent.meta.removeChild(parent, child);\n\t\t} else if (isLayout(parent)) {\n\t\t\tthis.removeLayoutChild(parent, child);\n\t\t} else if (isContentView(parent) && parent.content === child) {\n\t\t\tparent.content = null;\n\t\t} else if (isView(parent)) {\n\t\t\tparent._removeView(child);\n\t\t}\n\t}\n\n\tprivate removeLayoutChild(parent: NgLayoutBase, child: NgView): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`ViewUtil.removeLayoutChild parent: ${parent} child: ${child}`);\n\t\t}\n\n\t\tconst index = parent.getChildIndex(child);\n\n\t\tif (index !== -1) {\n\t\t\tparent.removeChild(child);\n\t\t}\n\t}\n\n\tpublic createComment(): InvisibleNode {\n\t\treturn new CommentNode();\n\t}\n\n\tpublic createText(): InvisibleNode {\n\t\treturn new TextNode();\n\t}\n\n\tpublic createView(name: string): NgView {\n\t\tconst originalName = name;\n\t\tif (!isKnownView(name)) {\n\t\t\tname = 'ProxyViewContainer';\n\t\t}\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`Creating view: ${originalName} ${name}`);\n\t\t}\n\n\t\tconst viewClass = getViewClass(name);\n\t\tconst view = <NgView>new viewClass();\n\t\tconst ngView = this.setNgViewExtensions(view, name);\n\n\t\treturn ngView;\n\t}\n\n\tprivate ensureNgViewExtensions(view: View): NgView {\n\t\tif (view.hasOwnProperty('meta')) {\n\t\t\treturn view as NgView;\n\t\t} else {\n\t\t\tconst name = view.cssType;\n\t\t\tconst ngView = this.setNgViewExtensions(view, name);\n\n\t\t\treturn ngView;\n\t\t}\n\t}\n\n\tprivate setNgViewExtensions(view: View, name: string): NgView {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`Make into a NgView view: ${view} name: \"${name}\"`);\n\t\t}\n\n\t\tconst ngView = view as NgView;\n\t\tngView.nodeName = name;\n\t\tngView.meta = getViewMeta(name);\n\n\t\t// we're setting the node type of the view\n\t\t// to 'element' because of checks done in the\n\t\t// dom animation engine\n\t\tngView.nodeType = ELEMENT_NODE_TYPE;\n\n\t\treturn ngView;\n\t}\n\n\tpublic setProperty(view: NgView, attributeName: string, value: any, namespace?: string): void {\n\t\tif (!view || (namespace && !this.runsIn(namespace))) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (attributeName.indexOf('.') !== -1) {\n\t\t\t// Handle nested properties\n\t\t\tconst properties = attributeName.split('.');\n\t\t\tattributeName = properties[properties.length - 1];\n\n\t\t\tlet propMap = this.getProperties(view);\n\t\t\tlet i = 0;\n\t\t\twhile (i < properties.length - 1 && typeof view !== 'undefined') {\n\t\t\t\tlet prop = properties[i];\n\t\t\t\tif (propMap.has(prop)) {\n\t\t\t\t\tprop = propMap.get(prop);\n\t\t\t\t}\n\n\t\t\t\tview = view[prop];\n\t\t\t\tpropMap = this.getProperties(view);\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof view !== 'undefined') {\n\t\t\tthis.setPropertyInternal(view, attributeName, value);\n\t\t}\n\t}\n\n\tprivate runsIn(platform: string): boolean {\n\t\treturn (platform === 'ios' && this.isIos) || (platform === 'android' && this.isAndroid);\n\t}\n\n\tprivate setPropertyInternal(view: NgView, attributeName: string, value: any): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.viewUtilLog(`Setting attribute: ${attributeName}=${value} to ${view}`);\n\t\t}\n\n\t\tif (attributeName === 'class') {\n\t\t\tthis.setClasses(view, value);\n\t\t\treturn;\n\t\t}\n\n\t\tif (XML_ATTRIBUTES.indexOf(attributeName) !== -1) {\n\t\t\tview[attributeName] = value;\n\t\t\treturn;\n\t\t}\n\n\t\tconst propMap = this.getProperties(view);\n\t\tconst propertyName = propMap.get(attributeName);\n\n\t\t// Ensure the children of a collection currently have no parent set.\n\t\tif (Array.isArray(value)) {\n\t\t\tthis.removeParentReferencesFromItems(value);\n\t\t}\n\n\t\tif (propertyName) {\n\t\t\t// We have a lower-upper case mapped property.\n\t\t\tview[propertyName] = value;\n\t\t\treturn;\n\t\t}\n\n\t\t// Unknown attribute value -- just set it to our object as is.\n\t\tview[attributeName] = value;\n\t}\n\n\tprivate removeParentReferencesFromItems(items: any[]): void {\n\t\tfor (const item of items) {\n\t\t\tif (item.parent && item.parentNode) {\n\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\tNativeScriptDebug.viewUtilLog(`Unassigning parent ${item.parentNode} on value: ${item}`);\n\t\t\t\t}\n\t\t\t\titem.parent = undefined;\n\t\t\t\titem.parentNode = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getProperties(instance: any): Map<string, string> {\n\t\tconst type = instance && instance.constructor;\n\t\tif (!type) {\n\t\t\treturn new Map<string, string>();\n\t\t}\n\n\t\tif (!propertyMaps.has(type)) {\n\t\t\tlet propMap = new Map<string, string>();\n\t\t\tfor (let propName in instance) {\n\t\t\t\t// tslint:disable:forin\n\t\t\t\tpropMap.set(propName.toLowerCase(), propName);\n\t\t\t}\n\t\t\tpropertyMaps.set(type, propMap);\n\t\t}\n\n\t\treturn propertyMaps.get(type);\n\t}\n\n\tprivate cssClasses(view: NgView) {\n\t\tif (!view.ngCssClasses) {\n\t\t\tview.ngCssClasses = new Map<string, boolean>();\n\t\t}\n\t\treturn view.ngCssClasses;\n\t}\n\n\tpublic addClass(view: NgView, className: string): void {\n\t\tthis.cssClasses(view).set(className, true);\n\t\tthis.syncClasses(view);\n\t}\n\n\tpublic removeClass(view: NgView, className: string): void {\n\t\tthis.cssClasses(view).delete(className);\n\t\tthis.syncClasses(view);\n\t}\n\n\tprivate setClasses(view: NgView, classesValue: string): void {\n\t\tlet classes = classesValue.split(whiteSpaceSplitter);\n\t\tthis.cssClasses(view).clear();\n\t\tclasses.forEach((className) => this.cssClasses(view).set(className, true));\n\t\tthis.syncClasses(view);\n\t}\n\n\tprivate syncClasses(view: NgView): void {\n\t\tlet classValue = (<any>Array).from(this.cssClasses(view).keys()).join(' ');\n\t\tview.className = classValue;\n\t}\n\n\tpublic setStyle(view: NgView, styleName: string, value: any) {\n\t\tview.style[styleName] = value;\n\t}\n\n\tpublic removeStyle(view: NgView, styleName: string) {\n\t\tview.style[styleName] = unsetValue;\n\t}\n}\n","import { Inject, Injectable, Optional, NgZone, Renderer2, RendererFactory2, RendererType2, RendererStyleFlags2, ViewEncapsulation } from '@angular/core';\n\nimport { View, getViewById, profile } from '@nativescript/core';\n\nimport { ViewUtil } from './view-util';\nimport { NgView, InvisibleNode } from './element-registry';\nimport { NativeScriptDebug } from './trace';\n\nexport interface ElementReference {\n\tprevious: NgView;\n\tnext: NgView;\n}\n\n@Injectable()\nexport class NativeScriptRenderer extends Renderer2 {\n\tdata: { [key: string]: any } = Object.create(null);\n\n\tconstructor(private rootView: NgView, private zone: NgZone, private viewUtil: ViewUtil) {\n\t\tsuper();\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog('NativeScriptRenderer created');\n\t\t}\n\t}\n\n\t@profile\n\tappendChild(parent: NgView, newChild: NgView): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.appendChild child: ${newChild} parent: ${parent}`);\n\t\t}\n\t\tthis.viewUtil.insertChild(parent, newChild);\n\t}\n\n\t@profile\n\tinsertBefore(parent: NgView, newChild: NgView, { previous, next }: ElementReference): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.insertBefore child: ${newChild} ` + `parent: ${parent} previous: ${previous} next: ${next}`);\n\t\t}\n\t\tthis.viewUtil.insertChild(parent, newChild, previous, next);\n\t}\n\n\t@profile\n\tremoveChild(parent: any, oldChild: NgView): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.removeChild child: ${oldChild} parent: ${parent}`);\n\t\t}\n\t\tthis.viewUtil.removeChild(parent, oldChild);\n\t}\n\n\t@profile\n\tselectRootElement(selector: string): NgView {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.selectRootElement: ${selector}`);\n\t\t}\n\t\tif (selector && selector[0] === '#') {\n\t\t\tconst result = getViewById(this.rootView, selector.slice(1));\n\t\t\treturn (result || this.rootView) as NgView;\n\t\t}\n\t\treturn this.rootView;\n\t}\n\n\t@profile\n\tparentNode(node: NgView): any {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.parentNode for node: ${node} is ${node.parentNode}`);\n\t\t}\n\t\treturn node.parentNode;\n\t}\n\n\t@profile\n\tnextSibling(node: NgView): ElementReference {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.nextSibling of ${node} is ${node.nextSibling}`);\n\t\t}\n\n\t\treturn {\n\t\t\tprevious: node,\n\t\t\tnext: node.nextSibling,\n\t\t};\n\t}\n\n\t@profile\n\tcreateComment(_value: any): InvisibleNode {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.createComment ${_value}`);\n\t\t}\n\t\treturn this.viewUtil.createComment();\n\t}\n\n\t@profile\n\tcreateElement(name: any, _namespace: string): NgView {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.createElement: ${name}`);\n\t\t}\n\t\treturn this.viewUtil.createView(name);\n\t}\n\n\t@profile\n\tcreateText(_value: string): InvisibleNode {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.createText ${_value}`);\n\t\t}\n\t\treturn this.viewUtil.createText();\n\t}\n\n\t@profile\n\tcreateViewRoot(hostElement: NgView): NgView {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.createViewRoot ${hostElement.nodeName}`);\n\t\t}\n\t\treturn hostElement;\n\t}\n\n\t@profile\n\tprojectNodes(parentElement: NgView, nodes: NgView[]): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog('NativeScriptRenderer.projectNodes');\n\t\t}\n\t\tnodes.forEach((node) => this.viewUtil.insertChild(parentElement, node));\n\t}\n\n\t@profile\n\tdestroy() {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog('NativeScriptRenderer.destroy');\n\t\t}\n\t\t// Seems to be called on component dispose only (router outlet)\n\t\t// TODO: handle this when we resolve routing and navigation.\n\t}\n\n\t@profile\n\tsetAttribute(view: NgView, name: string, value: string, namespace?: string) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.setAttribute ${view} : ${name} = ${value}, namespace: ${namespace}`);\n\t\t}\n\t\treturn this.viewUtil.setProperty(view, name, value, namespace);\n\t}\n\n\t@profile\n\tremoveAttribute(_el: NgView, _name: string): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.removeAttribute ${_el}: ${_name}`);\n\t\t}\n\t}\n\n\t@profile\n\tsetProperty(view: any, name: string, value: any) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.setProperty ${view} : ${name} = ${value}`);\n\t\t}\n\t\treturn this.viewUtil.setProperty(view, name, value);\n\t}\n\n\t@profile\n\taddClass(view: NgView, name: string): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.addClass ${name}`);\n\t\t}\n\t\tthis.viewUtil.addClass(view, name);\n\t}\n\n\t@profile\n\tremoveClass(view: NgView, name: string): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.removeClass ${name}`);\n\t\t}\n\t\tthis.viewUtil.removeClass(view, name);\n\t}\n\n\t@profile\n\tsetStyle(view: NgView, styleName: string, value: any, _flags?: RendererStyleFlags2): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.setStyle: ${styleName} = ${value}`);\n\t\t}\n\t\tthis.viewUtil.setStyle(view, styleName, value);\n\t}\n\n\t@profile\n\tremoveStyle(view: NgView, styleName: string, _flags?: RendererStyleFlags2): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog('NativeScriptRenderer.removeStyle: ${styleName}');\n\t\t}\n\t\tthis.viewUtil.removeStyle(view, styleName);\n\t}\n\n\t// Used only in debug mode to serialize property changes to comment nodes,\n\t// such as <template> placeholders.\n\t@profile\n\tsetBindingDebugInfo(renderElement: NgView, propertyName: string, propertyValue: string): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.setBindingDebugInfo: ${renderElement}, ${propertyName} = ${propertyValue}`);\n\t\t}\n\t}\n\n\t@profile\n\tsetElementDebugInfo(renderElement: any, _info: any /*RenderDebugInfo*/): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.setElementDebugInfo: ${renderElement}`);\n\t\t}\n\t}\n\n\t@profile\n\tinvokeElementMethod(_renderElement: NgView, methodName: string, args: Array<any>) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.invokeElementMethod ${methodName} ${args}`);\n\t\t}\n\t}\n\n\t@profile\n\tsetValue(_renderNode: any, _value: string) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.setValue renderNode: ${_renderNode}, value: ${_value}`);\n\t\t}\n\t}\n\n\t@profile\n\tlisten(renderElement: any, eventName: string, callback: (event: any) => boolean): () => void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRenderer.listen: ${eventName}`);\n\t\t}\n\t\t// Explicitly wrap in zone\n\t\tlet zonedCallback = (...args) => {\n\t\t\tthis.zone.run(() => {\n\t\t\t\tcallback.apply(undefined, args);\n\t\t\t});\n\t\t};\n\n\t\trenderElement.on(eventName, zonedCallback);\n\t\tif (eventName === View.loadedEvent && renderElement.isLoaded) {\n\t\t\tconst notifyData = { eventName: View.loadedEvent, object: renderElement };\n\t\t\tzonedCallback(notifyData);\n\t\t}\n\t\treturn () => renderElement.off(eventName, zonedCallback);\n\t}\n}\n","import { Inject, Injectable, RendererFactory2, Optional, NgZone, RendererType2 } from '@angular/core';\nimport { View, getViewById, Application, profile } from '@nativescript/core';\nimport { APP_ROOT_VIEW, getRootPage } from './platform-providers';\nimport { ViewUtil } from './view-util';\nimport { NgView, InvisibleNode } from './element-registry';\nimport { NativeScriptDebug } from './trace';\nimport { NativeScriptRenderer } from './renderer';\n\n// CONTENT_ATTR not exported from NativeScript_renderer - we need it for styles application.\nconst COMPONENT_REGEX = /%COMP%/g;\nconst ATTR_SANITIZER = /-/g;\nexport const COMPONENT_VARIABLE = '%COMP%';\nexport const HOST_ATTR = `_nghost-${COMPONENT_VARIABLE}`;\nexport const CONTENT_ATTR = `_ngcontent-${COMPONENT_VARIABLE}`;\n\nconst replaceNgAttribute = function (input: string, componentId: string): string {\n\treturn input.replace(COMPONENT_REGEX, componentId);\n};\n\nconst addScopedStyleToCss = profile(`\"renderer\".addScopedStyleToCss`, function addScopedStyleToCss(style: string): void {\n\tApplication.addCss(style, true);\n});\n\n@Injectable()\nexport class EmulatedRenderer extends NativeScriptRenderer {\n\tprivate contentAttr: string;\n\tprivate hostAttr: string;\n\n\tconstructor(component: RendererType2, rootView: NgView, zone: NgZone, viewUtil: ViewUtil) {\n\t\tsuper(rootView, zone, viewUtil);\n\n\t\tconst componentId = component.id.replace(ATTR_SANITIZER, '_');\n\t\tthis.contentAttr = replaceNgAttribute(CONTENT_ATTR, componentId);\n\t\tthis.hostAttr = replaceNgAttribute(HOST_ATTR, componentId);\n\t\tthis.addStyles(component.styles, componentId);\n\t}\n\n\tapplyToHost(view: NgView) {\n\t\tsuper.setAttribute(view, this.hostAttr, '');\n\t}\n\n\tappendChild(parent: any, newChild: NgView): void {\n\t\tsuper.appendChild(parent, newChild);\n\t}\n\n\tcreateElement(parent: any, name: string): NgView {\n\t\tconst view = super.createElement(parent, name);\n\n\t\t// Set an attribute to the view to scope component-specific css.\n\t\t// The property name is pre-generated by Angular.\n\t\tsuper.setAttribute(view, this.contentAttr, '');\n\n\t\treturn view;\n\t}\n\n\t@profile\n\tprivate addStyles(styles: (string | any[])[], componentId: string) {\n\t\tstyles\n\t\t\t.map((s) => s.toString())\n\t\t\t.map((s) => replaceNgAttribute(s, componentId))\n\t\t\t.forEach(addScopedStyleToCss);\n\t}\n}\n","import { Inject, Injectable, RendererFactory2, Optional, NgZone, RendererType2, ViewEncapsulation } from '@angular/core';\nimport { View, getViewById, Application, profile, Device } from '@nativescript/core';\nimport { APP_ROOT_VIEW, getRootPage } from './platform-providers';\nimport { ViewUtil } from './view-util';\nimport { NgView, InvisibleNode } from './element-registry';\nimport { NativeScriptDebug } from './trace';\nimport { NativeScriptRenderer } from './renderer';\nimport { EmulatedRenderer } from './renderer-emulated';\n\nconst addStyleToCss = profile('\"renderer\".addStyleToCss', function addStyleToCss(style: string): void {\n\tApplication.addCss(style);\n});\n\n@Injectable()\nexport class NativeScriptRendererFactory implements RendererFactory2 {\n\tcomponentRenderers = new Map<string, NativeScriptRenderer>();\n\tviewUtil: ViewUtil;\n\tdefaultRenderer: NativeScriptRenderer;\n\trootNgView: NgView;\n\n\tconstructor(@Optional() @Inject(APP_ROOT_VIEW) rootView: View, private zone: NgZone) {\n\t\tthis.viewUtil = new ViewUtil(Device);\n\t\tthis.setRootNgView(rootView);\n\t\tthis.defaultRenderer = new NativeScriptRenderer(this.rootNgView, zone, this.viewUtil);\n\t}\n\n\tprivate setRootNgView(rootView: any) {\n\t\tif (!rootView) {\n\t\t\trootView = getRootPage();\n\t\t}\n\n\t\trootView.nodeName = 'NONE';\n\t\tthis.rootNgView = rootView;\n\t}\n\n\tcreateRenderer(element: any, type: RendererType2): NativeScriptRenderer {\n\t\tif (!element || !type) {\n\t\t\treturn this.defaultRenderer;\n\t\t}\n\n\t\tlet renderer = this.componentRenderers.get(type.id);\n\t\tif (renderer) {\n\t\t\tif (renderer instanceof EmulatedRenderer) {\n\t\t\t\trenderer.applyToHost(element);\n\t\t\t}\n\n\t\t\treturn renderer;\n\t\t}\n\n\t\tif (type.encapsulation === ViewEncapsulation.None) {\n\t\t\ttype.styles.map((s) => s.toString()).forEach(addStyleToCss);\n\t\t\trenderer = this.defaultRenderer;\n\t\t} else {\n\t\t\trenderer = new EmulatedRenderer(type, this.rootNgView, this.zone, this.viewUtil);\n\t\t\t(<EmulatedRenderer>renderer).applyToHost(element);\n\t\t}\n\n\t\tthis.componentRenderers.set(type.id, renderer);\n\t\treturn renderer;\n\t}\n\n\tngOnDestroy(): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.rendererLog(`NativeScriptRendererFactory.ngOnDestroy()`);\n\t\t}\n\n\t\twhile (this.rootNgView && this.rootNgView.firstChild) {\n\t\t\tthis.viewUtil.removeChild(this.rootNgView, this.rootNgView.firstChild);\n\t\t}\n\t}\n}\n","import { ApplicationModule, ErrorHandler, NO_ERRORS_SCHEMA, NgModule, RendererFactory2, SystemJsNgModuleLoader, Optional, SkipSelf, ɵINJECTOR_SCOPE } from '@angular/core';\n\nimport { ViewportScroller, ɵNullViewportScroller as NullViewportScroller } from '@angular/common';\n\nimport { NativeScriptCommonModule } from './common';\nimport { NativeScriptRendererFactory } from './renderer-factory';\nimport { DetachedLoader } from './common/detached-loader';\nimport { throwIfAlreadyLoaded } from './common/utils';\nimport { FrameService } from './frame.service';\n\nexport function errorHandlerFactory() {\n\treturn new ErrorHandler();\n}\n\nexport { DetachedLoader } from './common/detached-loader';\n\n@NgModule({\n\tdeclarations: [DetachedLoader],\n\tproviders: [FrameService, NativeScriptRendererFactory, SystemJsNgModuleLoader, { provide: ɵINJECTOR_SCOPE, useValue: 'root' }, { provide: ErrorHandler, useFactory: errorHandlerFactory }, { provide: RendererFactory2, useExisting: NativeScriptRendererFactory }, { provide: ViewportScroller, useClass: NullViewportScroller }],\n\tentryComponents: [DetachedLoader],\n\timports: [ApplicationModule, NativeScriptCommonModule],\n\texports: [ApplicationModule, NativeScriptCommonModule, DetachedLoader],\n\tschemas: [NO_ERRORS_SCHEMA],\n})\nexport class NativeScriptModule {\n\tconstructor(@Optional() @SkipSelf() parentModule: NativeScriptModule) {\n\t\t// Prevents NativeScriptModule from getting imported multiple times\n\t\tthrowIfAlreadyLoaded(parentModule, 'NativeScriptModule');\n\t}\n}\n","import { KeyframeAnimation, KeyframeAnimationInfo, KeyframeDeclaration, KeyframeInfo, parseKeyframeDeclarations, animationTimingFunctionConverter } from '@nativescript/core';\n\nexport interface Keyframe {\n\t[key: string]: string | number;\n\toffset: number;\n}\n\nconst DASH_CASE_REGEXP = /-+([a-z0-9])/g;\nexport function dashCaseToCamelCase(input: string): string {\n\treturn input.replace(DASH_CASE_REGEXP, (...m: any[]) => m[1].toUpperCase());\n}\n\nexport function createKeyframeAnimation(styles: Keyframe[], duration: number, delay: number, easing: string): KeyframeAnimation {\n\tconst info = createKeyframeAnimationInfo(styles, duration, delay, easing);\n\treturn KeyframeAnimation.keyframeAnimationFromInfo(info);\n}\n\nconst createKeyframeAnimationInfo = (styles: Keyframe[], duration: number, delay: number, easing: string): KeyframeAnimationInfo => ({\n\tisForwards: true,\n\tduration: duration || 0.01,\n\tdelay,\n\tcurve: getCurve(easing),\n\tkeyframes: styles.map(parseAnimationKeyframe),\n});\n\nconst getCurve = (value: string) => animationTimingFunctionConverter(value);\n\nconst parseAnimationKeyframe = (styles: Keyframe): KeyframeInfo => ({\n\tduration: getKeyframeDuration(styles),\n\tdeclarations: getDeclarations(styles),\n});\n\nconst getKeyframeDuration = (styles: Keyframe): number => styles.offset;\n\nfunction getDeclarations(styles: Keyframe): KeyframeDeclaration[] {\n\tconst unparsedDeclarations: KeyframeDeclaration[] = Object.keys(styles).map((property) => ({ property, value: styles[property] }));\n\n\treturn parseKeyframeDeclarations(unparsedDeclarations);\n}\n","import { AnimationPlayer } from '@angular/animations';\nimport { View, EventData, KeyframeAnimation } from '@nativescript/core';\n\nimport { Keyframe, createKeyframeAnimation } from './utils';\nimport { NgView } from '../element-registry';\nimport { NativeScriptDebug } from '../trace';\n\nexport class NativeScriptAnimationPlayer implements AnimationPlayer {\n\tpublic parentPlayer: AnimationPlayer = null;\n\n\tprivate _startSubscriptions: Function[] = [];\n\tprivate _doneSubscriptions: Function[] = [];\n\tprivate _finished = false;\n\tprivate _started = false;\n\tprivate animation: KeyframeAnimation;\n\n\tconstructor(private target: NgView, keyframes: Keyframe[], private duration: number, private delay: number, easing: string) {\n\t\tthis.initKeyframeAnimation(keyframes, duration, delay, easing);\n\t}\n\n\tget totalTime(): number {\n\t\treturn this.delay + this.duration;\n\t}\n\n\tinit(): void {}\n\n\thasStarted(): boolean {\n\t\treturn this._started;\n\t}\n\n\tonStart(fn: Function): void {\n\t\tthis._startSubscriptions.push(fn);\n\t}\n\tonDone(fn: Function): void {\n\t\tthis._doneSubscriptions.push(fn);\n\t}\n\tonDestroy(fn: Function): void {\n\t\tthis._doneSubscriptions.push(fn);\n\t}\n\n\tplay(): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationPlayer.play`);\n\t\t}\n\n\t\tif (!this.animation) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._started) {\n\t\t\tthis._started = true;\n\t\t\tthis._startSubscriptions.forEach((fn) => fn());\n\t\t\tthis._startSubscriptions = [];\n\t\t}\n\n\t\t// When this issue https://github.com/NativeScript/NativeScript/issues/7984 is fixes in @nativescript/core\n\t\t// we can change this fix and apply the one that is recommended in that issue.\n\t\tif (this.target.isLoaded) {\n\t\t\tthis.playAnimation();\n\t\t} else {\n\t\t\tthis.target.on(View.loadedEvent, this.onTargetLoaded.bind(this));\n\t\t}\n\t}\n\n\tprivate onTargetLoaded(args: EventData) {\n\t\tthis.target.off(View.loadedEvent, this.onTargetLoaded);\n\t\tthis.playAnimation();\n\t}\n\n\tprivate playAnimation() {\n\t\tthis.animation\n\t\t\t.play(this.target)\n\t\t\t.then(() => this.onFinish())\n\t\t\t.catch((_e) => {});\n\t}\n\n\tpause(): void {}\n\n\tfinish(): void {\n\t\tthis.onFinish();\n\t}\n\n\treset(): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationPlayer.reset`);\n\t\t}\n\n\t\tif (this.animation && this.animation.isPlaying) {\n\t\t\tthis.animation.cancel();\n\t\t}\n\t}\n\n\trestart(): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationPlayer.restart`);\n\t\t}\n\n\t\tthis.reset();\n\t\tthis.play();\n\t}\n\n\tdestroy(): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationPlayer.destroy`);\n\t\t}\n\t\tthis.onFinish();\n\t}\n\n\tsetPosition(_p: any): void {\n\t\tthrow new Error('AnimationPlayer.setPosition method is not supported!');\n\t}\n\n\tgetPosition(): number {\n\t\treturn 0;\n\t}\n\n\tprivate initKeyframeAnimation(keyframes: Keyframe[], duration: number, delay: number, easing: string) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationPlayer.initKeyframeAnimation`);\n\t\t}\n\n\t\tthis.animation = createKeyframeAnimation(keyframes, duration, delay, easing);\n\t}\n\n\tprivate onFinish() {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationPlayer.onFinish`);\n\t\t}\n\n\t\tif (this._finished) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._finished = true;\n\t\tthis._started = false;\n\t\tthis._doneSubscriptions.forEach((fn) => fn());\n\t\tthis._doneSubscriptions = [];\n\t}\n}\n","import { AnimationPlayer } from '@angular/animations';\nimport { AnimationDriver } from '@angular/animations/browser';\nimport { ProxyViewContainer, eachDescendant, CssAnimationProperty, CSSHelper } from '@nativescript/core';\n\nimport { NativeScriptAnimationPlayer } from './animation-player';\nimport { Keyframe, dashCaseToCamelCase } from './utils';\nimport { NgView, InvisibleNode } from '../element-registry';\nimport { NativeScriptDebug } from '../trace';\n\ninterface ViewMatchResult {\n\tfound: boolean;\n}\n\ninterface ViewMatchParams {\n\toriginalView: NgView;\n}\n\ninterface QueryParams {\n\tselector: Selector;\n\tmulti: boolean;\n}\n\ninterface QueryResult {\n\tmatches: NgView[];\n}\n\nclass Selector {\n\tprivate nsSelectors: Array<any>;\n\tprivate classSelectors: string[];\n\n\tconstructor(rawSelector: string) {\n\t\tthis.parse(rawSelector);\n\t}\n\n\tmatch(element: NgView): boolean {\n\t\treturn this.nsSelectorMatch(element) || this.classSelectorsMatch(element);\n\t}\n\n\tprivate parse(rawSelector: string) {\n\t\tconst selectors = rawSelector.split(',').map((s) => s.trim());\n\n\t\tthis.nsSelectors = selectors.map(CSSHelper.createSelector);\n\t\tthis.classSelectors = selectors.filter((s) => s.startsWith('.')).map((s) => s.substring(1));\n\t}\n\n\tprivate nsSelectorMatch(element: NgView) {\n\t\treturn this.nsSelectors.some((s) => s.match(element));\n\t}\n\n\tprivate classSelectorsMatch(element: NgView) {\n\t\treturn this.classSelectors.some((s) => this.hasClass(element, s));\n\t}\n\n\t// we're using that instead of match for classes\n\t// that are dynamically added by the animation engine\n\t// such as .ng-trigger, that's added for every :enter view\n\tprivate hasClass(element: NgView, cls: string) {\n\t\treturn element && element['$$classes'] && element['$$classes'][cls];\n\t}\n}\n\nexport class NativeScriptAnimationDriver implements AnimationDriver {\n\tprivate static validProperties = [...CssAnimationProperty._getPropertyNames(), 'transform'];\n\n\tvalidateStyleProperty(property: string): boolean {\n\t\tNativeScriptDebug.animationsLog(`CssAnimationProperty.validateStyleProperty: ${property}`);\n\t\treturn NativeScriptAnimationDriver.validProperties.indexOf(property) !== -1;\n\t}\n\n\tmatchesElement(element: NgView, rawSelector: string): boolean {\n\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationDriver.matchesElement ` + `element: ${element}, selector: ${rawSelector}`);\n\n\t\tconst selector = this.makeSelector(rawSelector);\n\t\treturn selector.match(element);\n\t}\n\n\tcontainsElement(elm1: NgView, elm2: NgView): boolean {\n\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationDriver.containsElement ` + `element1: ${elm1}, element2: ${elm2}`);\n\n\t\t// Checking if the parent is our fake body object\n\t\tif (elm1['isOverride']) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst params: ViewMatchParams = { originalView: elm2 };\n\t\tconst result: ViewMatchResult = this.visitDescendants(elm1, viewMatches, params);\n\n\t\treturn result.found;\n\t}\n\n\tquery(element: NgView, rawSelector: string, multi: boolean): NgView[] {\n\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationDriver.query ` + `element: ${element}, selector: ${rawSelector} ` + `multi: ${multi}`);\n\n\t\tconst selector = this.makeSelector(rawSelector);\n\t\tconst params: QueryParams = { selector, multi };\n\t\tconst result: QueryResult = this.visitDescendants(element, queryDescendants, params);\n\n\t\treturn result.matches || [];\n\t}\n\n\tcomputeStyle(element: NgView, prop: string): string {\n\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationDriver.computeStyle ` + `element: ${element}, prop: ${prop}`);\n\n\t\tconst camelCaseProp = dashCaseToCamelCase(prop);\n\t\treturn element.style[camelCaseProp];\n\t}\n\n\tanimate(element: NgView, keyframes: Keyframe[], duration: number, delay: number, easing: string): AnimationPlayer {\n\t\tNativeScriptDebug.animationsLog(`NativeScriptAnimationDriver.animate ` + `element: ${element}, keyframes: ${keyframes} ` + `duration: ${duration}, delay: ${delay} ` + `easing: ${easing}`);\n\n\t\treturn new NativeScriptAnimationPlayer(element, keyframes, duration, delay, easing);\n\t}\n\n\tprivate makeSelector(rawSelector: string): Selector {\n\t\treturn new Selector(rawSelector);\n\t}\n\n\tprivate visitDescendants(element: NgView, cb: (child: NgView, result: any, params: any) => boolean, cbParams: any): any {\n\t\tconst result = {};\n\t\t// fill the result obj with the result from the callback function\n\t\teachDescendant(element, (child: NgView) => cb(child, result, cbParams));\n\n\t\treturn result;\n\t}\n}\n\nfunction viewMatches(element: NgView, result: ViewMatchResult, params: ViewMatchParams): boolean {\n\tif (element === params.originalView) {\n\t\tresult.found = true;\n\t}\n\n\treturn !result.found;\n}\n\nfunction queryDescendants(element: NgView, result: QueryResult, params: QueryParams): boolean {\n\tif (!result.matches) {\n\t\tresult.matches = [];\n\t}\n\n\tconst { selector, multi } = params;\n\n\t// skip comment and text nodes\n\t// because they are not actual Views\n\t// and cannot be animated\n\tif (element instanceof InvisibleNode || !selector.match(element)) {\n\t\treturn true;\n\t}\n\n\tif (element instanceof ProxyViewContainer) {\n\t\telement.eachChild((child: NgView) => {\n\t\t\tresult.matches.push(child);\n\t\t\treturn true;\n\t\t});\n\t} else {\n\t\tresult.matches.push(element);\n\t}\n\n\treturn multi;\n}\n","import { NgModule, Injectable, Inject, NgZone, RendererFactory2, Optional, SkipSelf } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { AnimationBuilder } from '@angular/animations';\n\nimport { AnimationDriver, ɵAnimationStyleNormalizer as AnimationStyleNormalizer, ɵWebAnimationsStyleNormalizer as WebAnimationsStyleNormalizer, ɵAnimationEngine as AnimationEngine } from '@angular/animations/browser';\n\nimport { ɵAnimationRendererFactory as AnimationRendererFactory, ɵBrowserAnimationBuilder as BrowserAnimationBuilder } from '@angular/platform-browser/animations';\n\n// import { NativeScriptModule } from \"../nativescript.module\";\nimport { NativeScriptRendererFactory } from '../renderer-factory';\nimport { NativeScriptAnimationDriver } from './animation-driver';\nimport { throwIfAlreadyLoaded } from '../common/utils';\nimport { NativeScriptCommonModule } from '../common';\n\n@Injectable()\nexport class InjectableAnimationEngine extends AnimationEngine {\n\tconstructor(@Inject(DOCUMENT) doc: any, driver: AnimationDriver, normalizer: AnimationStyleNormalizer) {\n\t\tsuper(doc.body, driver, normalizer);\n\t}\n}\n\nexport function instantiateSupportedAnimationDriver() {\n\treturn new NativeScriptAnimationDriver();\n}\n\nexport function instantiateRendererFactory(renderer: NativeScriptRendererFactory, engine: AnimationEngine, zone: NgZone) {\n\treturn new AnimationRendererFactory(renderer, engine, zone);\n}\n\nexport function instantiateDefaultStyleNormalizer() {\n\treturn new WebAnimationsStyleNormalizer();\n}\n\n@NgModule({\n\timports: [NativeScriptCommonModule],\n\tproviders: [\n\t\t{\n\t\t\tprovide: AnimationDriver,\n\t\t\tuseFactory: instantiateSupportedAnimationDriver,\n\t\t},\n\t\t{ provide: AnimationBuilder, useClass: BrowserAnimationBuilder },\n\t\t{\n\t\t\tprovide: AnimationStyleNormalizer,\n\t\t\tuseFactory: instantiateDefaultStyleNormalizer,\n\t\t},\n\t\t{ provide: AnimationEngine, useClass: InjectableAnimationEngine },\n\t\t{\n\t\t\tprovide: RendererFactory2,\n\t\t\tuseFactory: instantiateRendererFactory,\n\t\t\tdeps: [NativeScriptRendererFactory, AnimationEngine, NgZone],\n\t\t},\n\t],\n})\nexport class NativeScriptAnimationsModule {\n\tconstructor(@Optional() @SkipSelf() parentModule: NativeScriptAnimationsModule) {\n\t\t// Prevents NativeScriptAnimationsModule from getting imported multiple times\n\t\tthrowIfAlreadyLoaded(parentModule, 'NativeScriptAnimationsModule');\n\t}\n}\n","import { NSFileSystem } from '../file-system/ns-file-system';\n\nimport { Observable, Observer } from 'rxjs';\nimport { path } from '@nativescript/core';\n\nexport type httpResponseFactory<T> = (url: string, body: any, status: number) => T;\nexport type httpErrorFactory = (url: string, body: any, status: number) => any;\n\nexport function isLocalRequest(url: string): boolean {\n\treturn url.indexOf('~') === 0 || url.indexOf('/') === 0;\n}\n\nexport function getAbsolutePath(url: string, nsFileSystem: NSFileSystem): string {\n\turl = url.replace('~', '').replace('/', '');\n\turl = path.join(nsFileSystem.currentApp().path, url);\n\treturn url;\n}\n\nexport function processLocalFileRequest<T>(url: string, nsFileSystem: NSFileSystem, successResponse: httpResponseFactory<T>, errorResponse: httpErrorFactory): Observable<T> {\n\turl = getAbsolutePath(url, nsFileSystem);\n\n\t// request from local app resources\n\treturn new Observable((observer: Observer<T>) => {\n\t\tif (nsFileSystem.fileExists(url)) {\n\t\t\tconst localFile = nsFileSystem.fileFromPath(url);\n\t\t\tlocalFile.readText().then(\n\t\t\t\t(data) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst json = JSON.parse(data);\n\t\t\t\t\t\tobserver.next(successResponse(url, json, 200));\n\t\t\t\t\t\tobserver.complete();\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t// Even though the response status was 2xx, this is still an error.\n\t\t\t\t\t\t// The parse error contains the text of the body that failed to parse.\n\t\t\t\t\t\tconst errorResult = { error, text: data };\n\t\t\t\t\t\tobserver.error(errorResponse(url, errorResult, 200));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t(err: Object) => {\n\t\t\t\t\tobserver.error(errorResponse(url, err, 400));\n\t\t\t\t}\n\t\t\t);\n\t\t} else {\n\t\t\tobserver.error(errorResponse(url, 'Not Found', 404));\n\t\t}\n\t});\n}\n","import { Injectable } from '@angular/core';\nimport { HttpRequest, HttpEvent, XhrFactory, HttpResponse, HttpErrorResponse, HttpXhrBackend } from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\nimport { NSFileSystem } from '../file-system/ns-file-system';\nimport { isLocalRequest, processLocalFileRequest } from './http-utils';\n\n@Injectable()\nexport class NsHttpBackEnd extends HttpXhrBackend {\n\tconstructor(xhrFactory: XhrFactory, private nsFileSystem: NSFileSystem) {\n\t\tsuper(xhrFactory);\n\t}\n\n\thandle(req: HttpRequest<any>): Observable<HttpEvent<any>> {\n\t\tlet result: Observable<HttpEvent<any>>;\n\n\t\tif (isLocalRequest(req.url)) {\n\t\t\tresult = this.handleLocalFileRequest(req.url);\n\t\t} else {\n\t\t\tresult = super.handle(req);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate handleLocalFileRequest(url: string): Observable<HttpEvent<any>> {\n\t\treturn processLocalFileRequest(url, this.nsFileSystem, createSuccessResponse, createErrorResponse);\n\t}\n}\n\nfunction createSuccessResponse(url: string, body: any, status: number): HttpEvent<any> {\n\treturn new HttpResponse({\n\t\turl,\n\t\tbody,\n\t\tstatus,\n\t\tstatusText: 'OK',\n\t});\n}\n\nfunction createErrorResponse(url: string, body: any, status: number): HttpErrorResponse {\n\treturn new HttpErrorResponse({\n\t\turl,\n\t\terror: body,\n\t\tstatus,\n\t\tstatusText: 'ERROR',\n\t});\n}\n","import { NgModule } from '@angular/core';\n\nimport { HttpClientModule, HttpBackend } from '@angular/common/http';\n\nimport { NSFileSystem } from '../file-system/ns-file-system';\nimport { NsHttpBackEnd } from './ns-http-backend';\n\n@NgModule({\n\tproviders: [NSFileSystem, NsHttpBackEnd, { provide: HttpBackend, useExisting: NsHttpBackEnd }],\n\timports: [HttpClientModule],\n\texports: [HttpClientModule],\n})\nexport class NativeScriptHttpClientModule {}\n","import { ControlValueAccessor } from '@angular/forms';\nimport { View, unsetValue } from '@nativescript/core';\n\nimport { isBlank } from '../../lang-facade';\n\nexport class BaseValueAccessor<TView extends View> implements ControlValueAccessor {\n\tprivate pendingChangeNotification: any = 0;\n\tonChange = (_) => {};\n\tonTouched = () => {};\n\n\tconstructor(public view: TView) {}\n\n\tregisterOnChange(fn: (_: any) => void): void {\n\t\tthis.onChange = (arg) => {\n\t\t\tif (this.pendingChangeNotification) {\n\t\t\t\tclearTimeout(this.pendingChangeNotification);\n\t\t\t}\n\t\t\tthis.pendingChangeNotification = setTimeout(() => {\n\t\t\t\tthis.pendingChangeNotification = 0;\n\t\t\t\tfn(arg);\n\t\t\t}, 20);\n\t\t};\n\t}\n\n\tregisterOnTouched(fn: () => void): void {\n\t\tthis.onTouched = fn;\n\t}\n\n\tsetDisabledState(isDisabled: boolean): void {\n\t\tthis.view.isEnabled = !isDisabled;\n\t}\n\n\twriteValue(_: any) {}\n\n\tprotected normalizeValue(value: any): any {\n\t\treturn isBlank(value) ? unsetValue : value;\n\t}\n}\n","import { Directive, ElementRef, forwardRef } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { View } from '@nativescript/core';\nimport { BaseValueAccessor } from './base-value-accessor';\n\nconst TEXT_VALUE_ACCESSOR = {\n\tprovide: NG_VALUE_ACCESSOR,\n\tuseExisting: forwardRef(() => TextValueAccessor),\n\tmulti: true,\n};\n\nexport type TextView = { text: string } & View;\n\n/**\n * The accessor for writing a text and listening to changes that is used by the\n * {@link NgModel} directives.\n *\n *  ### Example\n *  ```\n *  <TextField [(ngModel)]=\"model.test\">\n *  ```\n */\n@Directive({\n\tselector:\n\t\t'TextField[ngModel],TextField[formControlName],TextField[formControl],' +\n\t\t'textField[ngModel],textField[formControlName],textField[formControl],' +\n\t\t'textfield[ngModel],textfield[formControlName],textfield[formControl],' +\n\t\t'text-field[ngModel],text-field[formControlName],text-field[formControl],' +\n\t\t'TextView[ngModel],TextView[formControlName],TextView[formControl],' +\n\t\t'textView[ngModel],textView[formControlName],textView[formControl],' +\n\t\t'textview[ngModel],textview[formControlName],textview[formControl],' +\n\t\t'text-view[ngModel],text-view[formControlName],text-view[formControl],' +\n\t\t'SearchBar[ngModel],SearchBar[formControlName],SearchBar[formControl],' +\n\t\t'searchBar[ngModel],searchBar[formControlName],searchBar[formControl],' +\n\t\t'searchbar[ngModel],searchbar[formControlName],searchbar[formControl],' +\n\t\t'search-bar[ngModel], search-bar[formControlName],search-bar[formControl]',\n\tproviders: [TEXT_VALUE_ACCESSOR],\n\thost: {\n\t\t'(blur)': 'onTouched()',\n\t\t'(textChange)': 'onChange($event.value)',\n\t},\n})\nexport class TextValueAccessor extends BaseValueAccessor<TextView> {\n\t// tslint:disable-line:directive-class-suffix\n\tconstructor(elementRef: ElementRef) {\n\t\tsuper(elementRef.nativeElement);\n\t}\n\n\twriteValue(value: any): void {\n\t\tconst normalized = super.normalizeValue(value);\n\t\tthis.view.text = normalized;\n\t}\n}\n","import { Directive, ElementRef, forwardRef } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { BaseValueAccessor } from './base-value-accessor';\nimport { Switch } from '@nativescript/core';\n\nconst CHECKED_VALUE_ACCESSOR = {\n\tprovide: NG_VALUE_ACCESSOR,\n\tuseExisting: forwardRef(() => CheckedValueAccessor),\n\tmulti: true,\n};\n\n/**\n * The accessor for setting a checked property and listening to changes that is used by the\n * {@link NgModel} directives.\n *\n *  ### Example\n *  ```\n *  <Switch [(ngModel)]=\"model.test\">\n *  ```\n */\n@Directive({\n\tselector: 'Switch[ngModel],Switch[formControlName],Switch[formControl],' + 'switch[ngModel],switch[formControlName],switch[formControl]',\n\tproviders: [CHECKED_VALUE_ACCESSOR],\n\thost: {\n\t\t'(checkedChange)': 'onChange($event.value)',\n\t},\n})\nexport class CheckedValueAccessor extends BaseValueAccessor<Switch> {\n\t// tslint:disable-line:directive-class-suffix\n\tconstructor(elementRef: ElementRef) {\n\t\tsuper(elementRef.nativeElement);\n\t}\n\n\twriteValue(value: any): void {\n\t\tconst normalized = super.normalizeValue(value);\n\t\tthis.view.checked = normalized;\n\t}\n}\n","import { Directive, ElementRef, forwardRef } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { BaseValueAccessor } from './base-value-accessor';\nimport { DatePicker } from '@nativescript/core';\n\nconst DATE_VALUE_ACCESSOR = {\n\tprovide: NG_VALUE_ACCESSOR,\n\tuseExisting: forwardRef(() => DateValueAccessor),\n\tmulti: true,\n};\n\n/**\n * The accessor for setting a date and listening to changes that is used by the\n * {@link NgModel} directives.\n *\n *  ### Example\n *  ```\n *  <DatePicker [(ngModel)]=\"model.test\">\n *  ```\n */\n@Directive({\n\tselector: 'DatePicker[ngModel],DatePicker[formControlName],DatePicker[formControl],' + 'datepicker[ngModel],datepicker[formControlName],datepicker[formControl],' + 'datePicker[ngModel],datePicker[formControlName],datePicker[formControl],' + 'date-picker[ngModel],date-picker[formControlName],date-picker[formControl]',\n\tproviders: [DATE_VALUE_ACCESSOR],\n\thost: {\n\t\t'(dateChange)': 'onChange($event.value)',\n\t},\n})\nexport class DateValueAccessor extends BaseValueAccessor<DatePicker> {\n\t// tslint:disable-line:directive-class-suffix\n\tconstructor(elementRef: ElementRef) {\n\t\tsuper(elementRef.nativeElement);\n\t}\n\n\twriteValue(value: any): void {\n\t\tconst normalized = super.normalizeValue(value);\n\t\tthis.view.date = normalized;\n\t}\n}\n","import { Directive, ElementRef, forwardRef } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { BaseValueAccessor } from './base-value-accessor';\nimport { TimePicker } from '@nativescript/core';\n\nconst TIME_VALUE_ACCESSOR = {\n\tprovide: NG_VALUE_ACCESSOR,\n\tuseExisting: forwardRef(() => TimeValueAccessor),\n\tmulti: true,\n};\n\n/**\n * The accessor for setting a time and listening to changes that is used by the\n * {@link NgModel} directives.\n *\n *  ### Example\n *  ```\n *  <TimePicker [(ngModel)]=\"model.test\">\n *  ```\n */\n@Directive({\n\tselector: 'TimePicker[ngModel],TimePicker[formControlName],TimePicker[formControl],' + 'timepicker[ngModel],timepicker[formControlName],timepicker[formControl],' + 'timePicker[ngModel],timePicker[formControlName],timePicker[formControl],' + 'time-picker[ngModel],time-picker[formControlName],time-picker[formControl]',\n\tproviders: [TIME_VALUE_ACCESSOR],\n\thost: {\n\t\t'(timeChange)': 'onChange($event.value)',\n\t},\n})\nexport class TimeValueAccessor extends BaseValueAccessor<TimePicker> {\n\t// tslint:disable-line:directive-class-suffix\n\tconstructor(elementRef: ElementRef) {\n\t\tsuper(elementRef.nativeElement);\n\t}\n\n\twriteValue(value: any): void {\n\t\tconst normalized = super.normalizeValue(value);\n\t\tthis.view.time = normalized;\n\t}\n}\n","import { Directive, ElementRef, forwardRef } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { BaseValueAccessor } from './base-value-accessor';\nimport { Slider } from '@nativescript/core';\n\nconst NUMBER_VALUE_ACCESSOR = {\n\tprovide: NG_VALUE_ACCESSOR,\n\tuseExisting: forwardRef(() => NumberValueAccessor),\n\tmulti: true,\n};\n\n/**\n * The accessor for setting a value and listening to changes that is used by the\n * {@link NgModel}\n *\n *  ### Example\n *  ```\n *  <Slider [(ngModel)]=\"model.test\">\n *  ```\n */\n@Directive({\n\tselector: 'Slider[ngModel],Slider[formControlName],Slider[formControl],' + 'slider[ngModel],slider[formControlName],slider[formControl]',\n\tproviders: [NUMBER_VALUE_ACCESSOR],\n\thost: {\n\t\t'(valueChange)': 'onChange($event.value)',\n\t},\n})\nexport class NumberValueAccessor extends BaseValueAccessor<Slider> {\n\t// tslint:disable-line:directive-class-suffix\n\tconstructor(elementRef: ElementRef) {\n\t\tsuper(elementRef.nativeElement);\n\t}\n\n\twriteValue(value: any): void {\n\t\tconst normalized = super.normalizeValue(value);\n\t\tthis.view.value = normalized;\n\t}\n}\n","import { Directive, ElementRef, forwardRef, AfterViewInit } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { BaseValueAccessor } from './base-value-accessor';\nimport { View } from '@nativescript/core';\n\nconst SELECTED_INDEX_VALUE_ACCESSOR = {\n\tprovide: NG_VALUE_ACCESSOR,\n\tuseExisting: forwardRef(() => SelectedIndexValueAccessor),\n\tmulti: true,\n};\n\nexport type SelectableView = { selectedIndex: number } & View;\n\n/**\n * The accessor for setting a selectedIndex and listening to changes that is used by the\n * {@link NgModel} directives.\n *\n *  ### Example\n *  ```\n *  <SegmentedBar [(ngModel)]=\"model.test\">\n *  ```\n */\n@Directive({\n\tselector:\n\t\t'SegmentedBar[ngModel],SegmentedBar[formControlName],SegmentedBar[formControl],' +\n\t\t'segmentedBar[ngModel],segmentedBar[formControlName],segmentedBar[formControl],' +\n\t\t'segmentedbar[ngModel],segmentedbar[formControlName],segmentedbar[formControl],' +\n\t\t'segmented-bar[ngModel],segmented-bar[formControlName],segmented-bar[formControl],' +\n\t\t'ListPicker[ngModel],ListPicker[formControlName],ListPicker[formControl],' +\n\t\t'listPicker[ngModel],listPicker[formControlName],listPicker[formControl],' +\n\t\t'listpicker[ngModel],listpicker[formControlName],listpicker[formControl],' +\n\t\t'list-picker[ngModel],list-picker[formControlName],list-picker[formControl],' +\n\t\t'TabView[ngModel],TabView[formControlName],TabView[formControl],' +\n\t\t'tabView[ngModel],tabView[formControlName],tabView[formControl],' +\n\t\t'tabview[ngModel],tabview[formControlName],tabview[formControl],' +\n\t\t'tab-view[ngModel],tab-view[formControlName],tab-view[formControl]',\n\tproviders: [SELECTED_INDEX_VALUE_ACCESSOR],\n\thost: {\n\t\t'(selectedIndexChange)': 'onChange($event.value)',\n\t},\n})\nexport class SelectedIndexValueAccessor extends BaseValueAccessor<SelectableView> implements AfterViewInit {\n\t// tslint:disable-line:max-line-length directive-class-suffix\n\tconstructor(elementRef: ElementRef) {\n\t\tsuper(elementRef.nativeElement);\n\t}\n\n\tprivate value: number;\n\tprivate viewInitialized: boolean;\n\n\twriteValue(value: any): void {\n\t\tconst normalized = super.normalizeValue(value);\n\t\tthis.value = normalized;\n\n\t\tif (this.viewInitialized) {\n\t\t\tthis.view.selectedIndex = this.value;\n\t\t}\n\t}\n\n\tngAfterViewInit() {\n\t\tthis.viewInitialized = true;\n\t\tthis.view.selectedIndex = this.value;\n\t}\n}\n","import { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { TextValueAccessor, CheckedValueAccessor, DateValueAccessor, TimeValueAccessor, NumberValueAccessor, SelectedIndexValueAccessor } from './value-accessors';\n\nexport * from './value-accessors';\n\n@NgModule({\n\tdeclarations: [TextValueAccessor, CheckedValueAccessor, DateValueAccessor, TimeValueAccessor, SelectedIndexValueAccessor, NumberValueAccessor],\n\tproviders: [],\n\timports: [FormsModule],\n\texports: [FormsModule, TextValueAccessor, CheckedValueAccessor, DateValueAccessor, TimeValueAccessor, SelectedIndexValueAccessor, NumberValueAccessor],\n})\nexport class NativeScriptFormsModule {}\n","import { ComponentRef } from '@angular/core';\nimport { ActivatedRoute, ActivatedRouteSnapshot, ChildrenOutletContexts, PRIMARY_OUTLET } from '@angular/router';\n\n/**\n * There are cases where multiple activatedRoute nodes should be associated/handled by the same PageRouterOutlet.\n * We can gat additional ActivatedRoutes nodes when there is:\n *  - Lazy loading - there is an additional ActivatedRoute node for the RouteConfig with the `loadChildren` setup\n *  - Componentless routes - there is an additional ActivatedRoute node for the componentless RouteConfig\n *\n * Example:\n *   R  <-- root\n *   |\n * feature (lazy module) <-- RouteConfig: { path: \"lazy\", loadChildren: \"./feature/feature.module#FeatureModule\" }\n *   |\n * module (componentless route) <-- RouteConfig: { path: \"module\", children: [...] } // Note: No 'component'\n *   |\n *  home <-- RouteConfig: { path: \"module\", component: MyComponent } - this is what we get as activatedRoute param\n *\n *  In these cases we will mark the top-most node (feature). NSRouteReuseStrategy will detach the tree there and\n *  use this ActivateRoute as a kay for caching.\n */\nexport function findTopActivatedRouteNodeForOutlet(activatedRoute: ActivatedRouteSnapshot): ActivatedRouteSnapshot {\n\tlet outletActivatedRoute = activatedRoute;\n\n\twhile (outletActivatedRoute.parent && outletActivatedRoute.parent.routeConfig && !outletActivatedRoute.parent.routeConfig.component) {\n\t\toutletActivatedRoute = outletActivatedRoute.parent;\n\t}\n\n\treturn outletActivatedRoute;\n}\n\nexport const pageRouterActivatedSymbol = Symbol('page-router-activated');\nexport const loaderRefSymbol = Symbol('loader-ref');\n\nexport function destroyComponentRef(componentRef: ComponentRef<any>) {\n\tif (componentRef) {\n\t\tconst loaderRef = componentRef[loaderRefSymbol];\n\t\tif (loaderRef) {\n\t\t\tloaderRef.destroy();\n\t\t}\n\t\tcomponentRef.destroy();\n\t}\n}\n","import { Injectable } from '@angular/core';\nimport { Router, UrlTree, NavigationExtras, ActivatedRoute } from '@angular/router';\nimport { NSLocationStrategy } from './ns-location-strategy';\nimport { NavigationOptions, Outlet } from './ns-location-utils';\nimport { FrameService } from '../frame.service';\nimport { NativeScriptDebug } from '../trace';\nimport { findTopActivatedRouteNodeForOutlet } from './page-router-outlet-utils';\n\nexport type ExtendedNavigationExtras = NavigationExtras & NavigationOptions;\n\nexport interface BackNavigationOptions {\n\toutlets?: Array<string>;\n\trelativeTo?: ActivatedRoute | null;\n}\n\n@Injectable({\n\tprovidedIn: 'root',\n})\nexport class RouterExtensions {\n\tconstructor(public router: Router, public locationStrategy: NSLocationStrategy, public frameService: FrameService) {}\n\n\tpublic navigate(commands: any[], extras?: ExtendedNavigationExtras): Promise<boolean> {\n\t\tif (extras) {\n\t\t\tthis.locationStrategy._setNavigationOptions(extras);\n\t\t}\n\t\treturn this.router.navigate(commands, extras);\n\t}\n\n\tpublic navigateByUrl(url: string | UrlTree, options?: NavigationOptions): Promise<boolean> {\n\t\tif (options) {\n\t\t\tthis.locationStrategy._setNavigationOptions(options);\n\t\t}\n\t\treturn this.router.navigateByUrl(url);\n\t}\n\n\tpublic back(backNavigationOptions?: BackNavigationOptions) {\n\t\tif (backNavigationOptions) {\n\t\t\tthis.backOutlets(backNavigationOptions);\n\t\t} else {\n\t\t\tthis.locationStrategy.back();\n\t\t}\n\t}\n\n\tpublic canGoBack(backNavigationOptions?: BackNavigationOptions) {\n\t\tlet canGoBack = true;\n\t\tif (backNavigationOptions) {\n\t\t\tconst { outletsToBack, outlets } = this.findOutletsToBack(backNavigationOptions);\n\n\t\t\tif (outletsToBack.length !== outlets.length) {\n\t\t\t\tNativeScriptDebug.routerError('No outlet found relative to activated route');\n\t\t\t} else {\n\t\t\t\toutletsToBack.forEach((outletToBack) => {\n\t\t\t\t\tif (!this.locationStrategy.canGoBack(outletToBack)) {\n\t\t\t\t\t\tcanGoBack = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tcanGoBack = this.locationStrategy.canGoBack();\n\t\t}\n\n\t\treturn canGoBack;\n\t}\n\n\tpublic backToPreviousPage() {\n\t\tthis.frameService.getFrame().goBack();\n\t}\n\n\tpublic canGoBackToPreviousPage(): boolean {\n\t\treturn this.frameService.getFrame().canGoBack();\n\t}\n\n\tprivate backOutlets(options: BackNavigationOptions) {\n\t\tconst { outletsToBack, outlets } = this.findOutletsToBack(options);\n\n\t\tif (outletsToBack.length !== outlets.length) {\n\t\t\tNativeScriptDebug.routerError('No outlet found relative to activated route');\n\t\t} else {\n\t\t\toutletsToBack.forEach((outletToBack) => {\n\t\t\t\tif (outletToBack.isPageNavigationBack) {\n\t\t\t\t\tNativeScriptDebug.routerError('Attempted to call startGoBack while going back:');\n\t\t\t\t} else {\n\t\t\t\t\tthis.locationStrategy.back(outletToBack);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t// tslint:disable-next-line:max-line-length\n\tprivate findOutletsToBack(options?: BackNavigationOptions): { outletsToBack: Array<Outlet>; outlets: Array<string> } {\n\t\tconst outletsToBack: Array<Outlet> = [];\n\t\tconst rootRoute: ActivatedRoute = this.router.routerState.root;\n\t\tlet outlets = options.outlets;\n\t\tlet relativeRoute = options.relativeTo || rootRoute;\n\n\t\tconst relativeRouteOutlet = this.findOutletByRoute(relativeRoute);\n\t\tconst isNSEmptyOutlet = relativeRouteOutlet && relativeRouteOutlet.isNSEmptyOutlet;\n\n\t\t// Lazy named outlet has added 'primary' inner NSEmptyOutlet child.\n\t\t// Take parent route when `relativeTo` option points to the outer named outlet.\n\t\tif (isNSEmptyOutlet && relativeRoute.outlet !== 'primary') {\n\t\t\trelativeRoute = relativeRoute.parent || relativeRoute;\n\t\t}\n\n\t\tconst routesToMatch = outlets ? relativeRoute.children : [relativeRoute];\n\t\toutlets = outlets || [relativeRoute.outlet];\n\n\t\tfor (let index = 0; index < routesToMatch.length; index++) {\n\t\t\tconst currentRoute = routesToMatch[index];\n\t\t\tif (outlets.some((currentOutlet) => currentOutlet === currentRoute.outlet)) {\n\t\t\t\tconst outlet = this.findOutletByRoute(currentRoute);\n\n\t\t\t\tif (outlet) {\n\t\t\t\t\toutletsToBack.push(outlet);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn { outletsToBack: outletsToBack, outlets: outlets };\n\t}\n\n\tprivate findOutletByRoute(currentRoute: ActivatedRoute): Outlet {\n\t\tlet outlet;\n\n\t\tconst currentRouteSnapshop = findTopActivatedRouteNodeForOutlet(currentRoute.snapshot);\n\t\tconst outletKey = this.locationStrategy.getRouteFullPath(currentRouteSnapshop);\n\t\toutlet = this.locationStrategy.findOutlet(outletKey, currentRouteSnapshop);\n\n\t\treturn outlet;\n\t}\n}\n","import { Directive, HostListener, Input } from '@angular/core';\nimport { NavigationExtras } from '@angular/router';\nimport { ActivatedRoute, Router, UrlTree } from '@angular/router';\nimport { NavigationTransition } from '@nativescript/core';\nimport { NativeScriptDebug } from '../trace';\nimport { RouterExtensions } from './router-extensions';\nimport { NavigationOptions } from './ns-location-utils';\n\n// Copied from \"@angular/router/src/config\"\nexport type QueryParamsHandling = 'merge' | 'preserve' | '';\n\n/**\n * The nsRouterLink directive lets you link to specific parts of your app.\n *\n * Consider the following route configuration:\n * ```\n * [{ path: \"/user\", component: UserCmp }]\n * ```\n *\n * When linking to this `User` route, you can write:\n *\n * ```\n * <a [nsRouterLink]=\"[\"/user\"]\">link to user component</a>\n * ```\n *\n * NSRouterLink expects the value to be an array of path segments, followed by the params\n * for that level of routing. For instance `[\"/team\", {teamId: 1}, \"user\", {userId: 2}]`\n * means that we want to generate a link to `/team;teamId=1/user;userId=2`.\n *\n * The first segment name can be prepended with `/`, `./`, or `../`.\n * If the segment begins with `/`, the router will look up the route from the root of the app.\n * If the segment begins with `./`, or doesn\"t begin with a slash, the router will\n * instead look in the current component\"s children for the route.\n * And if the segment begins with `../`, the router will go up one level.\n */\n@Directive({ selector: '[nsRouterLink]' })\nexport class NSRouterLink {\n\t// tslint:disable-line:directive-class-suffix\n\t@Input() target: string;\n\t@Input() queryParams: { [k: string]: any };\n\t@Input() fragment: string;\n\n\t@Input() queryParamsHandling: QueryParamsHandling;\n\t@Input() preserveQueryParams: boolean;\n\t@Input() preserveFragment: boolean;\n\t@Input() skipLocationChange: boolean;\n\t@Input() replaceUrl: boolean;\n\n\t@Input() clearHistory: boolean;\n\t@Input() pageTransition: boolean | string | NavigationTransition = true;\n\t@Input() pageTransitionDuration;\n\n\tprivate commands: any[] = [];\n\n\tconstructor(private router: Router, private navigator: RouterExtensions, private route: ActivatedRoute) {}\n\n\t@Input('nsRouterLink')\n\tset params(data: any[] | string) {\n\t\tif (Array.isArray(data)) {\n\t\t\tthis.commands = data;\n\t\t} else {\n\t\t\tthis.commands = [data];\n\t\t}\n\t}\n\n\t@HostListener('tap')\n\tonTap() {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog(`nsRouterLink.tapped: ${this.commands} ` + `clear: ${this.clearHistory} ` + `transition: ${JSON.stringify(this.pageTransition)} ` + `duration: ${this.pageTransitionDuration}`);\n\t\t}\n\n\t\tconst extras = this.getExtras();\n\t\tthis.navigator.navigateByUrl(this.urlTree, extras);\n\t}\n\n\tprivate getExtras(): NavigationExtras & NavigationOptions {\n\t\tconst transition = this.getTransition();\n\t\treturn {\n\t\t\tskipLocationChange: attrBoolValue(this.skipLocationChange),\n\t\t\treplaceUrl: attrBoolValue(this.replaceUrl),\n\n\t\t\tclearHistory: this.convertClearHistory(this.clearHistory),\n\t\t\tanimated: transition.animated,\n\t\t\ttransition: transition.transition,\n\t\t};\n\t}\n\n\tget urlTree(): UrlTree {\n\t\tconst urlTree = this.router.createUrlTree(this.commands, {\n\t\t\trelativeTo: this.route,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tfragment: this.fragment,\n\t\t\tpreserveQueryParams: attrBoolValue(this.preserveQueryParams),\n\t\t\tqueryParamsHandling: this.queryParamsHandling,\n\t\t\tpreserveFragment: attrBoolValue(this.preserveFragment),\n\t\t});\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog(`nsRouterLink urlTree created: ${urlTree}`);\n\t\t}\n\n\t\treturn urlTree;\n\t}\n\n\tprivate convertClearHistory(value: boolean | string): boolean {\n\t\treturn value === true || value === 'true';\n\t}\n\n\tprivate getTransition(): { animated: boolean; transition?: NavigationTransition } {\n\t\tlet transition: NavigationTransition;\n\t\tlet animated: boolean;\n\n\t\tif (typeof this.pageTransition === 'boolean') {\n\t\t\tanimated = this.pageTransition;\n\t\t} else if (typeof this.pageTransition === 'string') {\n\t\t\tif (this.pageTransition === 'none' || this.pageTransition === 'false') {\n\t\t\t\tanimated = false;\n\t\t\t} else {\n\t\t\t\tanimated = true;\n\t\t\t\ttransition = {\n\t\t\t\t\tname: <string>this.pageTransition,\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\tanimated = true;\n\t\t\ttransition = <NavigationTransition>this.pageTransition;\n\t\t}\n\n\t\tlet duration = +this.pageTransitionDuration;\n\t\tif (!isNaN(duration)) {\n\t\t\ttransition = transition || {};\n\t\t\ttransition.duration = duration;\n\t\t}\n\n\t\treturn { animated, transition };\n\t}\n}\n\nfunction attrBoolValue(s: any): boolean {\n\treturn s === '' || !!s;\n}\n","/* tslint:disable:forin */\n// Copied unexported functions from @angular/router/src/url_tree\nimport { UrlTree, UrlSegment, PRIMARY_OUTLET } from '@angular/router';\n// UrlSegmentGroup not exported, just use any.\ntype UrlSegmentGroup = any;\n\nexport function containsTree(container: UrlTree, containee: UrlTree, exact: boolean): boolean {\n\tif (exact) {\n\t\treturn equalSegmentGroups(container.root, containee.root);\n\t} else {\n\t\treturn containsSegmentGroup(container.root, containee.root);\n\t}\n}\n\nfunction equalSegmentGroups(container: UrlSegmentGroup, containee: UrlSegmentGroup): boolean {\n\tif (!equalPath(container.segments, containee.segments)) {\n\t\treturn false;\n\t}\n\tif (container.numberOfChildren !== containee.numberOfChildren) {\n\t\treturn false;\n\t}\n\tfor (let c in containee.children) {\n\t\tif (!container.children[c]) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!equalSegmentGroups(container.children[c], containee.children[c])) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nfunction containsSegmentGroup(container: UrlSegmentGroup, containee: UrlSegmentGroup): boolean {\n\treturn containsSegmentGroupHelper(container, containee, containee.segments);\n}\n\nfunction containsSegmentGroupHelper(container: UrlSegmentGroup, containee: UrlSegmentGroup, containeePaths: UrlSegment[]): boolean {\n\tif (container.segments.length > containeePaths.length) {\n\t\tconst current = container.segments.slice(0, containeePaths.length);\n\t\tif (!equalPath(current, containeePaths)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (containee.hasChildren()) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t} else if (container.segments.length === containeePaths.length) {\n\t\tif (!equalPath(container.segments, containeePaths)) {\n\t\t\treturn false;\n\t\t}\n\t\tfor (let c in containee.children) {\n\t\t\tif (!container.children[c]) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!containsSegmentGroup(container.children[c], containee.children[c])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t} else {\n\t\tconst current = containeePaths.slice(0, container.segments.length);\n\t\tconst next = containeePaths.slice(container.segments.length);\n\t\tif (!equalPath(container.segments, current)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!container.children[PRIMARY_OUTLET]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn containsSegmentGroupHelper(container.children[PRIMARY_OUTLET], containee, next);\n\t}\n}\n\nexport function equalPath(a: UrlSegment[], b: UrlSegment[]): boolean {\n\tif (a.length !== b.length) {\n\t\treturn false;\n\t}\n\tfor (let i = 0; i < a.length; ++i) {\n\t\tif (a[i].path !== b[i].path) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n","import { AfterContentInit, ContentChildren, Directive, ElementRef, Input, OnChanges, OnDestroy, QueryList, Renderer2 } from '@angular/core';\nimport { Subscription } from 'rxjs';\n\nimport { NavigationEnd, Router, UrlTree } from '@angular/router';\nimport { containsTree } from './private-imports/router-url-tree';\n\nimport { NSRouterLink } from './ns-router-link';\n\n/**\n * The NSRouterLinkActive directive lets you add a CSS class to an element when the link\"s route\n * becomes active.\n *\n * Consider the following example:\n *\n * ```\n * <a [nsRouterLink]=\"/user/bob\" [nsRouterLinkActive]=\"active-link\">Bob</a>\n * ```\n *\n * When the url is either \"/user\" or \"/user/bob\", the active-link class will\n * be added to the component. If the url changes, the class will be removed.\n *\n * You can set more than one class, as follows:\n *\n * ```\n * <a [nsRouterLink]=\"/user/bob\" [nsRouterLinkActive]=\"class1 class2\">Bob</a>\n * <a [nsRouterLink]=\"/user/bob\" [nsRouterLinkActive]=\"[\"class1\", \"class2\"]\">Bob</a>\n * ```\n *\n * You can configure NSRouterLinkActive by passing `exact: true`. This will add the\n * classes only when the url matches the link exactly.\n *\n * ```\n * <a [nsRouterLink]=\"/user/bob\" [nsRouterLinkActive]=\"active-link\"\n * [nsRouterLinkActiveOptions]=\"{exact: true}\">Bob</a>\n * ```\n *\n * Finally, you can apply the NSRouterLinkActive directive to an ancestor of a RouterLink.\n *\n * ```\n * <div [nsRouterLinkActive]=\"active-link\" [nsRouterLinkActiveOptions]=\"{exact: true}\">\n *   <a [nsRouterLink]=\"/user/jim\">Jim</a>\n *   <a [nsRouterLink]=\"/user/bob\">Bob</a>\n * </div>\n * ```\n *\n * This will set the active-link class on the div tag if the url is either \"/user/jim\" or\n * \"/user/bob\".\n *\n * @stable\n */\n@Directive({\n\tselector: '[nsRouterLinkActive]',\n\texportAs: 'routerLinkActive',\n})\nexport class NSRouterLinkActive implements OnChanges, OnDestroy, AfterContentInit {\n\t// tslint:disable-line:max-line-length directive-class-suffix\n\t@ContentChildren(NSRouterLink) links: QueryList<NSRouterLink>;\n\n\tprivate classes: string[] = [];\n\tprivate subscription: Subscription;\n\tprivate active: boolean = false;\n\n\t@Input() nsRouterLinkActiveOptions: { exact: boolean } = { exact: false };\n\n\tconstructor(private router: Router, private element: ElementRef, private renderer: Renderer2) {\n\t\tthis.subscription = router.events.subscribe((s) => {\n\t\t\tif (s instanceof NavigationEnd) {\n\t\t\t\tthis.update();\n\t\t\t}\n\t\t});\n\t}\n\n\tget isActive(): boolean {\n\t\treturn this.active;\n\t}\n\n\tngAfterContentInit(): void {\n\t\tthis.links.changes.subscribe(() => this.update());\n\t\tthis.update();\n\t}\n\n\t@Input('nsRouterLinkActive')\n\tset nsRouterLinkActive(data: string[] | string) {\n\t\tif (Array.isArray(data)) {\n\t\t\tthis.classes = <any>data;\n\t\t} else {\n\t\t\tthis.classes = data.split(' ');\n\t\t}\n\t}\n\n\tngOnChanges(_: {}): any {\n\t\tthis.update();\n\t}\n\tngOnDestroy(): any {\n\t\tthis.subscription.unsubscribe();\n\t}\n\n\tprivate update(): void {\n\t\tif (!this.links) {\n\t\t\treturn;\n\t\t}\n\t\tconst hasActiveLinks = this.hasActiveLinks();\n\t\t// react only when status has changed to prevent unnecessary dom updates\n\t\tif (this.active !== hasActiveLinks) {\n\t\t\tconst currentUrlTree = this.router.parseUrl(this.router.url);\n\t\t\tconst isActiveLinks = this.reduceList(currentUrlTree, this.links);\n\t\t\tthis.classes.forEach((c) => this.renderer.setStyle(this.element.nativeElement, c, isActiveLinks));\n\t\t}\n\t\tPromise.resolve(hasActiveLinks).then((active) => (this.active = active));\n\t}\n\n\tprivate reduceList(currentUrlTree: UrlTree, q: QueryList<any>): boolean {\n\t\treturn q.reduce((res: boolean, link: NSRouterLink) => {\n\t\t\treturn res || containsTree(currentUrlTree, link.urlTree, this.nsRouterLinkActiveOptions.exact);\n\t\t}, false);\n\t}\n\n\tprivate isLinkActive(router: Router): (link: NSRouterLink) => boolean {\n\t\treturn (link: NSRouterLink) => router.isActive(link.urlTree, this.nsRouterLinkActiveOptions.exact);\n\t}\n\n\tprivate hasActiveLinks(): boolean {\n\t\treturn this.links.some(this.isLinkActive(this.router));\n\t}\n}\n","import { Injectable } from '@angular/core';\nimport { RouteReuseStrategy, ActivatedRouteSnapshot, DetachedRouteHandle } from '@angular/router';\n\nimport { NativeScriptDebug } from '../trace';\nimport { NSLocationStrategy } from './ns-location-strategy';\nimport { destroyComponentRef, findTopActivatedRouteNodeForOutlet, pageRouterActivatedSymbol } from './page-router-outlet-utils';\n\ninterface CacheItem {\n\tkey: string;\n\tstate: DetachedRouteHandle;\n\tisModal: boolean;\n}\n\nconst getSnapshotKey = function (snapshot: ActivatedRouteSnapshot): string {\n\treturn snapshot.pathFromRoot.join('->');\n};\n\n/**\n * Detached state cache\n */\nclass DetachedStateCache {\n\tprivate cache = new Array<CacheItem>();\n\n\tpublic get length(): number {\n\t\treturn this.cache.length;\n\t}\n\n\tpublic push(cacheItem: CacheItem) {\n\t\tthis.cache.push(cacheItem);\n\t}\n\n\tpublic pop(): CacheItem {\n\t\treturn this.cache.pop();\n\t}\n\n\tpublic peek(): CacheItem {\n\t\treturn this.cache[this.cache.length - 1];\n\t}\n\n\tpublic clear() {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routeReuseStrategyLog(`DetachedStateCache.clear() ${this.cache.length} items will be destroyed`);\n\t\t}\n\n\t\twhile (this.cache.length > 0) {\n\t\t\tconst state = <any>this.cache.pop().state;\n\t\t\tif (!state.componentRef) {\n\t\t\t\tthrow new Error('No componentRed found in DetachedRouteHandle');\n\t\t\t}\n\n\t\t\tdestroyComponentRef(state.componentRef);\n\t\t}\n\t}\n\n\tpublic clearModalCache() {\n\t\tlet removedItemsCount = 0;\n\t\tconst hasModalPages = this.cache.some((cacheItem) => {\n\t\t\treturn cacheItem.isModal;\n\t\t});\n\n\t\tif (hasModalPages) {\n\t\t\tlet modalCacheCleared = false;\n\n\t\t\twhile (!modalCacheCleared) {\n\t\t\t\tlet cacheItem = this.peek();\n\t\t\t\tconst state = <any>cacheItem.state;\n\n\t\t\t\tif (!state.componentRef) {\n\t\t\t\t\tthrow new Error('No componentRef found in DetachedRouteHandle');\n\t\t\t\t}\n\n\t\t\t\tdestroyComponentRef(state.componentRef);\n\t\t\t\tif (cacheItem.isModal) {\n\t\t\t\t\tmodalCacheCleared = true;\n\t\t\t\t}\n\n\t\t\t\tthis.pop();\n\t\t\t\tremovedItemsCount++;\n\t\t\t}\n\t\t}\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routeReuseStrategyLog(`DetachedStateCache.clearModalCache() ${removedItemsCount} items will be destroyed`);\n\t\t}\n\t}\n}\n\n/**\n * Detaches subtrees loaded inside PageRouterOutlet in forward navigation\n * and reattaches them on back.\n * Reuses routes as long as their route config is the same.\n */\n@Injectable()\nexport class NSRouteReuseStrategy implements RouteReuseStrategy {\n\tprivate cacheByOutlet: { [key: string]: DetachedStateCache } = {};\n\n\tconstructor(private location: NSLocationStrategy) {}\n\n\tshouldDetach(route: ActivatedRouteSnapshot): boolean {\n\t\troute = findTopActivatedRouteNodeForOutlet(route);\n\n\t\tconst outletKey = this.location.getRouteFullPath(route);\n\t\tconst outlet = this.location.findOutlet(outletKey, route);\n\t\tconst key = getSnapshotKey(route);\n\t\tconst isPageActivated = route[pageRouterActivatedSymbol];\n\t\tconst isBack = outlet ? outlet.isPageNavigationBack : false;\n\t\tlet shouldDetach = outlet && !isBack && isPageActivated;\n\n\t\tif (outlet) {\n\t\t\tif (outlet.parent && !outlet.parent.shouldDetach) {\n\t\t\t\tshouldDetach = false;\n\t\t\t}\n\n\t\t\toutlet.shouldDetach = shouldDetach;\n\t\t}\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routeReuseStrategyLog(`shouldDetach isBack: ${isBack} key: ${key} result: ${shouldDetach}`);\n\t\t}\n\n\t\treturn shouldDetach;\n\t}\n\n\tshouldAttach(route: ActivatedRouteSnapshot): boolean {\n\t\troute = findTopActivatedRouteNodeForOutlet(route);\n\n\t\tconst outletKey = this.location.getRouteFullPath(route);\n\t\tconst outlet = this.location.findOutlet(outletKey, route);\n\t\tconst cache = this.cacheByOutlet[outletKey];\n\t\tif (!cache) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst key = getSnapshotKey(route);\n\t\tconst isBack = outlet ? outlet.isPageNavigationBack : false;\n\t\tconst shouldAttach = isBack && cache.peek().key === key;\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routeReuseStrategyLog(`shouldAttach isBack: ${isBack} key: ${key} result: ${shouldAttach}`);\n\t\t}\n\n\t\tif (outlet) {\n\t\t\toutlet.shouldDetach = true;\n\t\t}\n\n\t\treturn shouldAttach;\n\t}\n\n\tstore(route: ActivatedRouteSnapshot, state: DetachedRouteHandle): void {\n\t\troute = findTopActivatedRouteNodeForOutlet(route);\n\n\t\tconst key = getSnapshotKey(route);\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routeReuseStrategyLog(`store key: ${key}, state: ${state}`);\n\t\t}\n\n\t\tconst outletKey = this.location.getRouteFullPath(route);\n\n\t\t// tslint:disable-next-line:max-line-length\n\t\tconst cache = (this.cacheByOutlet[outletKey] = this.cacheByOutlet[outletKey] || new DetachedStateCache());\n\n\t\tif (state) {\n\t\t\tlet isModal = false;\n\t\t\tif (this.location._modalNavigationDepth > 0) {\n\t\t\t\tisModal = true;\n\t\t\t}\n\n\t\t\tcache.push({ key, state, isModal });\n\t\t} else {\n\t\t\tconst topItem = cache.peek();\n\t\t\tif (topItem.key === key) {\n\t\t\t\tcache.pop();\n\n\t\t\t\tif (!cache.length) {\n\t\t\t\t\tdelete this.cacheByOutlet[outletKey];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Trying to pop from DetachedStateCache but keys don't match. \" + `expected: ${topItem.key} actual: ${key}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tretrieve(route: ActivatedRouteSnapshot): DetachedRouteHandle | null {\n\t\troute = findTopActivatedRouteNodeForOutlet(route);\n\n\t\tconst outletKey = this.location.getRouteFullPath(route);\n\t\tconst outlet = this.location.findOutlet(outletKey, route);\n\t\tconst cache = this.cacheByOutlet[outletKey];\n\t\tif (!cache) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst key = getSnapshotKey(route);\n\t\tconst isBack = outlet ? outlet.isPageNavigationBack : false;\n\t\tconst cachedItem = cache.peek();\n\n\t\tlet state = null;\n\t\tif (isBack && cachedItem && cachedItem.key === key) {\n\t\t\tstate = cachedItem.state;\n\t\t}\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routeReuseStrategyLog(`retrieved isBack: ${isBack} key: ${key} state: ${state}`);\n\t\t}\n\n\t\treturn state;\n\t}\n\n\tshouldReuseRoute(future: ActivatedRouteSnapshot, curr: ActivatedRouteSnapshot): boolean {\n\t\tconst shouldReuse = future.routeConfig === curr.routeConfig;\n\n\t\tif (shouldReuse && curr && curr[pageRouterActivatedSymbol]) {\n\t\t\t// When reusing route - copy the pageRouterActivated to the new snapshot\n\t\t\t// It's needed in shouldDetach to determine if the route should be detached.\n\t\t\tfuture[pageRouterActivatedSymbol] = curr[pageRouterActivatedSymbol];\n\t\t}\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routeReuseStrategyLog(`shouldReuseRoute result: ${shouldReuse}`);\n\t\t}\n\n\t\treturn shouldReuse;\n\t}\n\n\tclearCache(outletKey: string) {\n\t\tconst cache = this.cacheByOutlet[outletKey];\n\n\t\tif (cache) {\n\t\t\tcache.clear();\n\t\t}\n\t}\n\n\tclearModalCache(outletKey: string) {\n\t\tconst cache = this.cacheByOutlet[outletKey];\n\n\t\tif (cache) {\n\t\t\tcache.clearModalCache();\n\t\t}\n\t}\n}\n","import { Attribute, ChangeDetectorRef, ComponentFactory, ComponentFactoryResolver, ComponentRef, Directive, Inject, InjectionToken, Injector, OnDestroy, EventEmitter, Output, Type, ViewContainerRef, ElementRef, InjectFlags, NgZone } from '@angular/core';\nimport { ActivatedRoute, ActivatedRouteSnapshot, ChildrenOutletContexts, PRIMARY_OUTLET } from '@angular/router';\n\nimport { Frame, Page, NavigatedData, profile, Device } from '@nativescript/core';\n\nimport { BehaviorSubject } from 'rxjs';\n\nimport { PAGE_FACTORY, PageFactory } from '../platform-providers';\nimport { NativeScriptDebug } from '../trace';\nimport { DetachedLoader } from '../common/detached-loader';\nimport { ViewUtil } from '../view-util';\nimport { NSLocationStrategy } from './ns-location-strategy';\nimport { Outlet } from './ns-location-utils';\nimport { NSRouteReuseStrategy } from './ns-route-reuse-strategy';\nimport { findTopActivatedRouteNodeForOutlet, pageRouterActivatedSymbol, loaderRefSymbol, destroyComponentRef } from './page-router-outlet-utils';\n\nexport class PageRoute {\n\tactivatedRoute: BehaviorSubject<ActivatedRoute>;\n\n\tconstructor(startRoute: ActivatedRoute) {\n\t\tthis.activatedRoute = new BehaviorSubject(startRoute);\n\t}\n}\n\nexport class DestructibleInjector implements Injector {\n\tprivate refs = new Set<any>();\n\tconstructor(private destructableProviders: ProviderSet, private parent: Injector) {}\n\tget<T>(token: Type<T> | InjectionToken<T>, notFoundValue?: T, flags?: InjectFlags): T {\n\t\tconst ref = this.parent.get(token, notFoundValue, flags);\n\t\tif (this.destructableProviders.has(token)) {\n\t\t\tthis.refs.add(ref);\n\t\t}\n\t\treturn ref;\n\t}\n\tdestroy() {\n\t\tthis.refs.forEach((ref) => {\n\t\t\tif (ref.ngOnDestroy instanceof Function) {\n\t\t\t\tref.ngOnDestroy();\n\t\t\t}\n\t\t});\n\t\tthis.refs.clear();\n\t}\n}\n\ntype ProviderSet = Set<Type<any> | InjectionToken<any>>;\n\nconst routeToString = function (activatedRoute: ActivatedRoute | ActivatedRouteSnapshot): string {\n\treturn activatedRoute.pathFromRoot.join('->');\n};\n\n@Directive({ selector: 'page-router-outlet' }) // tslint:disable-line:directive-selector\nexport class PageRouterOutlet implements OnDestroy {\n\t// tslint:disable-line:directive-class-suffix\n\tprivate activated: ComponentRef<any> | null = null;\n\tprivate _activatedRoute: ActivatedRoute | null = null;\n\tprivate detachedLoaderFactory: ComponentFactory<DetachedLoader>;\n\n\tprivate outlet: Outlet;\n\tprivate name: string;\n\tprivate isEmptyOutlet: boolean;\n\tprivate viewUtil: ViewUtil;\n\tprivate frame: Frame;\n\n\t@Output('activate') activateEvents = new EventEmitter<any>(); // tslint:disable-line:no-output-rename\n\t@Output('deactivate') deactivateEvents = new EventEmitter<any>(); // tslint:disable-line:no-output-rename\n\n\t/** @deprecated from Angular since v4 */\n\tget locationInjector(): Injector {\n\t\treturn this.location.injector;\n\t}\n\t/** @deprecated from Angular since v4 */\n\tget locationFactoryResolver(): ComponentFactoryResolver {\n\t\treturn this.resolver;\n\t}\n\n\tget isActivated(): boolean {\n\t\treturn !!this.activated;\n\t}\n\n\tget component(): Object {\n\t\tif (!this.activated) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerLog('Outlet is not activated');\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.activated.instance;\n\t}\n\tget activatedRoute(): ActivatedRoute {\n\t\tif (!this.activated) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerLog('Outlet is not activated');\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\treturn this._activatedRoute;\n\t}\n\n\tconstructor(private parentContexts: ChildrenOutletContexts, private location: ViewContainerRef, @Attribute('name') name: string, @Attribute('actionBarVisibility') actionBarVisibility: string, @Attribute('isEmptyOutlet') isEmptyOutlet: boolean, private locationStrategy: NSLocationStrategy, private componentFactoryResolver: ComponentFactoryResolver, private resolver: ComponentFactoryResolver, private changeDetector: ChangeDetectorRef, @Inject(PAGE_FACTORY) private pageFactory: PageFactory, private routeReuseStrategy: NSRouteReuseStrategy, private ngZone: NgZone, elRef: ElementRef) {\n\t\tthis.isEmptyOutlet = isEmptyOutlet;\n\t\tthis.frame = elRef.nativeElement;\n\t\tthis.setActionBarVisibility(actionBarVisibility);\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog(`PageRouterOutlet.constructor frame: ${this.frame}`);\n\t\t}\n\n\t\tthis.name = name || PRIMARY_OUTLET;\n\t\tparentContexts.onChildOutletCreated(this.name, <any>this);\n\n\t\tthis.viewUtil = new ViewUtil(Device);\n\t\tthis.detachedLoaderFactory = resolver.resolveComponentFactory(DetachedLoader);\n\t}\n\n\tsetActionBarVisibility(actionBarVisibility: string): void {\n\t\tswitch (actionBarVisibility) {\n\t\t\tcase 'always':\n\t\t\tcase 'never':\n\t\t\t\tthis.frame.actionBarVisibility = actionBarVisibility;\n\t\t\t\treturn;\n\n\t\t\tdefault:\n\t\t\t\tthis.frame.actionBarVisibility = 'auto';\n\t\t}\n\t}\n\n\tngOnDestroy(): void {\n\t\t// Clear accumulated modal view page cache when page-router-outlet\n\t\t// destroyed on modal view closing\n\t\tthis.parentContexts.onChildOutletDestroyed(this.name);\n\n\t\tif (this.outlet) {\n\t\t\tthis.outlet.outletKeys.forEach((key) => {\n\t\t\t\tthis.routeReuseStrategy.clearModalCache(key);\n\t\t\t});\n\t\t\tthis.locationStrategy.clearOutlet(this.frame);\n\t\t} else {\n\t\t\tNativeScriptDebug.routerLog('PageRouterOutlet.ngOnDestroy: no outlet available for page-router-outlet');\n\t\t}\n\n\t\tif (this.isActivated) {\n\t\t\tconst c = this.activated.instance;\n\t\t\tthis.activated.hostView.detach();\n\t\t\tdestroyComponentRef(this.activated);\n\n\t\t\tthis.deactivateEvents.emit(c);\n\t\t\tthis.activated = null;\n\t\t}\n\t}\n\n\tdeactivate(): void {\n\t\tif (!this.outlet || !this.outlet.isPageNavigationBack) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerLog('Currently not in page back navigation - component should be detached instead of deactivated.');\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('PageRouterOutlet.deactivate() while going back - should destroy');\n\t\t}\n\n\t\tif (!this.isActivated) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst c = this.activated.instance;\n\t\tdestroyComponentRef(this.activated);\n\n\t\tthis.activated = null;\n\t\tthis._activatedRoute = null;\n\n\t\tthis.deactivateEvents.emit(c);\n\t}\n\n\t/**\n\t * Called when the `RouteReuseStrategy` instructs to detach the subtree\n\t */\n\tdetach(): ComponentRef<any> {\n\t\tif (!this.isActivated) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerLog('Outlet is not activated');\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog(`PageRouterOutlet.detach() - ${routeToString(this._activatedRoute)}`);\n\t\t}\n\n\t\t// Detach from ChangeDetection\n\t\tthis.activated.hostView.detach();\n\n\t\tconst component = this.activated;\n\t\tthis.activated = null;\n\t\tthis._activatedRoute = null;\n\t\treturn component;\n\t}\n\n\t/**\n\t * Called when the `RouteReuseStrategy` instructs to re-attach a previously detached subtree\n\t */\n\tattach(ref: ComponentRef<any>, activatedRoute: ActivatedRoute) {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog(`PageRouterOutlet.attach() - ${routeToString(activatedRoute)}`);\n\t\t}\n\n\t\tthis.activated = ref;\n\n\t\t// reattach to ChangeDetection\n\t\tthis.activated.hostView.markForCheck();\n\t\tthis.activated.hostView.reattach();\n\t\tthis._activatedRoute = activatedRoute;\n\t\tthis.markActivatedRoute(activatedRoute);\n\n\t\tthis.locationStrategy._finishBackPageNavigation(this.frame);\n\t}\n\n\t/**\n\t * Called by the Router to instantiate a new component during the commit phase of a navigation.\n\t * This method in turn is responsible for calling the `routerOnActivate` hook of its child.\n\t */\n\t@profile\n\tactivateWith(activatedRoute: ActivatedRoute, resolver: ComponentFactoryResolver | null): void {\n\t\tthis.outlet = this.outlet || this.getOutlet(activatedRoute.snapshot);\n\t\tif (!this.outlet) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerError('No outlet found relative to activated route');\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tthis.outlet.isNSEmptyOutlet = this.isEmptyOutlet;\n\t\tthis.locationStrategy.updateOutletFrame(this.outlet, this.frame, this.isEmptyOutlet);\n\n\t\tif (this.outlet && this.outlet.isPageNavigationBack) {\n\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\tNativeScriptDebug.routerLog('Currently in page back navigation - component should be reattached instead of activated.');\n\t\t\t}\n\t\t\tthis.locationStrategy._finishBackPageNavigation(this.frame);\n\t\t}\n\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog(`PageRouterOutlet.activateWith() - ${routeToString(activatedRoute)}`);\n\t\t}\n\n\t\tthis._activatedRoute = activatedRoute;\n\n\t\tthis.markActivatedRoute(activatedRoute);\n\n\t\tresolver = resolver || this.resolver;\n\n\t\tthis.activateOnGoForward(activatedRoute, resolver);\n\t\tthis.activateEvents.emit(this.activated.instance);\n\t}\n\n\tprivate activateOnGoForward(activatedRoute: ActivatedRoute, loadedResolver: ComponentFactoryResolver): void {\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('PageRouterOutlet.activate() forward navigation - ' + 'create detached loader in the loader container');\n\t\t}\n\n\t\tconst factory = this.getComponentFactory(activatedRoute, loadedResolver);\n\t\tconst page = this.pageFactory({\n\t\t\tisNavigation: true,\n\t\t\tcomponentType: factory.componentType,\n\t\t});\n\n\t\tconst destructables = new Set([]);\n\t\tconst injector = Injector.create({\n\t\t\tproviders: [\n\t\t\t\t{ provide: Page, useValue: page },\n\t\t\t\t{ provide: Frame, useValue: this.frame },\n\t\t\t\t{ provide: PageRoute, useValue: new PageRoute(activatedRoute) },\n\t\t\t\t{ provide: ActivatedRoute, useValue: activatedRoute },\n\t\t\t\t{ provide: ChildrenOutletContexts, useValue: this.parentContexts.getOrCreateContext(this.name).children },\n\t\t\t],\n\t\t\tparent: this.location.injector,\n\t\t});\n\n\t\tconst childInjector = new DestructibleInjector(destructables, injector);\n\t\tconst loaderRef = this.location.createComponent(this.detachedLoaderFactory, this.location.length, childInjector, []);\n\t\tloaderRef.onDestroy(() => childInjector.destroy());\n\t\tthis.changeDetector.markForCheck();\n\n\t\tthis.activated = loaderRef.instance.loadWithFactory(factory);\n\t\tthis.loadComponentInPage(page, this.activated, { activatedRoute });\n\n\t\tthis.activated[loaderRefSymbol] = loaderRef;\n\t}\n\n\t@profile\n\tprivate loadComponentInPage(page: Page, componentRef: ComponentRef<any>, navigationContext): void {\n\t\t// Component loaded. Find its root native view.\n\t\tconst componentView = componentRef.location.nativeElement;\n\t\t// Remove it from original native parent.\n\t\tthis.viewUtil.removeChild(componentView.parent, componentView);\n\t\t// Add it to the new page\n\t\tthis.viewUtil.insertChild(page, componentView);\n\n\t\tconst navigatedFromCallback = (<any>global).Zone.current.wrap((args: NavigatedData) => {\n\t\t\tif (args.isBackNavigation) {\n\t\t\t\tthis.locationStrategy._beginBackPageNavigation(this.frame);\n\t\t\t\tthis.locationStrategy.back(null, this.frame);\n\t\t\t}\n\t\t});\n\t\t// TODO: experiment with using NgZone instead of global above\n\t\t// const navigatedFromCallback = (args: NavigatedData) => {\n\t\t// \tif (args.isBackNavigation) {\n\t\t//     this.ngZone.run(() => {\n\t\t//       this.locationStrategy._beginBackPageNavigation(this.frame);\n\t\t//       this.locationStrategy.back(null, this.frame);\n\t\t//     });\n\t\t// \t}\n\t\t// };\n\n\t\tpage.on(Page.navigatedFromEvent, navigatedFromCallback);\n\t\tcomponentRef.onDestroy(() => {\n\t\t\tif (page) {\n\t\t\t\tpage.off(Page.navigatedFromEvent, navigatedFromCallback);\n\t\t\t\tpage = null;\n\t\t\t}\n\t\t});\n\n\t\tconst navOptions = this.locationStrategy._beginPageNavigation(this.frame);\n\n\t\t// Clear refCache if navigation with clearHistory\n\t\tif (navOptions.clearHistory) {\n\t\t\tconst clearCallback = () =>\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (this.outlet) {\n\t\t\t\t\t\tthis.routeReuseStrategy.clearCache(this.outlet.outletKeys[0]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\tpage.once(Page.navigatedToEvent, clearCallback);\n\t\t}\n\n\t\tthis.frame.navigate({\n\t\t\tcreate() {\n\t\t\t\treturn page;\n\t\t\t},\n\t\t\tcontext: navigationContext,\n\t\t\tclearHistory: navOptions.clearHistory,\n\t\t\tanimated: navOptions.animated,\n\t\t\ttransition: navOptions.transition,\n\t\t});\n\t}\n\n\t// Find and mark the top activated route as an activated one.\n\t// In ns-location-strategy we are reusing components only if their corresponing routes\n\t// are marked as activated from this method.\n\tprivate markActivatedRoute(activatedRoute: ActivatedRoute) {\n\t\tconst queue = [];\n\t\tqueue.push(activatedRoute.snapshot);\n\t\tlet currentRoute = queue.shift();\n\n\t\twhile (currentRoute) {\n\t\t\tcurrentRoute.children.forEach((childRoute) => {\n\t\t\t\tqueue.push(childRoute);\n\t\t\t});\n\n\t\t\tconst topActivatedRoute = findTopActivatedRouteNodeForOutlet(currentRoute);\n\t\t\tlet outletKey = this.locationStrategy.getRouteFullPath(topActivatedRoute);\n\t\t\tlet outlet = this.locationStrategy.findOutlet(outletKey, topActivatedRoute);\n\n\t\t\tif (outlet && outlet.frames.length) {\n\t\t\t\ttopActivatedRoute[pageRouterActivatedSymbol] = true;\n\t\t\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\t\t\tNativeScriptDebug.routerLog('Activated route marked as page: ' + routeToString(topActivatedRoute));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcurrentRoute = queue.shift();\n\t\t}\n\t}\n\n\tprivate getComponentFactory(activatedRoute: ActivatedRoute, loadedResolver: ComponentFactoryResolver): ComponentFactory<any> {\n\t\tconst { component } = activatedRoute.routeConfig;\n\n\t\treturn loadedResolver ? loadedResolver.resolveComponentFactory(component) : this.componentFactoryResolver.resolveComponentFactory(component);\n\t}\n\n\tprivate getOutlet(activatedRouteSnapshot: ActivatedRouteSnapshot): Outlet {\n\t\tconst topActivatedRoute = findTopActivatedRouteNodeForOutlet(activatedRouteSnapshot);\n\t\tconst outletKey = this.locationStrategy.getRouteFullPath(topActivatedRoute);\n\t\tlet outlet = this.locationStrategy.findOutlet(outletKey, topActivatedRoute);\n\n\t\t// Named lazy loaded outlet.\n\t\tif (!outlet && this.isEmptyOutlet) {\n\t\t\tconst parentOutletKey = this.locationStrategy.getRouteFullPath(topActivatedRoute.parent);\n\t\t\toutlet = this.locationStrategy.findOutlet(parentOutletKey, topActivatedRoute.parent);\n\n\t\t\tif (outlet) {\n\t\t\t\toutlet.outletKeys.push(outletKey);\n\t\t\t}\n\t\t}\n\n\t\treturn outlet;\n\t}\n}\n","import { NSLocationStrategy } from './ns-location-strategy';\nimport { PlatformLocation, LocationChangeListener } from '@angular/common';\nimport { Injectable } from '@angular/core';\nimport { NativeScriptDebug } from '../trace';\n\n@Injectable()\nexport class NativescriptPlatformLocation extends PlatformLocation {\n\tconstructor(private locationStrategy: NSLocationStrategy) {\n\t\tsuper();\n\t\tif (NativeScriptDebug.isLogEnabled()) {\n\t\t\tNativeScriptDebug.routerLog('NativescriptPlatformLocation.constructor()');\n\t\t}\n\t}\n\n\tgetState(): any {\n\t\treturn undefined;\n\t}\n\n\treadonly hostname: string;\n\treadonly href: string;\n\treadonly port: string;\n\treadonly protocol: string;\n\n\tgetBaseHrefFromDOM(): string {\n\t\treturn '/';\n\t}\n\n\tonPopState(fn: LocationChangeListener): void {\n\t\tthis.locationStrategy.onPopState(fn);\n\t}\n\n\tonHashChange(_fn: LocationChangeListener): void {}\n\n\tget search(): string {\n\t\treturn '';\n\t}\n\tget hash(): string {\n\t\treturn '';\n\t}\n\tget pathname(): string {\n\t\treturn this.locationStrategy.path();\n\t}\n\tset pathname(_newPath: string) {\n\t\tthrow new Error('NativescriptPlatformLocation set pathname - not implemented');\n\t}\n\n\tpushState(state: any, title: string, url: string): void {\n\t\tthis.locationStrategy.pushState(state, title, url, null);\n\t}\n\n\treplaceState(state: any, title: string, url: string): void {\n\t\tthis.locationStrategy.replaceState(state, title, url, null);\n\t}\n\n\tforward(): void {\n\t\tthrow new Error('NativescriptPlatformLocation.forward() - not implemented');\n\t}\n\n\tback(): void {\n\t\tthis.locationStrategy.back();\n\t}\n}\n","import { Component, ViewChild } from '@angular/core';\nimport { Page } from '@nativescript/core';\nimport { PageRouterOutlet } from './page-router-outlet';\n@Component({\n\t// tslint:disable-next-line:component-selector\n\tselector: 'ns-empty-outlet',\n\ttemplate: \"<page-router-outlet isEmptyOutlet='true'></page-router-outlet>\",\n})\nexport class NSEmptyOutletComponent {\n\t@ViewChild(PageRouterOutlet, { read: PageRouterOutlet, static: false }) pageRouterOutlet: PageRouterOutlet;\n\tconstructor(private page: Page) {\n\t\tif (this.page) {\n\t\t\tthis.page.actionBarHidden = true;\n\n\t\t\tthis.page.on('loaded', () => {\n\t\t\t\tif (this.pageRouterOutlet && this.page.frame) {\n\t\t\t\t\tthis.pageRouterOutlet.setActionBarVisibility(this.page.frame.actionBarVisibility);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n","import { Compiler, Injectable, Optional, SystemJsNgModuleLoader, SystemJsNgModuleLoaderConfig } from '@angular/core';\n\n@Injectable()\nexport class NSModuleFactoryLoader extends SystemJsNgModuleLoader {\n\tconstructor(compiler: Compiler, @Optional() config?: SystemJsNgModuleLoaderConfig) {\n\t\tsuper(compiler, config);\n\t\tconsole.log(`NSModuleFactoryLoader is deprecated! ` + `You no longer need to provide it as a module loader.`);\n\t}\n}\n","import { NgModule, ModuleWithProviders, NO_ERRORS_SCHEMA, Optional, SkipSelf } from '@angular/core';\nimport { RouterModule, Routes, ExtraOptions, RouteReuseStrategy } from '@angular/router';\nimport { LocationStrategy, PlatformLocation } from '@angular/common';\nimport { NSRouterLink } from './ns-router-link';\nimport { NSRouterLinkActive } from './ns-router-link-active';\nimport { PageRouterOutlet } from './page-router-outlet';\nimport { NSLocationStrategy } from './ns-location-strategy';\nimport { NativescriptPlatformLocation } from './ns-platform-location';\nimport { NSRouteReuseStrategy } from './ns-route-reuse-strategy';\nimport { RouterExtensions } from './router-extensions';\nimport { NativeScriptCommonModule } from '../common';\nimport { FrameService } from '../frame.service';\nimport { NSEmptyOutletComponent } from './ns-empty-outlet.component';\n\nexport { PageRoute } from './page-router-outlet';\nexport { RouterExtensions } from './router-extensions';\nexport { NSModuleFactoryLoader } from './ns-module-factory-loader';\nexport { Outlet, NavigationOptions, LocationState, defaultNavOptions } from './ns-location-utils';\nexport { NSRouterLink } from './ns-router-link';\nexport { NSRouterLinkActive } from './ns-router-link-active';\nexport { PageRouterOutlet } from './page-router-outlet';\nexport { NSLocationStrategy } from './ns-location-strategy';\nexport { NSEmptyOutletComponent } from './ns-empty-outlet.component';\n\nexport function provideLocationStrategy(locationStrategy: NSLocationStrategy, frameService: FrameService): NSLocationStrategy {\n\treturn locationStrategy ? locationStrategy : new NSLocationStrategy(frameService);\n}\n\n@NgModule({\n\tdeclarations: [NSRouterLink, NSRouterLinkActive, PageRouterOutlet, NSEmptyOutletComponent],\n\tentryComponents: [NSEmptyOutletComponent],\n\timports: [RouterModule, NativeScriptCommonModule],\n\texports: [RouterModule, NSRouterLink, NSRouterLinkActive, PageRouterOutlet, NSEmptyOutletComponent],\n\tschemas: [NO_ERRORS_SCHEMA],\n})\nexport class NativeScriptRouterModule {\n\tstatic forRoot(routes: Routes, config?: ExtraOptions): ModuleWithProviders<NativeScriptRouterModule> {\n\t\treturn {\n\t\t\tngModule: NativeScriptRouterModule,\n\t\t\tproviders: [\n\t\t\t\t...RouterModule.forRoot(routes, config).providers,\n\t\t\t\t{\n\t\t\t\t\tprovide: NSLocationStrategy,\n\t\t\t\t\tuseFactory: provideLocationStrategy,\n\t\t\t\t\tdeps: [[NSLocationStrategy, new Optional(), new SkipSelf()], FrameService],\n\t\t\t\t},\n\t\t\t\t{ provide: LocationStrategy, useExisting: NSLocationStrategy },\n\t\t\t\tNativescriptPlatformLocation,\n\t\t\t\t{ provide: PlatformLocation, useExisting: NativescriptPlatformLocation },\n\t\t\t\tRouterExtensions,\n\t\t\t\tNSRouteReuseStrategy,\n\t\t\t\t{ provide: RouteReuseStrategy, useExisting: NSRouteReuseStrategy },\n\t\t\t],\n\t\t};\n\t}\n\n\tstatic forChild(routes: Routes): ModuleWithProviders<NativeScriptRouterModule> {\n\t\treturn { ngModule: NativeScriptRouterModule, providers: RouterModule.forChild(routes).providers };\n\t}\n}\n","// Initial imports and polyfills\nimport '@nativescript/core';\nimport '@nativescript/zone-js';\n// TODO: migrate to standard zone.js if possible\n// investigate Ivy with templated-items-comp to allow standard zone below to be used instead of patched {N} zone above\n// import 'zone.js/dist/zone';\nimport './dom-adapter';\nimport 'nativescript-intl';\n// import \"./polyfills/array\";\nimport './polyfills/console';\n\nexport * from './platform-common';\nexport * from './platform-providers';\nexport * from './platform';\nexport * from './resource-loader';\n\nexport * from './nativescript.module';\nexport * from './common';\nexport * from './common/detached-loader';\nexport * from './common/utils';\n\nexport { NativeScriptAnimationsModule } from './animations';\nexport * from './file-system';\nexport * from './http-client';\nexport * from './forms';\nexport * from './directives';\nexport * from './router';\nexport * from './frame.service';\n\nexport { NativeScriptRenderer } from './renderer';\nexport { EmulatedRenderer } from './renderer-emulated';\nexport { NativeScriptRendererFactory } from './renderer-factory';\n\n// utils\nexport { NativeScriptDebug } from './trace';\nexport * from './app-host-view';\nexport { getViewClass, getViewMeta, isKnownView, registerElement, CommentNode, getSingleViewRecursive, isInvisibleNode, isView } from './element-registry';\nexport type { NgView, ViewClass, ViewClassMeta, ViewResolver, ViewExtensions } from './element-registry';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {ActionBarComponent as ɵi,ActionBarScope as ɵj,ActionItemDirective as ɵk,NavigationButtonDirective as ɵl} from './directives/action-bar';\nexport {ModalDialogService as ɵo} from './directives/dialogs';\nexport {ListViewComponent as ɵc} from './directives/list-view-comp';\nexport {AndroidFilterComponent as ɵm,IosFilterComponent as ɵn} from './directives/platform-filters';\nexport {TabViewDirective as ɵg,TabViewItemDirective as ɵh} from './directives/tab-view';\nexport {TEMPLATED_ITEMS_COMPONENT as ɵe,TemplateKeyDirective as ɵf,TemplatedItemsComponent as ɵd} from './directives/templated-items-comp';\nexport {InvisibleNode as ɵa} from './element-registry';\nexport {NSFileSystem as ɵb} from './file-system/ns-file-system';\nexport {NSLocationStrategy as ɵp} from './router/ns-location-strategy';\nexport {ViewUtil as ɵq} from './view-util';"],"names":["isListLikeIterable","NullViewportScroller","AnimationEngine","AnimationStyleNormalizer","AnimationRendererFactory","WebAnimationsStyleNormalizer","BrowserAnimationBuilder"],"mappings":";;;;;;;;;;;;;;;IAEiB,kBA8DhB;AA9DD,WAAiB,iBAAiB;IACpB,yCAAuB,GAAG,eAAe,CAAC;IAC1C,uCAAqB,GAAG,aAAa,CAAC;IACtC,kCAAgB,GAAG,cAAc,CAAC;IAClC,qCAAmB,GAAG,WAAW,CAAC;IAClC,iDAA+B,GAAG,yBAAyB,CAAC;IAC5D,uCAAqB,GAAG,cAAc,CAAC;IACvC,mCAAiB,GAAG,WAAW,CAAC;;IAEhC,yBAAO,GAAG,KAAK,CAAC,SAAS,EAAE,CAAC;IAEzC,SAAgB,YAAY;QAC3B,OAAO,KAAK,CAAC,SAAS,EAAE,CAAC;KACzB;IAFe,8BAAY,eAE3B,CAAA;IAED,SAAgB,aAAa,CAAC,OAAe;QAC5C,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,kBAAA,uBAAuB,CAAC,CAAC;KAC9C;IAFe,+BAAa,gBAE5B,CAAA;IAED,SAAgB,WAAW,CAAC,GAAG;QAC9B,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,kBAAA,qBAAqB,CAAC,CAAC;KACxC;IAFe,6BAAW,cAE1B,CAAA;IAED,SAAgB,aAAa,CAAC,OAAe;QAC5C,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,kBAAA,qBAAqB,EAAE,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;KACrE;IAFe,+BAAa,gBAE5B,CAAA;IAED,SAAgB,WAAW,CAAC,GAAG;QAC9B,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,kBAAA,gBAAgB,CAAC,CAAC;KACnC;IAFe,6BAAW,cAE1B,CAAA;IAED,SAAgB,SAAS,CAAC,OAAe;QACxC,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,kBAAA,mBAAmB,CAAC,CAAC;KAC1C;IAFe,2BAAS,YAExB,CAAA;IAED,SAAgB,WAAW,CAAC,OAAe;QAC1C,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,kBAAA,mBAAmB,EAAE,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;KACnE;IAFe,6BAAW,cAE1B,CAAA;IAED,SAAgB,qBAAqB,CAAC,OAAe;QACpD,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,kBAAA,+BAA+B,CAAC,CAAC;KACtD;IAFe,uCAAqB,wBAEpC,CAAA;IAED,SAAgB,UAAU,CAAC,OAAe;QACzC,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,UAAU,CAAC,KAAK,EAAE,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;KACtE;IAFe,4BAAU,aAEzB,CAAA;IAED,SAAgB,WAAW,CAAC,OAAe;QAC1C,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,kBAAA,qBAAqB,CAAC,CAAC;KAC5C;IAFe,6BAAW,cAE1B,CAAA;IAED,SAAgB,aAAa,CAAC,OAAe;QAC5C,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,kBAAA,qBAAqB,EAAE,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;KACrE;IAFe,+BAAa,gBAE5B,CAAA;IAED,SAAgB,YAAY,CAAC,OAAe;QAC3C,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,kBAAA,iBAAiB,CAAC,CAAC;KACxC;IAFe,8BAAY,eAE3B,CAAA;IAED,SAAgB,iBAAiB,CAAC,OAAe;QAChD,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,kBAAA,iBAAiB,EAAE,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;KACjE;IAFe,mCAAiB,oBAEhC,CAAA;AACF,CAAC,EA9DgB,iBAAiB,KAAjB,iBAAiB;;MCGrB,sBAAsB;IAAnC;QAmCQ,uBAAkB,GAAc,IAAI,CAAC;KAuV5C;IAzXA,OAAO,WAAW;QACjB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,6BAA6B,CAAC,CAAC;SAC7D;QAED,kBAAkB,CAAC,IAAI,sBAAsB,EAAE,CAAC,CAAC;KACjD;IAED,WAAW,CAAC,QAAa,EAAE,KAAa;;QAEvC,OAAO,IAAI,CAAC;KACZ;IAED,GAAG,CAAC,GAAQ;QACX,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;KACjB;IAED,QAAQ,CAAC,GAAQ;QAChB,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;KACjB;IAED,QAAQ,CAAC,GAAQ;QAChB,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;KACjB;IAED,WAAW,MAAW;IAEtB,IAAI,aAAa;QAChB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,IAAI,aAAa,CAAC,MAAiC;QAClD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IAGD,WAAW,CAAC,GAAY,EAAE,KAAa,EAAE,MAAW;QACnD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,GAAY,EAAE,KAAa;QACtC,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,MAAM,CAAC,GAAY,EAAE,WAAmB,EAAE,KAAY;QACrD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IAED,QAAQ,CAAC,MAAW,EAAE,MAAW;QAChC,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,KAAK,CAAC,aAAqB;QAC1B,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,KAAK,CAAC,SAAiB;QACtB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,aAAa,CAAC,GAAQ,oBAAoB,SAAiB;QAC1D,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,gBAAgB,CAAC,GAAQ,oBAAoB,SAAiB;QAC7D,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,EAAE,CAAC,GAAQ,oBAAoB,IAAS,oBAAoB,SAAc;QACzE,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,GAAQ,oBAAoB,IAAS,oBAAoB,SAAc;QAClF,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,aAAa,CAAC,GAAQ,oBAAoB,IAAS;QAClD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,gBAAgB,CAAC,UAAe;QAC/B,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,UAAkB;QAC7B,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,cAAc,CAAC,IAAS;QACvB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,IAAS;QACpB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,GAAQ;QACpB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IAED,kBAAkB,CAAC,GAAQ;QAC1B,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,GAAQ;QACpB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,QAAQ,CAAC,KAAU;QAClB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,SAAS,CAAC,KAAU;QACnB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,IAAI,CAAC,KAAU;QACd,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,OAAO,CAAC,KAAU;QACjB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,UAAU,CAAC,GAAQ;QAClB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,GAAQ;QACnB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,aAAa,CAAC,GAAQ;QACrB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,UAAU,CAAC,GAAQ;QAClB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,gBAAgB,CAAC,GAAQ;QACxB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,UAAU,CAAC,GAAQ;QAClB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,GAAQ,oBAAoB,KAAU;QACjD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,GAAQ,oBAAoB,KAAU;QACjD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,GAAQ,oBAAoB,QAAa,oBAAoB,QAAa;QACtF,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,MAAM,CAAC,GAAQ;QACd,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,GAAQ,oBAAoB,KAAU;QAClD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,eAAe,CAAC,GAAQ,oBAAoB,MAAW;QACtD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,GAAQ,oBAAoB,KAAU;QACjD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,GAAQ,oBAAoB,MAAW;QACnD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,OAAO,CAAC,GAAQ;QACf,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,OAAO,CAAC,GAAQ,oBAAoB,MAAc;QACjD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,QAAQ,CAAC,GAAQ;QAChB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,QAAQ,CAAC,GAAQ,oBAAoB,MAAc;QAClD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,UAAU,CAAC,GAAQ;QAClB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,UAAU,CAAC,GAAQ,oBAAoB,MAAe;QACrD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,aAAa,CAAC,KAAa;QAC1B,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,cAAc,CAAC,KAAU;QACxB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,aAAa,CAAC,QAAa,oBAAoB,IAAU;QACxD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,eAAe,CAAC,GAAW,EAAE,QAAgB,EAAE,IAAU;QACxD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,cAAc,CAAC,KAAa,EAAE,IAAU;QACvC,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,eAAe,CAAC,SAAiB,EAAE,UAAkB,EAAE,IAAU;QAChE,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,kBAAkB,CAAC,IAAY,EAAE,IAAU;QAC1C,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,gBAAgB,CAAC,GAAQ;QACxB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,aAAa,CAAC,GAAQ;QACrB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,OAAO,CAAC,GAAQ;QACf,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,mBAAmB,CAAC,GAAQ;QAC3B,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,KAAK,qBAAqB,CAAC,KAAW;QACrC,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,sBAAsB,CAAC,QAAa,oBAAoB,KAAa;QACpE,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,oBAAoB,CAAC,QAAa,oBAAoB,KAAa;QAClE,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,SAAS,CAAC,QAAa;QACtB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,QAAQ,CAAC,QAAa,oBAAoB,UAAkB;QAC3D,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,QAAa,oBAAoB,UAAkB;QAC9D,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,QAAQ,CAAC,QAAa,oBAAoB,UAAkB;QAC3D,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,QAAQ,CAAC,QAAa,oBAAoB,UAAkB,EAAE,WAAmB;QAChF,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,QAAa,oBAAoB,UAAkB;QAC9D,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,QAAQ,CAAC,QAAa,oBAAoB,UAAkB;QAC3D,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,QAAQ,CAAC,QAAa,oBAAoB,UAAkB,EAAE,WAAoB;QACjF,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,OAAO,CAAC,QAAa;QACpB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,QAAa;QACzB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,QAAa,oBAAoB,UAAkB;QAC/D,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,cAAc,CAAC,QAAa,oBAAoB,GAAW,EAAE,UAAkB;QAC9E,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,QAAa,oBAAoB,UAAkB;QAC/D,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,cAAc,CAAC,QAAa,oBAAoB,GAAW,EAAE,UAAkB;QAC9E,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,QAAa,oBAAoB,KAAa,EAAE,MAAc;QAC1E,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,cAAc,CAAC,QAAa,oBAAoB,GAAW,EAAE,KAAa,EAAE,MAAc;QACzF,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,eAAe,CAAC,QAAa,oBAAoB,UAAkB;QAClE,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,iBAAiB,CAAC,QAAa,oBAAoB,GAAW,EAAE,UAAkB;QACjF,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,iBAAiB,CAAC,GAAQ;QACzB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,kBAAkB;QACjB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,UAAU;QACT,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,kBAAkB;QACjB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,qBAAqB,CAAC,GAAQ;QAC7B,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,QAAQ;QACP,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,QAAQ,CAAC,IAAc,EAAE,SAAiB;QACzC,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,cAAc,CAAC,EAAO,oBAAoB,SAAiB;QAC1D,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,iBAAiB,CAAC,GAAQ;QACzB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,UAAU,CAAC,KAAU;QACpB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,aAAa,CAAC,KAAU;QACvB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,aAAa,CAAC,KAAU;QACvB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,aAAa,CAAC,KAAU;QACvB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,KAAU;QACtB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,aAAa,qBAAqB,CAAC,KAAW;QAC7C,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,SAAS,qBAAqB,CAAC,KAAW;QACzC,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,OAAO,CAAC,QAAa;QACpB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW,CAAC,MAAW;QACtB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,iBAAiB,CAAC,QAAa,oBAAoB,QAAgB,EAAE,KAAa;QACjF,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,iBAAiB;QAChB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,uBAAuB;QACtB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,oBAAoB,CAAC,IAAc,EAAE,OAAe;QACnD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,UAAU;QACT,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW;QACV,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,WAAW;QACV,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,gBAAgB;QACf,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY;QACX,OAAO,iBAAiB,CAAC;KACzB;IACD,OAAO,CAAC,QAAa,oBAAoB,KAAa,EAAE,MAAc;QACrE,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,gBAAgB,CAAC,QAAa;QAC7B,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,OAAO,CAAC,QAAa,oBAAoB,KAAa;QACrD,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,YAAY,CAAC,KAAa,EAAE,MAAW;QACtC,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,oBAAoB;QACnB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,cAAc;QACb,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,kBAAkB;QACjB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,gBAAgB;QACf,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,iBAAiB;QAChB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IAED,eAAe;QACd,OAAO,KAAK,CAAC;KACb;IACD,SAAS,CAAC,KAAa;QACtB,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;IACD,SAAS,CAAC,KAAa,EAAE,MAAc;QACtC,MAAM,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;KACpC;CACD;AAED,sBAAsB,CAAC,WAAW,EAAE;;ACjYpC,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE;IACnB,OAAO,CAAC,KAAK,GAAG,SAAQ,CAAC;CACzB;AAED,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;IACtB,OAAO,CAAC,QAAQ,GAAG,SAAQ,CAAC;;;MCDhB,aAAa,GAAG,IAAI,cAAc,CAAO,yBAAyB,EAAE;MACpE,WAAW,GAAG,IAAI,cAAc,CAAU,iCAAiC,EAAE;MAU7E,YAAY,GAAG,IAAI,cAAc,CAAc,yBAAyB,EAAE;MAC1E,kBAAkB,GAAgB,UAAU,KAAyB;IACjF,OAAO,IAAI,IAAI,EAAE,CAAC;AACnB,EAAE;MACW,0BAA0B,GAAG,EAAE,OAAO,EAAE,YAAY,EAAE,QAAQ,EAAE,kBAAkB,GAAG;AAElG,IAAI,YAA2B,CAAC;SAEhB,WAAW,CAAC,IAAU;IACrC,YAAY,GAAG,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC;AAClC,CAAC;SAEe,WAAW;IAC1B,OAAO,YAAY,IAAI,YAAY,CAAC,GAAG,EAAE,CAAC;AAC3C,CAAC;AAED;SACgB,cAAc;IAC7B,MAAM,QAAQ,GAAG,WAAW,EAAE,CAAC;IAC/B,IAAI,QAAQ,YAAY,IAAI,EAAE;QAC7B,OAAO,QAAQ,CAAC;KAChB;;;;IAKD,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;IAC9B,IAAI,KAAK,IAAI,KAAK,CAAC,WAAW,EAAE;QAC/B,OAAO,KAAK,CAAC,WAAW,CAAC;KACzB;IAED,OAAO,IAAI,CAAC;AACb,CAAC;MAEY,mBAAmB,GAAG,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE,cAAc,GAAG;AAEjF;SACgB,eAAe;IAC9B,OAAO,KAAK,CAAC,OAAO,EAAE,CAAC;AACxB,CAAC;MAEY,oBAAoB,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,UAAU,EAAE,eAAe,GAAG;AAEpF;SACgB,gBAAgB;IAC/B,OAAO,MAAM,CAAC;AACf,CAAC;MAEY,qBAAqB,GAAG,EAAE,OAAO,EAAE,WAAW,EAAE,UAAU,EAAE,gBAAgB;;MC7D5E,WAAY,SAAQ,WAAW;IAI3C,YAAY,eAAsB;QACjC,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC;KACvC;IAED,IAAI,SAAS;QACZ,OAAO,IAAI,CAAC,UAAU,CAAC;KACvB;IAED,IAAI,SAAS,CAAC,KAAW;QACxB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;KACxB;IAED,IAAI,OAAO;QACV,OAAO,IAAI,CAAC,QAAQ,CAAC;KACrB;IAED,IAAI,OAAO,CAAC,KAAW;QACtB,IAAI,IAAI,CAAC,QAAQ,EAAE;YAClB,IAAI,CAAC,QAAQ,CAAC,UAAU,GAAG,SAAS,CAAC;SACrC;QAED,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QAEtB,IAAI,KAAK,EAAE;YACV,IAAI,CAAC,QAAQ,CAAC,UAAU,GAAQ,IAAI,CAAC;SACrC;QAED,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QAEvB,IAAI,IAAI,CAAC,QAAQ,YAAY,kBAAkB,EAAE;YAChD,MAAM,IAAI,GAAG,IAAI,UAAU,EAAE,CAAC;YAC9B,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;YAC5C,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC7B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;SACtB;KACD;CACD;MAEY,gBAAiB,SAAQ,UAAU;IAC/C,YAAY,eAAsB;QACjC,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC;KACvC;IAED,IAAI,SAAS;QACZ,OAAO,IAAI,CAAC;KACZ;IAED,IAAI,SAAS,CAAC,KAAW;;KAExB;;;MC9CW,gBAAgB,GAAG,IAAI,YAAY,GAAqB;MACxD,eAAe,GAAG,IAAI,YAAY,GAG1C;AACL,IAAI,sBAAiD,CAAC;MA4DzC,qBAAsB,SAAQ,SAAS;IACnD,QAAQ,CAAC,QAAa,EAAE,KAAa;QACpC,OAAO,KAAK,CAAC;KACb;CACD;MAEY,oBAAoB;IAAjC;;QAEQ,SAAI,GAAQ;YAClB,UAAU,EAAE,IAAI;SAChB,CAAC;KAKF;IAHA,aAAa,CAAC,GAAW;QACxB,MAAM,IAAI,KAAK,CAAC,+EAA+E,CAAC,CAAC;KACjG;CACD;MAEY,gBAAgB,GAAG,CAAC,0BAA0B,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,qBAAqB,EAAE,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,oBAAoB,EAAE,IAAI,EAAE,EAAE,EAAE,EAAE;MAEpL,uBAAwB,SAAQ,WAAW;IAGvD,YAAoB,QAAqB,EAAU,aAAyB,EAAE;QAC7E,KAAK,EAAE,CAAC;QADW,aAAQ,GAAR,QAAQ,CAAa;QAAU,eAAU,GAAV,UAAU,CAAiB;KAE7E;IAGD,sBAAsB,CAAI,aAAiC;QAC1D,IAAI,CAAC,aAAa,GAAG;YACpB,IAAI,gBAAgB,GAAG,aAAa,CAAC;YACrC,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;gBAC/B,gBAAgB,GAAuB,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,iBAAiB,EAAE,CAAC;aACtF;YAED,OAAO,IAAI,CAAC,QAAQ,CAAC,sBAAsB,CAAC,gBAAgB,CAAC,CAAC;SAC9D,CAAC;QAEF,IAAI,CAAC,YAAY,EAAE,CAAC;QAEpB,OAAO,IAAI,CAAC;KACZ;IAGD,eAAe,CAAI,UAAmB,EAAE,kBAAuD,EAAE;QAChG,IAAI,CAAC,aAAa,GAAG;YACpB,IAAI,aAAa,GAAG,UAAU,CAAC;YAC/B,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;gBAC/B,aAAa,GAAY,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,iBAAiB,EAAE,CAAC;aACxE;YAED,OAAO,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,aAAa,EAAE,eAAe,CAAC,CAAC;SACrE,CAAC;QACF,IAAI,CAAC,YAAY,EAAE,CAAC;QAEpB,OAAO,IAAI,CAAC;KACZ;IAGO,YAAY;QACb,MAAO,CAAC,gBAAgB,GAAG;YAChC,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;gBAC/B,MAAM,QAAQ,GAAG,WAAW,CAAC,WAAW,EAAE,CAAC;gBAC3C,IAAI,QAAQ,EAAE;oBACb,QAAQ,CAAC,2BAA2B,EAAE,CAAC;iBACvC;gBAED,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,gBAAgB,CAAC,MAAM,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC;aACpE;iBAAM;gBACN,IAAI,CAAC,SAAS,EAAE,CAAC;aACjB;SACD,CAAC;QAEF,IAAI,IAAI,CAAC,UAAU,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,OAAO,KAAK,QAAQ,EAAE;YACnE,WAAW,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;SACpD;QAED,IAAI,CAAC,wBAAwB,EAAE,CAAC;KAChC;IAED,SAAS,CAAC,QAAoB;QAC7B,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;KAClC;IAED,IAAI,QAAQ;QACX,OAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;KAC9B;IAED,OAAO;QACN,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;KACxB;IAED,IAAI,SAAS;QACZ,OAAO,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;KAC/B;IAGO,wBAAwB;QAC/B,IAAI,WAAiB,CAAC;QAEtB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,YAAY,CAAC,yCAAyC,CAAC,CAAC;SAC1E;QACD,MAAM,cAAc,GAAG,OAAO,CAAC,sDAAsD,EAAE,CAAC,IAAqB;YAC5G,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,YAAY,CAAC,gCAAgC,CAAC,CAAC;aACjE;;YAGD,IAAI,eAA4B,CAAC;YACjC,IAAI,oBAAsC,CAAC;YAC3C,IAAI,IAAI,CAAC,UAAU,KAAK,IAAI,CAAC,UAAU,CAAC,KAAK,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,EAAE;gBAC7E,oBAAoB,GAAG,IAAI,gBAAgB,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,eAAe,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,GAAG,MAAM,CAAC,CAAC,CAAC;gBACtJ,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;oBAC/B,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC;oBAC/C,oBAAoB,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;iBAC1D;gBACD,WAAW,GAAG,oBAAoB,CAAC,SAAS,CAAC;gBAC7C,WAAW,CAAM,oBAAoB,CAAC,CAAC;aACvC;iBAAM;gBACN,eAAe,GAAG,IAAI,WAAW,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,eAAe,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,GAAG,MAAM,CAAC,CAAC,CAAC;gBAC5I,WAAW,CAAM,eAAe,CAAC,CAAC;aAClC;YAED,IAAI,yBAAyB,GAAG,KAAK,CAAC;YACtC,MAAM,SAAS,GAAG;gBACjB,IAAI,CAAC,aAAa,EAAE,CAAC,IAAI,CACxB,CAAC,SAAS;oBACT,yBAAyB,GAAG,IAAI,CAAC;oBACjC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;wBACrC,iBAAiB,CAAC,YAAY,CAAC,6CAA6C,eAAe,EAAE,EAAE,CAAC,CAAC;qBACjG;oBAED,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,OAAO,EAAE;wBACrE,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC;;4BAEzC,oBAAoB,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;4BAC7D,IAAI,CAAC,UAAU,CAAC,UAAU,GAAG,IAAI,CAAC;yBAClC,CAAC,CAAC;qBACH;yBAAM,IAAI,eAAe,EAAE;wBAC3B,WAAW,GAAG,eAAe,CAAC,OAAO,CAAC;qBACtC;oBAED,sBAAsB,GAAG,IAAI,OAAO,CAAC,SAAS,CAAC,CAAC;iBAChD,EACD,CAAC,GAAG;oBACH,yBAAyB,GAAG,IAAI,CAAC;oBACjC,MAAM,YAAY,GAAG,GAAG,CAAC,OAAO,GAAG,MAAM,GAAG,GAAG,CAAC,KAAK,CAAC;oBACtD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;wBACrC,iBAAiB,CAAC,iBAAiB,CAAC,6BAA6B,CAAC,CAAC;qBACnE;oBACD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;wBACrC,iBAAiB,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;qBAClD;oBAED,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;iBAC/C,CACD,CAAC;gBACF,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;oBACrC,iBAAiB,CAAC,YAAY,CAAC,4DAA4D,GAAG,WAAW,CAAC,CAAC;iBAC3G;gBACK,MAAO,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC;gBACzC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;oBACrC,iBAAiB,CAAC,YAAY,CAAC,qEAAqE,GAAG,WAAW,CAAC,CAAC;iBACpH;aACD,CAAC;YAEF,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,cAAc,EAAE;;gBAE/F,UAAU,CAAC;;oBAEV,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,cAAc,EAAE,CAAC;iBAC5C,CAAC,CAAC;aACH;YACD,SAAS,EAAE,CAAC;;;;;;;;YAQZ,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC;SACxB,CAAC,CAAC;QACH,MAAM,YAAY,GAAG,OAAO,CAAC,oDAAoD,EAAE,CAAC,IAA0B;YAC7G,MAAM,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC;YACrC,IAAI,eAAe,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,EAAE;;gBAEtD,OAAO;aACP;YAED,MAAM,aAAa,GAAG,sBAAsB,GAAG,sBAAsB,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC;YACnF,IAAI,aAAa,EAAE;;gBAElB,sBAAsB,GAAG,IAAI,CAAC;gBAE9B,aAAa,CAAC,OAAO,EAAE,CAAC;aACxB;YAED,WAAW,GAAG,IAAI,CAAC;SACnB,CAAC,CAAC;QAEH,WAAW,CAAC,EAAE,CAAC,WAAW,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;QACxD,WAAW,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC;QAEpD,WAAW,CAAC,GAAG,EAAE,CAAC;KAClB;IAGM,SAAS;QACf,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,YAAY,CAAC,2BAA2B,CAAC,CAAC;SAC5D;QAED,MAAM,aAAa,GAAG,sBAAsB,GAAG,sBAAsB,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC;QACnF,gBAAgB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QACrC,IAAI,aAAa,EAAE;YAClB,aAAa,CAAC,OAAO,EAAE,CAAC;SACxB;QAED,IAAI,CAAC,aAAa,EAAE,CAAC,IAAI,CACxB,CAAC,SAAS;YACT,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,YAAY,CAAC,wBAAwB,CAAC,CAAC;aACzD;YACD,eAAe,CAAC,IAAI,CAAC,EAAE,SAAS,EAAE,CAAC,CAAC;YAEpC,sBAAsB,GAAG,IAAI,OAAO,CAAC,SAAS,CAAC,CAAC;YAChD,WAAW,CAAC,aAAa,CAAC;gBACzB,MAAM,EAAE,MAAM,WAAW,EAAE;aAC3B,CAAC,CAAC;SACH,EACD,CAAC,KAAK;YACL,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,iBAAiB,CAAC,sCAAsC,CAAC,CAAC;aAC5E;YACD,MAAM,YAAY,GAAG,KAAK,CAAC,OAAO,GAAG,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC;YAC1D,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;aAClD;YAED,WAAW,CAAC,aAAa,CAAC;gBACzB,MAAM,EAAE,MAAM,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC;aAC9C,CAAC,CAAC;YACH,eAAe,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;SAChC,CACD,CAAC;KACF;IAEO,aAAa,CAAC,OAAe;QACpC,MAAM,YAAY,GAAG,IAAI,QAAQ,EAAE,CAAC;QACpC,YAAY,CAAC,IAAI,GAAG,OAAO,CAAC;QAC5B,YAAY,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,KAAK,CAAC,CAAC;QACtC,OAAO,YAAY,CAAC;KACpB;IAEO,kBAAkB,CAAC,UAAmB;QAC7C,MAAM,KAAK,GAAG,IAAI,KAAK,EAAE,CAAC;QAC1B,MAAM,WAAW,GAAgB,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;QAC1E,MAAM,IAAI,GAAG,WAAW,CAAC,EAAE,WAAW,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC,CAAC;QAE5D,KAAK,CAAC,QAAQ,CAAC;YACd,MAAM,EAAE;gBACP,OAAO,IAAI,CAAC;aACZ;SACD,CAAC,CAAC;QACH,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;KACvB;CACD;AAhPA;IADC,OAAO;qEAcP;AAGD;IADC,OAAO;8DAaP;AAGD;IADC,OAAO;2DAoBP;AAmBD;IADC,OAAO;uEA8GP;AAGD;IADC,OAAO;wDAuCP;;AC9TF;AACA,MAAM,qBAAqB,GAAoB,qBAAqB,CAAC,YAAY,EAAE,cAAc,EAAE,CAAC,GAAG,gBAAgB,CAAC,CAAC,CAAC;SAE1G,2BAA2B,CAAC,OAAoB,EAAE,cAAsB;;IAEvF,IAAI,OAAO,IAAI,OAAO,CAAC,kBAAkB,KAAK,IAAI,EAAE;QACnD,OAAO,qBAAqB,CAAC,cAAc,CAAC,CAAC;KAC7C;SAAM;QACN,OAAO,IAAI,uBAAuB,CAAC,qBAAqB,CAAC,cAAc,CAAC,EAAE,OAAO,CAAC,CAAC;KACnF;AACF;;ACXA;AACA;MAGa,YAAY;IACjB,UAAU;QAChB,OAAO,YAAY,CAAC,UAAU,EAAE,CAAC;KACjC;IAEM,YAAY,CAAC,IAAY;QAC/B,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;KAC3B;IAEM,UAAU,CAAC,IAAY;QAC7B,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;KACzB;;;YAZD,UAAU;;;ACAX,MAAM,mBAAmB,GAAG;IAC3B,OAAO,EAAE,MAAM;IACf,OAAO,EAAE,MAAM;IACf,OAAO,EAAE,MAAM;CACf,CAAC;MAGW,wBAAyB,SAAQ,cAAc;IAC3D,YAAoB,EAAgB;QACnC,KAAK,EAAE,CAAC;QADW,OAAE,GAAF,EAAE,CAAc;KAEnC;IAED,GAAG,CAAC,GAAW;QACd,MAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAEvC,MAAM,YAAY,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;QAExD,OAAO,YAAY,CAAC,YAAY,EAAE,CAAC;KACnC;IAED,OAAO,CAAC,GAAW;QAClB,MAAM,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;QAC1D,MAAM,yBAAyB,GAAG,mBAAmB,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,GAAG,KAAK,mBAAmB,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC;QAClH,IAAI,yBAAyB,KAAK,mBAAmB,IAAI,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,yBAAyB,CAAC,EAAE;YACvG,OAAO,yBAAyB,CAAC;SACjC;QACD,IAAI,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,mBAAmB,CAAC,EAAE;YAC5C,OAAO,mBAAmB,CAAC;SAC3B;QAED,IAAI,yBAAyB,KAAK,mBAAmB,EAAE;YACtD,MAAM,IAAI,KAAK,CAAC,qBAAqB,GAAG,iBAAiB,mBAAmB,GAAG,CAAC,CAAC;SACjF;aAAM;YACN,MAAM,IAAI,KAAK,CAAC,qBAAqB,GAAG,GAAG,GAAG,eAAe,yBAAyB,KAAK,mBAAmB,GAAG,CAAC,CAAC;SACnH;KACD;IAEO,mBAAmB,CAAC,GAAW;;QAEtC,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;;YAE3B,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;SACjD;aAAM;YACN,OAAO,GAAG,CAAC;SACX;KACD;;;YAvCD,UAAU;;;YARF,YAAY;;;SCJL,SAAS,CAAC,GAAQ;IACjC,OAAO,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,IAAI,CAAC;AAC1C,CAAC;SAEe,OAAO,CAAC,GAAQ;IAC/B,OAAO,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,IAAI,CAAC;AAC1C;;MCAa,YAAY;;IAExB,QAAQ;QACP,IAAI,YAAY,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;QACnC,OAAO,YAAY,CAAC;KACpB;;;;YARD,UAAU,SAAC;gBACX,UAAU,EAAE,MAAM;aAClB;;;MCYY,MAAM;IAuBlB,YAAY,SAAiB,EAAE,IAAY,EAAE,aAAqB,EAAE,oBAA6B;;;QAXjG,WAAM,GAAiB,EAAE,CAAC;QAM1B,WAAM,GAAyB,EAAE,CAAC;;QAIlC,iBAAY,GAAY,IAAI,CAAC;QAE5B,IAAI,CAAC,UAAU,GAAG,CAAC,SAAS,CAAC,CAAC;QAC9B,IAAI,CAAC,oBAAoB,GAAG,KAAK,CAAC;QAClC,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;QAC1B,IAAI,CAAC,oBAAoB,GAAG,oBAAoB,IAAI,CAAC,CAAC;QACtD,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QACnC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;KACjB;IAED,aAAa,CAAC,KAAY;QACzB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;KACvC;IAED,SAAS;QACR,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3B,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;SAC3C;QACD,OAAO,IAAI,CAAC;KACZ;IAED,gBAAgB,CAAC,QAAgB;QAChC,MAAM,SAAS,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QACnC,OAAO,SAAS,IAAI,SAAS,CAAC,YAAY,CAAC,QAAQ,EAAE,KAAK,QAAQ,CAAC;KACnE;;;IAID,cAAc;QACb,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAEhD,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;YAC1B,KAAK,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE,KAAK,IAAI,CAAC,EAAE,KAAK,EAAE,EAAE;gBAC7D,MAAM,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;gBACxC,IAAI,YAAY,CAAC,SAAS,EAAE,EAAE;oBAC7B,KAAK,GAAG,YAAY,CAAC;oBACrB,MAAM;iBACN;aACD;SACD;QAED,OAAO,KAAK,CAAC;KACb;CACD;MAEY,iBAAiB,GAAsB;IACnD,YAAY,EAAE,KAAK;IACnB,QAAQ,EAAE,IAAI;;;MC1EF,kBAAmB,SAAQ,gBAAgB;IAUvD,YAAoB,YAA0B;QAC7C,KAAK,EAAE,CAAC;QADW,iBAAY,GAAZ,YAAY,CAAc;QATtC,YAAO,GAAkB,EAAE,CAAC;QAG5B,sBAAiB,GAAG,IAAI,KAAK,EAAmB,CAAC;QAIlD,0BAAqB,GAAG,CAAC,CAAC;QAIhC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,kCAAkC,CAAC,CAAC;SAChE;KACD;IAED,IAAI;QACH,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;YACzB,OAAO,GAAG,CAAC;SACX;QAED,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC;QACnE,IAAI,CAAC,KAAK,EAAE;YACX,OAAO,GAAG,CAAC;SACX;QAED,IAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC;QAC/B,IAAI,aAAa,GAAG,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;;;QAIrE,IAAI,KAAK,CAAC,kBAAkB,EAAE;YAC7B,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC,YAAY,CAAC;SAC/B;aAAM,IAAI,aAAa,EAAE;YACzB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,EAAE,aAAa,EAAE,KAAK,CAAC,YAAY,CAAC,CAAC;SACtE;QAED,MAAM,aAAa,GAAG,IAAI,oBAAoB,EAAE,CAAC;QACjD,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,WAAW,CAAC;QACrC,MAAM,GAAG,GAAG,aAAa,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,6BAA6B,GAAG,GAAG,CAAC,CAAC;SACjE;QACD,OAAO,GAAG,CAAC;KACX;IAED,kBAAkB,CAAC,QAAgB;QAClC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,oDAAoD,GAAG,QAAQ,CAAC,CAAC;SAC7F;QACD,OAAO,QAAQ,CAAC;KAChB;IAED,SAAS,CAAC,KAAU,EAAE,KAAa,EAAE,GAAW,EAAE,WAAmB;QACpE,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,sCAAsC,GAAG,GAAG,KAAK,YAAY,KAAK,UAAU,GAAG,kBAAkB,WAAW,EAAE,CAAC,CAAC;SAC5I;QACD,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,WAAW,CAAC,CAAC;KACvD;IAED,iBAAiB,CAAC,KAAU,EAAE,KAAa,EAAE,GAAW,EAAE,WAAmB;QAC5E,MAAM,aAAa,GAAG,IAAI,oBAAoB,EAAE,CAAC;QACjD,IAAI,CAAC,cAAc,GAAG,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAC/C,MAAM,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC;;;QAI7C,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE;YAC9C,MAAM,YAAY,GAAG,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC;YACrE,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,uBAAuB,CAAC,YAAY,CAAC,EAAE,SAAS,CAAC,CAAC;YAC3F,MAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;YAE1C,IAAI,MAAM,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,YAAY,EAAE,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE;gBACvF,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC;aAC5B;iBAAM,IAAI,CAAC,MAAM,EAAE;;gBAEnB,MAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;gBACjH,IAAI,CAAC,aAAa,GAAG,UAAU,CAAC;aAChC;YAED,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,kBAAkB,GAAG,IAAI,CAAC;YACzD,OAAO;SACP;QAED,MAAM,KAAK,GAAG,EAAE,CAAC;QACjB,IAAI,WAAW,GAAQ,WAAW,CAAC;QAEnC,OAAO,WAAW,EAAE;YACnB,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,UAAU;gBACpD,MAAM,mBAAmB,GAAG,WAAW,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;gBAC7D,mBAAmB,CAAC,MAAM,GAAG,UAAU,CAAC;gBACxC,mBAAmB,CAAC,IAAI,GAAG,WAAW,CAAC;gBAEvC,MAAM,UAAU,GAAG,IAAI,CAAC,uBAAuB,CAAC,WAAW,CAAC,CAAC;gBAC7D,IAAI,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC;gBAC1D,IAAI,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;gBAExC,MAAM,gBAAgB,GAAG,WAAW,CAAC,MAAM,IAAI,EAAE,CAAC;gBAClD,MAAM,gBAAgB,GAAG,IAAI,CAAC,uBAAuB,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;gBAC1E,MAAM,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,gBAAgB,EAAE,gBAAgB,CAAC,CAAC;gBAC9E,MAAM,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC;gBAEtD,MAAM,iBAAiB,GAAG,MAAM,IAAI,MAAM,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAC,CAAC;gBAC5F,IAAI,CAAC,MAAM,EAAE;;oBAEZ,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,UAAU,EAAE,mBAAmB,EAAE,YAAY,EAAE,IAAI,CAAC,qBAAqB,EAAE,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;oBAClJ,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC;iBAC5B;qBAAM,IAAI,IAAI,CAAC,qBAAqB,GAAG,CAAC,IAAI,MAAM,CAAC,YAAY,IAAI,CAAC,iBAAiB,EAAE;;oBAEvF,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,mBAAmB,EAAE,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;iBACrF;qBAAM;oBACN,MAAM,CAAC,MAAM,GAAG,YAAY,CAAC;oBAE7B,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,mBAAmB,EAAE,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE;wBACpF,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC;qBAC5B;iBACD;gBAED,KAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;aAChC,CAAC,CAAC;YAEH,WAAW,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC;SAC5B;KACD;IAED,YAAY,CAAC,KAAU,EAAE,KAAa,EAAE,GAAW,EAAE,WAAmB;QACvE,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;QAE/D,IAAI,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YAChC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,SAAS,CAAC,2DAA2D,GAAG,GAAG,KAAK,YAAY,KAAK,UAAU,GAAG,kBAAkB,WAAW,EAAE,CAAC,CAAC;aACjK;SACD;aAAM;YACN,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,SAAS,CAAC,qDAAqD,GAAG,GAAG,KAAK,YAAY,KAAK,UAAU,GAAG,kBAAkB,WAAW,EAAE,CAAC,CAAC;aAC3J;YACD,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,WAAW,CAAC,CAAC;SACvD;KACD;IAED,OAAO;QACN,MAAM,IAAI,KAAK,CAAC,gDAAgD,CAAC,CAAC;KAClE;IAED,IAAI,CAAC,MAAe,EAAE,KAAa;QAClC,IAAI,CAAC,aAAa,GAAG,MAAM,IAAI,IAAI,CAAC,aAAa,CAAC;QAElD,IAAI,IAAI,CAAC,aAAa,CAAC,oBAAoB,EAAE;YAC5C,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;;;YAGzC,IAAI,KAAK,GAAG,MAAM,CAAC,GAAG,EAAE,CAAC;YACzB,IAAI,KAAK,GAAG,CAAC,CAAC;YAEd,IAAI,KAAK,EAAE;gBACV,OAAO,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,KAAK,KAAK,EAAE;oBAC5C,KAAK,GAAG,MAAM,CAAC,GAAG,EAAE,CAAC;oBACrB,KAAK,EAAE,CAAC;iBACR;aACD;YAED,OAAO,CAAC,KAAK,CAAC,gBAAgB,EAAE;gBAC/B,KAAK,GAAG,MAAM,CAAC,GAAG,EAAE,CAAC;gBACrB,KAAK,EAAE,CAAC;aACR;YAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,SAAS,CAAC,mEAAmE,KAAK,EAAE,CAAC,CAAC;aACxG;YACD,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;SAC/B;aAAM;YACN,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC;YAC3C,IAAI,KAAK,IAAI,KAAK,CAAC,gBAAgB,EAAE;;gBAEpC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;oBACrC,iBAAiB,CAAC,SAAS,CAAC,6DAA6D,GAAG,2CAA2C,CAAC,CAAC;iBACzI;gBAED,IAAI,CAAC,MAAM,EAAE;oBACZ,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;oBAClD,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,IAAI,IAAI,CAAC,aAAa,CAAC;iBAC/E;gBAED,MAAM,WAAW,GAAU,IAAI,CAAC,aAAa,CAAC,cAAc,EAAE,CAAC;gBAC/D,IAAI,WAAW,EAAE;oBAChB,WAAW,CAAC,MAAM,EAAE,CAAC;iBACrB;aACD;iBAAM;;gBAEN,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;oBACrC,iBAAiB,CAAC,SAAS,CAAC,6DAA6D,GAAG,+BAA+B,CAAC,CAAC;iBAC7H;gBAED,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,GAAG,EAAE,EAAE,IAAI,CAAC,CAAC;aACzD;SACD;KACD;IAED,SAAS,CAAC,MAAe;QACxB,MAAM,GAAG,MAAM,IAAI,IAAI,CAAC,aAAa,CAAC;QACtC,OAAO,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;KAChC;IAED,UAAU,CAAC,EAAmB;QAC7B,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,+BAA+B,CAAC,CAAC;SAC7D;QACD,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KAChC;IAED,WAAW;QACV,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,kCAAkC,CAAC,CAAC;SAChE;QACD,OAAO,EAAE,CAAC;KACV;IAEO,YAAY,CAAC,KAAoB,EAAE,MAAe,IAAI,EAAE,MAAe;QAC9E,MAAM,GAAG,MAAM,IAAI,IAAI,CAAC,aAAa,CAAC;QACtC,MAAM,aAAa,GAAG,IAAI,oBAAoB,EAAE,CAAC;QACjD,IAAI,aAAa,GAAG,IAAI,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAC;QAEzD,IAAI,KAAK,IAAI,aAAa,EAAE;YAC3B,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,aAAa,EAAE,KAAK,CAAC,YAAY,CAAC,CAAC;SACrF;aAAM,IAAI,aAAa,EAAE;;;YAGzB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,aAAa,EAAE,IAAI,CAAC,CAAC;SACvE;QAED,MAAM,GAAG,GAAG,aAAa,CAAC,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;QACzD,MAAM,MAAM,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;QACtC,KAAK,IAAI,EAAE,IAAI,IAAI,CAAC,iBAAiB,EAAE;YACtC,EAAE,CAAC,MAAM,CAAC,CAAC;SACX;KACD;IAEM,QAAQ;QACd,IAAI,MAAM,GAAG,EAAE,CAAC;QAEhB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM;YAC3B,MAAM,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC;YACnC,MAAM,SAAS,GAAG,YAAY;;iBAE5B,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,GAAG,MAAM,CAAC,UAAU,IAAI,CAAC,KAAK,CAAC,CAAC,gBAAgB,GAAG,MAAM,GAAG,UAAU,MAAM,MAAM,CAAC,oBAAoB,GAAG,OAAO,GAAG,MAAM,MAAM,CAAC,CAAC,YAAY,CAAC,QAAQ,EAAE,GAAG,CAAC;iBAC3K,OAAO,EAAE,CAAC;YAEZ,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;SAClC,CAAC,CAAC;QAEH,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KACzB;;IAGM,wBAAwB,CAAC,KAAY;QAC3C,MAAM,MAAM,GAAW,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;QAEpD,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,oBAAoB,EAAE;YAC3C,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,WAAW,CAAC,iDAAiD,CAAC,CAAC;aACjF;YACD,OAAO;SACP;QAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,kCAAkC,CAAC,CAAC;SAChE;QACD,MAAM,CAAC,oBAAoB,GAAG,IAAI,CAAC;QAEnC,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC;KAC5B;IAEM,yBAAyB,CAAC,KAAY;QAC5C,MAAM,MAAM,GAAW,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;QAEpD,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE;YAC5C,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,WAAW,CAAC,mDAAmD,CAAC,CAAC;aACnF;YACD,OAAO;SACP;QAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,+CAA+C,CAAC,CAAC;SAC7E;QACD,MAAM,CAAC,oBAAoB,GAAG,KAAK,CAAC;KACpC;IAEM,qBAAqB,CAAC,KAAY;QACxC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,4CAA4C,CAAC,CAAC;SAC1E;QAED,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,aAAa,CAAC;;;;QAKxE,IAAI,IAAI,CAAC,aAAa,EAAE;YACvB,IAAI,CAAC,aAAa,CAAC,YAAY,GAAG,IAAI,CAAC;YACvC,IAAI,CAAC,qBAAqB,EAAE,CAAC;SAC7B;KACD;IAEM,qBAAqB;QAC3B,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,2CAA2C,CAAC,CAAC;SACzE;QAED,MAAM,cAAc,GAAG,IAAI,CAAC,qBAAqB,GAAG,CAAC,CAAC;QAEtD,IAAI,cAAc,EAAE;YACnB,IAAI,CAAC,qBAAqB,EAAE,CAAC;SAC7B;;QAGD,MAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC1E,MAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,qBAAqB,EAAE,cAAc,CAAC,IAAI,aAAa,CAAC;QAEnG,IAAI,MAAM,EAAE;YACX,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC;YAC5B,IAAI,CAAC,aAAa,CAAC,YAAY,GAAG,KAAK,CAAC;YACxC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,EAAE,KAAK,CAAC,CAAC;SACzD;KACD;IAEM,oBAAoB,CAAC,KAAY;QACvC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,2CAA2C,CAAC,CAAC;SACzE;QAED,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;QAClD,MAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC;QAEjD,IAAI,SAAS,EAAE;YACd,SAAS,CAAC,gBAAgB,GAAG,IAAI,CAAC;SAClC;QAED,MAAM,UAAU,GAAG,IAAI,CAAC,yBAAyB,IAAI,iBAAiB,CAAC;QACvE,IAAI,UAAU,CAAC,YAAY,EAAE;YAC5B,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,SAAS,CAAC,iEAAiE,CAAC,CAAC;aAC/F;YACD,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,SAAS,CAAC,CAAC;SACxC;QAED,IAAI,CAAC,yBAAyB,GAAG,SAAS,CAAC;QAC3C,OAAO,UAAU,CAAC;KAClB;IAEM,qBAAqB,CAAC,OAA0B;QACtD,IAAI,CAAC,yBAAyB,GAAG;YAChC,YAAY,EAAE,SAAS,CAAC,OAAO,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,YAAY,GAAG,KAAK;YAC5E,QAAQ,EAAE,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAC,QAAQ,GAAG,IAAI;YAC/D,UAAU,EAAE,OAAO,CAAC,UAAU;SAC9B,CAAC;QAEF,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,2CAA2C,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,yBAAyB,CAAC,GAAG,CAAC,CAAC;SAChI;KACD;IAEM,WAAW;QACjB,OAAO,IAAI,CAAC,OAAO,CAAC;KACpB;IAED,iBAAiB,CAAC,MAAc,EAAE,KAAY,EAAE,kBAA2B;QAC1E,MAAM,SAAS,GAAG,MAAM,CAAC,SAAS,EAAE,CAAC;QAErC,IAAI,SAAS,IAAI,CAAC,SAAS,CAAC,KAAK,IAAI,CAAC,kBAAkB,EAAE;YACzD,SAAS,CAAC,KAAK,GAAG,KAAK,CAAC;SACxB;QAED,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,EAAE;YACjC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC1B;QACD,IAAI,CAAC,aAAa,GAAG,MAAM,CAAC;KAC5B;IAED,WAAW,CAAC,KAAY;QACvB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,aAAa;YAChD,IAAI,gBAAgB,CAAC;YAErB,IAAI,IAAI,CAAC,aAAa,EAAE;gBACvB,gBAAgB,GAAG,aAAa,CAAC,aAAa,KAAK,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;aACpF;;YAGD,IAAI,aAAa,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,gBAAgB,EAAE;gBAC5D,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,EAAE,aAAa,CAAC,CAAC;aAC7C;;YAGD,IAAI,aAAa,CAAC,MAAM,CAAC,MAAM,IAAI,CAAC,aAAa,CAAC,eAAe,EAAE;gBAClE,aAAa,CAAC,MAAM,GAAG,aAAa,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,YAAY,KAAK,YAAY,KAAK,KAAK,CAAC,CAAC;gBAC7F,OAAO,aAAa,CAAC,MAAM,CAAC,MAAM,CAAC;aACnC;YAED,OAAO,CAAC,aAAa,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;SAC3C,CAAC,CAAC;KACH;IAED,uBAAuB,CAAC,YAA6B;QACpD,IAAI,QAAQ,GAAG,EAAE,CAAC;QAElB,OAAO,YAAY,EAAE;YACpB,MAAM,GAAG,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;YAEpC,IAAI,QAAQ,EAAE;gBACb,QAAQ,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,IAAI,QAAQ,CAAC;aAC7C;iBAAM;gBACN,QAAQ,GAAG,GAAG,CAAC;aACf;YAED,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC;SACnC;QAED,OAAO,QAAQ,CAAC;KAChB;IAED,gBAAgB,CAAC,YAAiB;QACjC,MAAM,UAAU,GAAG,YAAY,CAAC,MAAM,CAAC;QACvC,IAAI,QAAQ,CAAC;QAEb,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC;QACnC,OAAO,YAAY,EAAE;YACpB,MAAM,IAAI,GAAG,YAAY,CAAC,GAAG,CAAC,KAAK,IAAI,YAAY,CAAC,GAAG,CAAC;YACxD,IAAI,GAAG,GAAG,IAAI,CAAC;YAEf,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;gBACxB,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACpB;YAED,QAAQ,GAAG,QAAQ,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,QAAQ,GAAG,GAAG,CAAC;YAC/D,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC;SACnC;QAED,OAAO,QAAQ,GAAG,QAAQ,GAAG,GAAG,GAAG,UAAU,GAAG,UAAU,CAAC;KAC3D;IAED,gBAAgB,CAAC,eAAoB;QACpC,IAAI,CAAC,eAAe,EAAE;YACrB,OAAO,EAAE,CAAC;SACV;QAED,IAAI,YAAY,CAAC;QACjB,IAAI,QAAQ,GAAG,eAAe,CAAC,MAAM,IAAI,SAAS,CAAC;QACnD,IAAI,MAAM,GAAG,eAAe,CAAC,MAAM,CAAC;QAEpC,OAAO,MAAM,IAAI,eAAe,CAAC,IAAI,KAAK,MAAM,EAAE;YACjD,IAAI,MAAM,IAAI,MAAM,CAAC,MAAM,KAAK,QAAQ,EAAE;gBACzC,IAAI,QAAQ,KAAK,SAAS,EAAE;oBAC3B,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC;iBACzB;qBAAM;oBACN,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC;oBACzB,YAAY,GAAG,QAAQ,GAAG,GAAG,IAAI,YAAY,IAAI,eAAe,CAAC,MAAM,CAAC,CAAC;iBACzE;aACD;YAED,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;SACvB;QAED,OAAO,YAAY,IAAI,QAAQ,CAAC;KAChC;IAED,UAAU,CAAC,SAAiB,EAAE,sBAA+C;QAC5E,IAAI,MAAM,GAAW,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,aAAa;YACpD,IAAI,eAAe,GAAG,aAAa,CAAC,oBAAoB,KAAK,IAAI,CAAC,qBAAqB,CAAC;YACxF,OAAO,eAAe,IAAI,aAAa,CAAC,UAAU,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;SAC3E,CAAC,CAAC;;;QAIH,IAAI,CAAC,MAAM,IAAI,sBAAsB,EAAE;YACtC,MAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,sBAAsB,CAAC,CAAC;YACpE,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,aAAa;gBACxC,IAAI,eAAe,GAAG,aAAa,CAAC,oBAAoB,KAAK,IAAI,CAAC,qBAAqB,CAAC;gBACxF,OAAO,eAAe,IAAI,aAAa,CAAC,aAAa,KAAK,aAAa,CAAC;aACxE,CAAC,CAAC;SACH;QAED,OAAO,MAAM,CAAC;KACd;IAEO,iBAAiB,CAAC,eAAuB,EAAE,cAAwB;QAC1E,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM;YAC/B,IAAI,eAAe,GAAG,MAAM,CAAC,oBAAoB,KAAK,eAAe,CAAC;YACtE,OAAO,cAAc,GAAG,eAAe,IAAI,MAAM,CAAC,YAAY,GAAG,eAAe,CAAC;SACjF,CAAC,CAAC;KACH;IAEO,gBAAgB,CAAC,KAAY;QACpC,IAAI,MAAM,CAAC;QAEX,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE;YACzD,MAAM,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YAE1C,IAAI,aAAa,CAAC,aAAa,CAAC,KAAK,CAAC,EAAE;gBACvC,MAAM,GAAG,aAAa,CAAC;gBACvB,MAAM;aACN;SACD;QAED,OAAO,MAAM,CAAC;KACd;IAEO,YAAY,CAAC,MAAc,EAAE,mBAAoC,EAAE,WAAmB;QAC7F,MAAM,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,CAAC;QAC7C,MAAM,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAC1D,MAAM,cAAc,GAAG,MAAM,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAC,CAAC;QAE/E,MAAM,aAAa,GAAkB;YACpC,YAAY,EAAE,mBAAmB;YACjC,kBAAkB,EAAE,KAAK;YACzB,gBAAgB,EAAE,SAAS;YAC3B,WAAW,oBAAO,WAAW,CAAE;SAC/B,CAAC;QAEF,IAAI,CAAC,SAAS,IAAI,CAAC,cAAc,EAAE;YAClC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;;YAGlC,IAAI,IAAI,CAAC,qBAAqB,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,EAAE;gBAC7D,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE,mBAAmB,CAAC,MAAM,CAAC,CAAC;aAC7D;YAED,OAAO,IAAI,CAAC;SACZ;QAED,OAAO,KAAK,CAAC;KACb;IAEO,mBAAmB,CAAC,MAAc,EAAE,eAAgC;QAC3E,IAAI,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC;;QAGjC,OAAO,YAAY,IAAI,eAAe,EAAE;YACvC,MAAM,KAAK,GAAG,YAAY,CAAC,SAAS,EAAE,CAAC;YAEvC,IAAI,KAAK,EAAE;gBACV,KAAK,CAAC,YAAY,GAAG,eAAe,CAAC;gBACrC,eAAe,GAAG,eAAe,CAAC,MAAM,CAAC;gBACzC,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC;aACnC;SACD;KACD;;IAGO,YAAY,CAAC,SAAiB,EAAE,IAAY,EAAE,YAAiB,EAAE,MAAc,EAAE,eAAwB,EAAE,cAAsB,EAAE;QAC1I,MAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;QAC1D,MAAM,SAAS,GAAG,IAAI,MAAM,CAAC,SAAS,EAAE,IAAI,EAAE,aAAa,EAAE,eAAe,CAAC,CAAC;QAE9E,MAAM,aAAa,GAAkB;YACpC,YAAY,EAAE,YAAY;YAC1B,kBAAkB,EAAE,KAAK;YACzB,gBAAgB,EAAE,IAAI;YACtB,WAAW,oBAAO,WAAW,CAAE;SAC/B,CAAC;QAEF,SAAS,CAAC,MAAM,GAAG,CAAC,aAAa,CAAC,CAAC;QACnC,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC;QAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;;QAG7B,IAAI,IAAI,CAAC,qBAAqB,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE;YAChE,IAAI,CAAC,mBAAmB,CAAC,SAAS,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;SACzD;QAED,OAAO,SAAS,CAAC;KACjB;IAEO,uBAAuB,CAAC,MAAc;QAC7C,MAAM,QAAQ,GAAG,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACjD,IAAI,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC;QAC5C,IAAI,YAAY,CAAC;QAEjB,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,QAAQ,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE;YACrD,MAAM,WAAW,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;YACpC,MAAM,aAAa,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;YAEhE,IAAI,aAAa,IAAI,YAAY,CAAC,QAAQ,CAAC,WAAW,CAAC,EAAE;gBACxD,MAAM,GAAG,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;gBACpC,YAAY,GAAG,YAAY,GAAG,YAAY,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;gBAC7D,YAAY,GAAG,YAAY,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;aAClD;iBAAM;;;;gBAIN,YAAY,GAAG,IAAI,CAAC;gBACpB,MAAM;aACN;SACD;;;QAID,IAAI,YAAY,IAAI,MAAM,CAAC,IAAI,IAAI,YAAY,IAAI,MAAM,CAAC,IAAI,KAAK,YAAY,EAAE;YAChF,YAAY,GAAG,IAAI,CAAC;SACpB;QAED,OAAO,YAAY,CAAC;KACpB;;IAGO,kBAAkB,CAAC,QAAa,EAAE,eAAgC,EAAE,eAAgC;QAC3G,MAAM,KAAK,GAAG,EAAE,CAAC;QACjB,IAAI,WAAW,GAAG,QAAQ,CAAC;QAE3B,OAAO,WAAW,EAAE;YACnB,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,UAAU;gBACpD,IAAI,WAAW,CAAC,QAAQ,CAAC,UAAU,CAAC,KAAK,eAAe,EAAE;oBACzD,IAAI,eAAe,EAAE;wBACpB,WAAW,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,eAAe,CAAC;qBACnD;yBAAM;wBACN,OAAO,WAAW,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;qBACxC;iBACD;gBACD,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC;aAC7C,CAAC,CAAC;YAEH,WAAW,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC;SAC5B;KACD;IAEO,iBAAiB,CAAC,YAAoB,EAAE,cAA+B,EAAE,WAAmB;QACnG,IAAI,kBAAkB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;;QAG5E,IAAI,CAAC,kBAAkB,EAAE;YACxB,IAAI,IAAI,CAAC,qBAAqB,GAAG,CAAC,EAAE;;gBAEnC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,qBAAqB,GAAG,CAAC,CAAC,CAAC;aACtE;;YAGD,MAAM,UAAU,GAAG,SAAS,CAAC;YAC7B,MAAM,UAAU,GAAG,YAAY,CAAC,SAAS,EAAE,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;YACpE,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC;;YAE5D,kBAAkB,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,UAAU,EAAE,cAAc,EAAE,YAAY,EAAE,IAAI,CAAC,qBAAqB,EAAE,WAAW,CAAC,CAAC;YACrI,IAAI,CAAC,aAAa,GAAG,kBAAkB,CAAC;SACxC;aAAM,IAAI,IAAI,CAAC,YAAY,CAAC,kBAAkB,EAAE,cAAc,EAAE,WAAW,CAAC,EAAE;YAC9E,IAAI,CAAC,aAAa,GAAG,kBAAkB,CAAC;SACxC;KACD;IAEO,YAAY,CAAC,IAAY,EAAE,UAAkB;QACpD,OAAO,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,UAAU,GAAG,UAAU,CAAC;KACnD;IAED,WAAW;QACV,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,kCAAkC,CAAC,CAAC;SAChE;QAED,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QAClB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;KAC1B;;;;YAppBD,UAAU,SAAC;gBACX,UAAU,EAAE,MAAM;aAClB;;;YALQ,YAAY;;;ACHrB;;;;;MASa,cAAc;;IAE1B,YAAoB,QAAkC,EAAU,cAAiC,EAAU,YAA8B;QAArH,aAAQ,GAAR,QAAQ,CAA0B;QAAU,mBAAc,GAAd,cAAc,CAAmB;QAAU,iBAAY,GAAZ,YAAY,CAAkB;KAAI;IAErI,cAAc,CAAC,aAAwB;QAC9C,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,uBAAuB,CAAC,aAAa,CAAC,CAAC;QACrE,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,OAAO,EAAE,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;;;;;QAMtH,KAAK,CAAC,KAAK,CAAC,gEAAgE,EAAE,iBAAiB,CAAC,CAAC;QAEjG,OAAO,OAAO,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;KACrC;IAEM,aAAa;QACnB,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC;KACnC;;IAGM,aAAa,CAAC,aAAwB;QAC5C,KAAK,CAAC,KAAK,CAAC,8BAA8B,EAAE,iBAAiB,CAAC,CAAC;QAC/D,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;KAC1C;IAEM,eAAe,CAAI,OAA4B;QACrD,OAAO,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,OAAO,EAAE,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;KAC9G;;;YAjCD,SAAS,SAAC;gBACV,QAAQ,EAAE,mBAAmB;gBAC7B,QAAQ,EAAE,qCAAqC;aAC/C;;;YAX2E,wBAAwB;YAAE,iBAAiB;YAA9E,gBAAgB;;;ACAzD;;;;;SAKgB,oBAAoB,CAAC,YAAiB,EAAE,UAAkB;IACzE,IAAI,YAAY,EAAE;QACjB,MAAM,IAAI,KAAK,CAAC,GAAG,UAAU,oCAAoC,UAAU,yBAAyB,CAAC,CAAC;KACtG;AACF,CAAC;AAED;;;;SAIgB,IAAI,CAAC,EAAY;IAChC,IAAI,SAAS,GAAG,KAAK,CAAC;IAEtB,OAAO,SAAS,OAAO;QACtB,IAAI,SAAS,EAAE;YACd,OAAO;SACP;QAED,SAAS,GAAG,IAAI,CAAC;QACjB,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;KAC1B,CAAC;AACH;;MCEa,iBAAiB;IAC7B,YAAmB,UAAe,EAAE,EAAS,aAA+B;QAAzD,YAAO,GAAP,OAAO,CAAU;QAAS,kBAAa,GAAb,aAAa,CAAkB;KAAI;CAChF;MAGY,kBAAkB;IAC9B,YAAoB,QAA4B;QAA5B,aAAQ,GAAR,QAAQ,CAAoB;KAAI;IAE7C,SAAS,CAAC,IAAe,EAAE,OAA2B;QAC5D,IAAI,CAAC,OAAO,CAAC,gBAAgB,EAAE;YAC9B,MAAM,IAAI,KAAK,CAAC,uBAAuB,GAAG,4DAA4D,CAAC,CAAC;SACxG;QAED,IAAI,UAAU,GAAG,OAAO,CAAC,gBAAgB,CAAC,OAAO,CAAC,aAAa,CAAC;QAChE,IAAI,OAAO,CAAC,MAAM,EAAE;YACnB,UAAU,GAAG,OAAO,CAAC,MAAM,CAAC;SAC5B;QAED,IAAI,CAAC,UAAU,YAAY,WAAW,IAAI,UAAU,YAAY,gBAAgB,KAAK,UAAU,CAAC,SAAS,EAAE;YAC1G,UAAU,GAAG,UAAU,CAAC,SAAS,CAAC;SAClC;;;;QAKD,IAAI,UAAU,CAAC,aAAa,EAAE;YAC7B,UAAU,GAAG,UAAU,CAAC,aAAa,CAAC;SACtC;QAED,MAAM,WAAW,GAAgB,OAAO,CAAC,gBAAgB,CAAC,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;;;QAIrF,MAAM,kBAAkB,GAAG,OAAO,CAAC,SAAS,IAAI,OAAO,CAAC,gBAAgB,CAAC;QACzE,MAAM,QAAQ,GAAG,kBAAkB,CAAC,QAAQ,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;QAE3E,IAAI,KAAK,GAAG,UAAU,CAAC;QACvB,IAAI,EAAE,UAAU,YAAY,KAAK,CAAC,EAAE;YACnC,KAAK,GAAG,CAAC,UAAU,CAAC,IAAI,IAAI,UAAU,CAAC,IAAI,CAAC,KAAK,KAAK,KAAK,CAAC,OAAO,EAAE,CAAC;SACtE;QAED,IAAI,CAAC,QAAQ,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;QAE3C,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM;YAClC,UAAU,CAAC;gBACV,IAAI;oBACH,IAAI,CAAC,WAAW,iCACZ,OAAO,KACV,YAAY,EAAE,OAAO,CAAC,gBAAgB,EACtC,OAAO,EAAE,OAAO,CAAC,OAAO,EACxB,YAAY,EAAE,OAAO,EACrB,WAAW;wBACX,UAAU;wBACV,QAAQ;wBACR,IAAI,IACH,CAAC;iBACH;gBAAC,OAAO,GAAG,EAAE;oBACb,MAAM,CAAC,GAAG,CAAC,CAAC;iBACZ;aACD,EAAE,EAAE,CAAC,CAAC;SACP,CAAC,CAAC;KACH;IAEO,WAAW,CAAC,OAA0B;QAC7C,IAAI,aAAmB,CAAC;QACxB,IAAI,iBAA+C,CAAC;QAEpD,MAAM,aAAa,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI;YAClC,OAAO,CAAC,YAAY,CAAC,KAAK,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;YAC5C,IAAI,aAAa,EAAE;gBAClB,aAAa,CAAC,UAAU,EAAE,CAAC;gBAC3B,IAAI,CAAC,QAAQ,CAAC,qBAAqB,EAAE,CAAC;gBACtC,iBAAiB,CAAC,QAAQ,CAAC,aAAa,EAAE,CAAC;gBAC3C,iBAAiB,CAAC,OAAO,EAAE,CAAC;aAC5B;SACD,CAAC,CAAC;QAEH,MAAM,WAAW,GAAG,IAAI,iBAAiB,CAAC,OAAO,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;QAE1E,MAAM,aAAa,GAAG,QAAQ,CAAC,MAAM,CAAC;YACrC,SAAS,EAAE,CAAC,EAAE,OAAO,EAAE,iBAAiB,EAAE,QAAQ,EAAE,WAAW,EAAE,CAAC;YAClE,MAAM,EAAE,OAAO,CAAC,YAAY,CAAC,QAAQ;SACrC,CAAC,CAAC;QACH,MAAM,eAAe,GAAG,OAAO,CAAC,QAAQ,CAAC,uBAAuB,CAAC,cAAc,CAAC,CAAC;QACjF,iBAAiB,GAAG,OAAO,CAAC,YAAY,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC,EAAE,aAAa,EAAE,IAAI,CAAC,CAAC;QAClG,iBAAiB,CAAC,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO;YACnE,MAAM,aAAa,GAAuB,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC;YAEzE,IAAI,aAAa,CAAC,gBAAgB,EAAE,GAAG,CAAC,EAAE;gBACzC,MAAM,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;aAC9D;YACD,aAAa,GAAG,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YAE5C,IAAI,aAAa,CAAC,MAAM,EAAE;gBACnB,aAAa,CAAC,MAAO,CAAC,aAAa,GAAG,aAAa,CAAC;gBACpD,aAAa,CAAC,MAAO,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;aACvD;YAED,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,aAAa,kCAAO,OAAO,KAAE,aAAa,IAAG,CAAC;SAC3E,CAAC,CAAC;KACH;;;YAhGD,UAAU;;;YA7BF,kBAAkB;;;MCeL,aAAc,SAAQ,IAAI;IAU/C;QACC,KAAK,EAAE,CAAC;QAER,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;QAClB,IAAI,CAAC,QAAQ,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;KACnC;IAED,QAAQ;QACP,OAAO,GAAG,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,EAAE,GAAG,CAAC;KACtC;CACD;MAEY,WAAY,SAAQ,aAAa;IAG7C;QACC,KAAK,EAAE,CAAC;QAER,IAAI,CAAC,IAAI,GAAG;YACX,YAAY,EAAE,IAAI;SAClB,CAAC;QACF,IAAI,CAAC,EAAE,GAAG,WAAW,CAAC,EAAE,CAAC,QAAQ,EAAE,CAAC;QACpC,WAAW,CAAC,EAAE,IAAI,CAAC,CAAC;KACpB;;AAVgB,cAAE,GAAG,CAAC,CAAC;MAaZ,QAAS,SAAQ,aAAa;IAG1C;QACC,KAAK,EAAE,CAAC;QAER,IAAI,CAAC,IAAI,GAAG;YACX,YAAY,EAAE,IAAI;SAClB,CAAC;QACF,IAAI,CAAC,EAAE,GAAG,QAAQ,CAAC,EAAE,CAAC,QAAQ,EAAE,CAAC;QACjC,QAAQ,CAAC,EAAE,IAAI,CAAC,CAAC;KACjB;;AAVgB,WAAE,GAAG,CAAC,CAAC;AAazB,MAAM,YAAY,GAAG,CAAC,QAAQ,KAAK,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC;;SAQ7C,iBAAiB,CAAC,OAAO;IACxC,OAAO,OAAO,IAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC;AAC7D,CAAC;SAEe,MAAM,CAAC,IAAS;IAC/B,OAAO,IAAI,YAAY,IAAI,CAAC;AAC7B,CAAC;SAEe,eAAe,CAAC,IAAS;IACxC,OAAO,IAAI,YAAY,aAAa,CAAC;AACtC,CAAC;AAID,MAAM,UAAU,GAAG,IAAI,GAAG,EAA4D,CAAC;AACvF,MAAM,cAAc,GAAG,oBAAoB,CAAC;AAC5C,MAAM,eAAe,GAAkB,EAAE,YAAY,EAAE,KAAK,EAAE,CAAC;SAE/C,eAAe,CAAC,WAAmB,EAAE,QAAsB,EAAE,IAAoB;IAChG,MAAM,KAAK,GAAG,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;IACjC,UAAU,CAAC,GAAG,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;IACnC,UAAU,CAAC,GAAG,CAAC,WAAW,CAAC,WAAW,EAAE,EAAE,KAAK,CAAC,CAAC;IACjD,UAAU,CAAC,GAAG,CAAC,WAAW,CAAC,OAAO,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC,WAAW,EAAE,EAAE,KAAK,CAAC,CAAC;AACnF,CAAC;SAEe,YAAY,CAAC,WAAmB;IAC/C,MAAM,KAAK,GAAG,UAAU,CAAC,GAAG,CAAC,WAAW,CAAC,IAAI,UAAU,CAAC,GAAG,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,CAAC;IACvF,IAAI,CAAC,KAAK,EAAE;QACX,MAAM,IAAI,SAAS,CAAC,kCAAkC,WAAW,GAAG,CAAC,CAAC;KACtE;IAED,IAAI;QACH,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;KACxB;IAAC,OAAO,CAAC,EAAE;QACX,MAAM,IAAI,SAAS,CAAC,4BAA4B,WAAW,IAAI,CAAC,EAAE,CAAC,CAAC;KACpE;AACF,CAAC;SAEe,WAAW,CAAC,QAAgB;IAC3C,MAAM,KAAK,GAAG,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC;IACjF,OAAO,CAAC,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,eAAe,CAAC;AACjD,CAAC;SAEe,WAAW,CAAC,WAAmB;IAC9C,OAAO,UAAU,CAAC,GAAG,CAAC,WAAW,CAAC,IAAI,UAAU,CAAC,GAAG,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,CAAC;AACjF,CAAC;SAEe,sBAAsB,CAAC,KAAiB,EAAE,SAAiB;IAC1E,MAAM,WAAW,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,KAAK,EAAE,IAAI,YAAY,aAAa,CAAC,CAAC,CAAC;IAE7E,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE;QAC7B,MAAM,IAAI,KAAK,CAAC,4CAA4C,GAAG,kBAAkB,SAAS,EAAE,CAAC,CAAC;KAC9F;SAAM,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;QAClC,MAAM,IAAI,KAAK,CAAC,4CAA4C,GAAG,kBAAkB,SAAS,EAAE,CAAC,CAAC;KAC9F;IAED,MAAM,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;IAClC,IAAI,CAAC,UAAU,EAAE;QAChB,OAAO,sBAAsB,CAAC,UAAU,CAAC,QAAQ,EAAE,SAAS,GAAG,CAAC,CAAC,CAAC;KAClE;IAED,MAAM,YAAY,GAAG,UAAU,CAAC,MAAM,CAAC;IACvC,IAAI,YAAY,YAAY,UAAU,EAAE;QACvC,IAAI,IAAI,GAAG,UAAU,CAAC,UAAU,CAAC;QACjC,YAAY,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;QACrC,UAAU,CAAC,UAAU,GAAG,IAAI,CAAC;KAC7B;IAED,OAAO,UAAU,CAAC;AACnB,CAAC;WAGa,CAAC,MAAa,EAAE,KAAa,EAAE,IAAS;;IAEpD,IAAI,eAAe,CAAC,KAAK,CAAC,EAAE;QAC3B,OAAO;KACP;SAAM,IAAI,KAAK,YAAY,IAAI,EAAE;QACjC,MAAM,CAAC,QAAQ,CAAC,EAAE,MAAM,EAAE,MAAM,KAAK,EAAE,CAAC,CAAC;KACzC;SAAM;QACN,MAAM,IAAI,KAAK,CAAC,qCAAqC,CAAC,CAAC;KACvD;AACF,CAAC;AAVF,MAAM,SAAS,GAAkB;IAChC,WAAW,IASV;CACD,CAAC;AAEF;AACA;AACA,eAAe,CAAC,gBAAgB,EAAE,MAAM,cAAc,CAAC,CAAC;AACxD,eAAe,CAAC,mBAAmB,EAAE,MAAM,iBAAiB,CAAC,CAAC;AAC9D,eAAe,CAAC,kBAAkB,EAAE,MAAM,gBAAgB,CAAC,CAAC;AAC5D,eAAe,CAAC,QAAQ,EAAE,MAAM,MAAM,CAAC,CAAC;AACxC,eAAe,CAAC,aAAa,EAAE,MAAM,WAAW,CAAC,CAAC;AAClD,eAAe,CAAC,YAAY,EAAE,MAAM,UAAU,CAAC,CAAC;AAChD,eAAe,CAAC,YAAY,EAAE,MAAM,UAAU,CAAC,CAAC;AAChD,eAAe,CAAC,OAAO,EAAE,MAAW,KAAK,EAAE,SAAS,CAAC,CAAC;AACtD,eAAe,CAAC,YAAY,EAAE,MAAM,UAAU,CAAC,CAAC;AAChD,eAAe,CAAC,UAAU,EAAE,MAAM,QAAQ,CAAC,CAAC;AAC5C,eAAe,CAAC,OAAO,EAAE,MAAM,KAAK,CAAC,CAAC;AACtC;AACA,eAAe,CAAC,KAAK,EAAE,MAAM,KAAK,CAAC,CAAC;AACpC,eAAe,CAAC,OAAO,EAAE,MAAM,KAAK,CAAC,CAAC;AACtC,eAAe,CAAC,YAAY,EAAE,MAAM,UAAU,CAAC,CAAC;AAChD,eAAe,CAAC,UAAU,EAAE,MAAM,QAAQ,CAAC,CAAC;AAC5C,eAAe,CAAC,MAAM,EAAE,MAAM,IAAI,CAAC,CAAC;AACpC,eAAe,CAAC,aAAa,EAAE,MAAM,WAAW,CAAC,CAAC;AAClD,eAAe,CAAC,UAAU,EAAE,MAAM,QAAQ,CAAC,CAAC;AAC5C,eAAe,CAAC,oBAAoB,EAAE,MAAM,kBAAkB,CAAC,CAAC;AAChE,eAAe,CAAC,UAAU,EAAE,MAAM,QAAQ,CAAC,CAAC;AAC5C,eAAe,CAAC,YAAY,EAAE,MAAM,UAAU,CAAC,CAAC;AAChD,eAAe,CAAC,WAAW,EAAE,MAAM,SAAS,CAAC,CAAC;AAC9C,eAAe,CAAC,cAAc,EAAE,MAAM,YAAY,CAAC,CAAC;AACpD,eAAe,CAAC,kBAAkB,EAAE,MAAW,gBAAgB,CAAC,CAAC;AACjE,eAAe,CAAC,QAAQ,EAAE,MAAM,MAAM,CAAC,CAAC;AACxC,eAAe,CAAC,aAAa,EAAE,MAAM,WAAW,CAAC,CAAC;AAClD,eAAe,CAAC,eAAe,EAAE,MAAM,aAAa,CAAC,CAAC;AACtD,eAAe,CAAC,QAAQ,EAAE,MAAM,MAAM,CAAC,CAAC;AACxC,eAAe,CAAC,SAAS,EAAE,MAAM,OAAO,CAAC,CAAC;AAC1C,eAAe,CAAC,UAAU,EAAE,MAAM,QAAQ,CAAC,CAAC;AAC5C,eAAe,CAAC,cAAc,EAAE,MAAM,YAAY,CAAC,CAAC;AACpD,eAAe,CAAC,gBAAgB,EAAE,MAAM,cAAc,CAAC,CAAC;AACxD,eAAe,CAAC,MAAM,EAAE,MAAM,IAAI,CAAC,CAAC;AACpC,eAAe,CAAC,WAAW,EAAE,MAAM,SAAS,CAAC,CAAC;AAC9C,eAAe,CAAC,UAAU,EAAE,MAAM,QAAQ,CAAC,CAAC;AAC5C,eAAe,CAAC,YAAY,EAAE,MAAM,UAAU,CAAC,CAAC;AAChD,eAAe,CAAC,SAAS,EAAE,MAAM,OAAO,CAAC,CAAC;AAC1C,eAAe,CAAC,YAAY,EAAE,MAAM,UAAU,CAAC,CAAC;AAChD,eAAe,CAAC,iBAAiB,EAAE,MAAW,eAAe,CAAC,CAAC;AAC/D,eAAe,CAAC,MAAM,EAAE,MAAW,IAAI,CAAC,CAAC;AAEzC,eAAe,CAAC,mBAAmB,EAAE,MAAM,kBAAkB,EAAE;IAC9D,YAAY,EAAE,IAAI;CAClB,CAAC,CAAC;AAEH,eAAe,CAAC,oBAAoB,EAAE,MAAW,KAAK,CAAC;;AC1MvD,MAAM,OAAO,GAAG,YAAY,CAAC;MAEhB,WAAW;IACvB,YAAmB,SAAe,EAAS,IAAU,EAAS,KAAc,EAAS,IAAc,EAAS,GAAa;QAAtG,cAAS,GAAT,SAAS,CAAM;QAAS,SAAI,GAAJ,IAAI,CAAM;QAAS,UAAK,GAAL,KAAK,CAAS;QAAS,SAAI,GAAJ,IAAI,CAAU;QAAS,QAAG,GAAH,GAAG,CAAU;KAAI;CAC7H;MAUqB,uBAAuB;IAoC5C,YAAY,WAAuB,EAAU,gBAAiC;QAAjC,qBAAgB,GAAhB,gBAAgB,CAAiB;QA1B7D,kBAAa,GAAG,IAAI,YAAY,EAAqB,CAAC;QA2BtE,IAAI,CAAC,kBAAkB,GAAG,WAAW,CAAC,aAAa,CAAC;QAEpD,IAAI,CAAC,kBAAkB,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;KACpE;IAxBD,IACI,KAAK;QACR,OAAO,IAAI,CAAC,MAAM,CAAC;KACnB;IAED,IAAI,KAAK,CAAC,KAAU;QACnB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,UAAU,GAAG,IAAI,CAAC;QACtB,IAAI,KAAK,YAAY,eAAe,EAAE;YACrC,UAAU,GAAG,KAAK,CAAC;SACnB;QACD,IAAI,UAAU,IAAI,CAAC,IAAI,CAAC,OAAO,IAAIA,mBAAkB,CAAC,KAAK,CAAC,EAAE;YAC7D,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,IAAI;gBAC1E,OAAO,IAAI,CAAC;aACZ,CAAC,CAAC;SACH;QAED,IAAI,CAAC,kBAAkB,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;KAC5C;IAQD,kBAAkB;QACjB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,yCAAyC,CAAC,CAAC;SACzE;QAED,IAAI,CAAC,gBAAgB,EAAE,CAAC;KACxB;IAED,WAAW;QACV,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QACrE,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;QAE/B,IAAI,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;SAC1B;KACD;IAEO,gBAAgB;;;QAGvB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC;QAE3C,IAAI,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC;aACnD;YAED,MAAM,SAAS,GAAoB,EAAE,CAAC;YACtC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,KAAK;gBAC/B,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aACtB,CAAC,CAAC;YACH,IAAI,CAAC,kBAAkB,CAAC,aAAa,GAAG,SAAS,CAAC;SAClD;KACD;IAEM,gBAAgB,CAAC,GAAW,EAAE,QAAkC;QACtE,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,6BAA6B,GAAG,EAAE,CAAC,CAAC;SAClE;QAED,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACvB,IAAI,CAAC,YAAY,GAAG,IAAI,GAAG,EAAyB,CAAC;SACrD;QAED,MAAM,aAAa,GAAG;YACrB,GAAG;YACH,UAAU,EAAE,IAAI,CAAC,0BAA0B,CAAC,QAAQ,CAAC;SACrD,CAAC;QAEF,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,EAAE,aAAa,CAAC,CAAC;KAC1C;IAGM,aAAa,CAAC,IAAmB;QACvC,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACrC,OAAO;SACP;QAED,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,MAAM,KAAK,GAAS,IAAI,CAAC,MAAO,CAAC,KAAK,CAAC;QACvC,MAAM,WAAW,GAAG,OAAO,KAAK,CAAC,OAAO,KAAK,UAAU,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC;QAC9F,IAAI,OAAqC,CAAC;QAE1C,IAAI,IAAI,CAAC,IAAI,EAAE;YACd,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,WAAW,CAAC,kBAAkB,KAAK,0BAA0B,CAAC,CAAC;aACjF;YAED,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;;YAI7B,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,IAAI,YAAY,UAAU,IAAI,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,GAAG,CAAC,EAAE;gBACpF,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;aAC3C;YAED,IAAI,CAAC,OAAO,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACjD,iBAAiB,CAAC,aAAa,CAAC,oCAAoC,KAAK,iCAAiC,CAAC,CAAC;aAC5G;;YAGD,IAAI,CAAC,OAAO,EAAE;gBACb,OAAO;aACP;SACD;QAED,IAAI,CAAC,OAAO,EAAE;YACb,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,WAAW,CAAC,kBAAkB,KAAK,gCAAgC,CAAC,CAAC;aACvF;YAED,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,WAAW,EAAE,EAAE,CAAC,CAAC,CAAC;YAClF,IAAI,CAAC,IAAI,GAAG,eAAe,CAAC,OAAO,CAAC,CAAC;YACrC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC;SAC7B;QAED,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,WAAW,EAAE,KAAK,CAAC,CAAC;QAE/C,IAAI,CAAC,oBAAoB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;KAC1C;IAEM,YAAY,CAAC,OAAqC,EAAE,IAAS,EAAE,KAAa;QAClF,MAAM,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;QAChC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC;QACzB,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;QACpB,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC;QACtB,OAAO,CAAC,IAAI,GAAG,KAAK,GAAG,CAAC,KAAK,CAAC,CAAC;QAC/B,OAAO,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC;QAE5B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;KACvF;IAES,0BAA0B,CAAC,QAAkC;QACtE,OAAO;YACN,MAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,kBAAkB,CAAC,QAAQ,EAAE,IAAI,WAAW,EAAE,EAAE,CAAC,CAAC,CAAC;YAC/E,MAAM,UAAU,GAAG,eAAe,CAAC,OAAO,CAAC,CAAC;YAC5C,UAAU,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC;YAE9B,OAAO,UAAU,CAAC;SAClB,CAAC;KACF;IAGO,oBAAoB,CAAC,OAAqC,EAAE,KAAa;QAChF,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,qCAAqC,KAAK,EAAE,CAAC,CAAC;SAC5E;QAED,OAAO,CAAC,YAAY,EAAE,CAAC;QACvB,OAAO,CAAC,aAAa,EAAE,CAAC;KACxB;IAED,SAAS;QACR,IAAI,IAAI,CAAC,OAAO,EAAE;YACjB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,WAAW,CAAC,8BAA8B,CAAC,CAAC;aAC9D;YAED,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC/C,IAAI,OAAO,EAAE;gBACZ,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;oBACrC,iBAAiB,CAAC,WAAW,CAAC,uBAAuB,CAAC,CAAC;iBACvD;gBAED,IAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE,CAAC;aAClC;SACD;KACD;;;YA9LD,SAAS;;;YAnBmD,UAAU;YAAsF,eAAe;;;qBA4B1K,SAAS,SAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,gBAAgB,EAAE,MAAM,EAAE,KAAK,EAAE;4BAE7D,MAAM;gCAEN,YAAY,SAAC,WAAW,EAAE,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM,EAAE,KAAK,EAAE;oBAI9D,KAAK;;AA+EN;IADC,OAAO;4DA+CP;AAwBD;IADC,OAAO;mEAQP;SA2Bc,eAAe,CAAC,OAAsB,EAAE,cAA2B,sBAAsB;IACxG,MAAM,QAAQ,GAAG,WAAW,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;IACnD,OAAO,QAAQ,CAAC;AACjB,CAAC;MAEY,yBAAyB,GAAG,IAAI,cAAc,CAA0B,yBAAyB,EAAE;MAGnG,oBAAoB;IAChC,YAAoB,WAA6B,EAAqD,IAA6B;QAA/G,gBAAW,GAAX,WAAW,CAAkB;QAAqD,SAAI,GAAJ,IAAI,CAAyB;KAAI;IAEvI,IACI,aAAa,CAAC,KAAU;QAC3B,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,WAAW,EAAE;YAClC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACpD;KACD;;;YATD,SAAS,SAAC,EAAE,QAAQ,EAAE,iBAAiB,EAAE;;;YAlOuJ,WAAW;YAoO/F,uBAAuB,uBAA/E,MAAM,SAAC,yBAAyB,cAAG,IAAI;;;4BAE1F,KAAK;;;MC1NM,iBAAkB,SAAQ,uBAAuB;IAO7D,YAAY,WAAuB,EAAE,gBAAiC;QACrE,KAAK,CAAC,WAAW,EAAE,gBAAgB,CAAC,CAAC;KACrC;IARD,IAAW,aAAa;QACvB,OAAO,IAAI,CAAC,kBAAkB,CAAC;KAC/B;;;YAXD,SAAS,SAAC;gBACV,QAAQ,EAAE,UAAU;gBACpB,QAAQ,EAAE;;sBAEW;gBACrB,eAAe,EAAE,uBAAuB,CAAC,MAAM;gBAC/C,SAAS,EAAE,CAAC,EAAE,OAAO,EAAE,yBAAyB,EAAE,WAAW,EAAE,UAAU,CAAC,MAAM,iBAAiB,CAAC,EAAE,CAAC;aACrG;;;YAX4C,UAAU;YAAE,eAAe;;;MCiB3D,gBAAgB;IAiB5B,YAAY,OAAmB;QAC9B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,aAAa,CAAC;KACrC;IAdD,IACI,aAAa;QAChB,OAAO,IAAI,CAAC,cAAc,CAAC;KAC3B;IAED,IAAI,aAAa,CAAC,KAAK;QACtB,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAC5B,IAAI,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,OAAO,CAAC,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC;SACjD;KACD;IAMD,eAAe;QACd,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;QAC5B,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,uBAAuB,GAAG,IAAI,CAAC,cAAc,CAAC,CAAC;SAC7E;QACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE;YAClC,IAAI,CAAC,OAAO,CAAC,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC;SACjD;KACD;;;YAhCD,SAAS,SAAC;gBACV,QAAQ,EAAE,SAAS;aACnB;;;YAhBkC,UAAU;;;4BAsB3C,KAAK;;MA8BM,oBAAoB;IAIhC,YAAoB,KAAuB,EAAU,WAA6B,EAAU,aAA+B;QAAvG,UAAK,GAAL,KAAK,CAAkB;QAAU,gBAAW,GAAX,WAAW,CAAkB;QAAU,kBAAa,GAAb,aAAa,CAAkB;KAAI;IAE/H,IACI,MAAM,CAAC,MAAsB;QAChC,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,KAAK,MAAM,CAAC,UAAU,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,KAAK,MAAM,CAAC,KAAK,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,KAAK,MAAM,CAAC,aAAa,EAAE;YACjK,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;YACtB,IAAI,CAAC,WAAW,EAAE,CAAC;SACnB;KACD;IAED,IAAI,MAAM;;QAET,OAAO,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;KAC1B;IAED,IACI,KAAK,CAAC,KAAa;QACtB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,KAAK,EAAE,CAAC,CAAC;KACpD;IAED,IAAI,KAAK;QACR,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;KACzB;IAED,IACI,UAAU,CAAC,UAAkB;QAChC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,UAAU,EAAE,CAAC,CAAC;KACzD;IAED,IAAI,UAAU;QACb,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC;KAC9B;IAED,IACI,aAAa,CAAC,aAA4B;QAC7C,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,aAAa,EAAE,CAAC,CAAC;KAC5D;IAED,IAAI,aAAa;QAChB,OAAO,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC;KACjC;IAEO,UAAU;QACjB,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YACf,IAAI,CAAC,IAAI,GAAG,IAAI,WAAW,EAAE,CAAC;SAC9B;KACD;IAEO,WAAW;QAClB,IAAI,CAAC,UAAU,EAAE,CAAC;QAElB,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;YACtB,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;SACpC;QAED,IAAI,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE;YAC3B,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC;SAC9C;;;QAID,IAAI,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE;YAC9B,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC;SACpD;KACD;IAED,QAAQ;QACP,IAAI,CAAC,WAAW,EAAE,CAAC;QAEnB,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;;QAExE,MAAM,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,IAAI,KAAK,EAAE,IAAI,YAAY,aAAa,CAAC,CAAC,CAAC;QAEvF,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;YACzB,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;YAE9B,MAAM,QAAQ,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,IAAI,EAAE,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YACtE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,GAAG,QAAQ,CAAC;SACpC;KACD;;;YAtFD,SAAS,SAAC;gBACV,QAAQ,EAAE,WAAW;aACrB;;;YAK2B,gBAAgB;YAxDkB,WAAW;YAAE,gBAAgB;;;qBA0DzF,KAAK,SAAC,SAAS;oBAaf,KAAK;yBASL,KAAK;4BASL,KAAK;;;SCnFS,YAAY,CAAC,IAAS;IACrC,OAAO,IAAI,YAAY,UAAU,CAAC;AACnC,CAAC;SAEe,kBAAkB,CAAC,IAAS;IAC3C,OAAO,IAAI,YAAY,gBAAgB,CAAC;AACzC,CAAC;aAMa,CAAC,MAAmB,EAAE,KAAa,EAAE,IAAS;IAC1D,IAAI,eAAe,CAAC,KAAK,CAAC,EAAE;QAC3B,OAAO;KACP;SAAM,IAAI,kBAAkB,CAAC,KAAK,CAAC,EAAE;QACrC,MAAM,CAAC,gBAAgB,GAAG,KAAK,CAAC;QAChC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;KAC1B;SAAM,IAAI,YAAY,CAAC,KAAK,CAAC,EAAE;QAC/B,aAAa,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;QACnC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;KAC1B;SAAM,IAAI,MAAM,CAAC,KAAK,CAAC,EAAE;QACzB,MAAM,CAAC,SAAS,GAAG,KAAK,CAAC;KACzB;AACF,CAAC,SACY,CAAC,MAAmB,EAAE,KAAa;IAC/C,IAAI,eAAe,CAAC,KAAK,CAAC,EAAE;QAC3B,OAAO;KACP;SAAM,IAAI,kBAAkB,CAAC,KAAK,CAAC,EAAE;QACrC,IAAI,MAAM,CAAC,gBAAgB,KAAK,KAAK,EAAE;YACtC,MAAM,CAAC,gBAAgB,GAAG,IAAI,CAAC;SAC/B;QAED,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;KACxB;SAAM,IAAI,YAAY,CAAC,KAAK,CAAC,EAAE;QAC/B,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;QACrC,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;KACxB;SAAM,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,MAAM,CAAC,SAAS,IAAI,MAAM,CAAC,SAAS,KAAK,KAAK,EAAE;QAC3E,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC;KACxB;AACF,CAAC;AA9BF,MAAM,aAAa,GAAkB;IACpC,YAAY,EAAE,IAAI;IAClB,WAAW,MAYV;IACD,WAAW,MAeV;CACD,CAAC;AAEF,MAAM,aAAa,GAAG,CAAC,GAAgB,EAAE,IAAgB,EAAE,IAAgB;IAC1E,IAAI,IAAI,EAAE;QACT,sBAAsB,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;KACxC;SAAM;QACN,gBAAgB,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;KAC5B;AACF,CAAC,CAAC;;AAEF,MAAM,sBAAsB,GAAG,CAAC,GAAgB,EAAE,IAAgB,EAAE,IAAgB;IACnF,MAAM,WAAW,GAAgB,GAAG,CAAC,WAAW,CAAC;IACjD,MAAM,qBAAqB,GAAiB,WAAW,CAAC,QAAQ,EAAE,CAAC;IAEnE,MAAM,aAAa,GAAG,qBAAqB,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAC1D,qBAAqB,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;IAE/C,WAAY,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAAC;AACpD,CAAC,CAAC;;AAEF,MAAM,gBAAgB,GAAG,CAAC,GAAgB,EAAE,IAAgB;IAC3D,GAAG,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;AAC/B,CAAC,CAAC;;AAEF,eAAe,CAAC,WAAW,EAAE,MAAM,SAAS,EAAE,aAAa,CAAC,CAAC;AAC7D,eAAe,CAAC,YAAY,EAAE,MAAW,UAAU,CAAC,CAAC;AACrD,eAAe,CAAC,kBAAkB,EAAE,MAAW,gBAAgB,CAAC,CAAC;MAMpD,kBAAkB;IAC9B,YAAmB,OAAmB,EAAU,IAAU;QAAvC,YAAO,GAAP,OAAO,CAAY;QAAU,SAAI,GAAJ,IAAI,CAAM;QACzD,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YACf,MAAM,IAAI,KAAK,CAAC,oDAAoD,CAAC,CAAC;SACtE;QAED,IAAI,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,EAAE;YACvC,IAAI,CAAC,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;SAClC;QACD,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC;QACjD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC;KAC7B;;;YAfD,SAAS,SAAC;gBACV,QAAQ,EAAE,WAAW;gBACrB,QAAQ,EAAE,2BAA2B;aACrC;;;YA9E8B,UAAU;YACsB,IAAI;;MAgGtD,cAAc;;IAE1B,YAAoB,IAAU;QAAV,SAAI,GAAJ,IAAI,CAAM;QAC7B,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YACf,MAAM,IAAI,KAAK,CAAC,gDAAgD,CAAC,CAAC;SAClE;KACD;IAEM,eAAe,CAAC,MAAiC;QACvD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,gBAAgB,GAAG,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC;KACpE;IAEM,kBAAkB,CAAC,MAAiC;QAC1D,MAAM,GAAG,GAAqB,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC;QAC3D,IAAI,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,gBAAgB,KAAK,GAAG,EAAE;YACxD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,gBAAgB,GAAG,IAAI,CAAC;SAC5C;KACD;IAEM,YAAY,CAAC,IAAyB;QAC5C,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;KACpE;IAEM,eAAe,CAAC,IAAyB;QAC/C,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,EAAE;YACzC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;SACvE;KACD;;;YA/BD,SAAS,SAAC;gBACV,QAAQ,EAAE,oBAAoB;gBAC9B,QAAQ,EAAE,EAAE;aACZ;;;YA/F8D,IAAI;;MAiItD,mBAAmB;IAC/B,YAAmB,OAAmB,EAAsB,UAA0B;QAAnE,YAAO,GAAP,OAAO,CAAY;QAAsB,eAAU,GAAV,UAAU,CAAgB;QACrF,IAAI,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;SACnC;KACD;IAED,WAAW;QACV,IAAI,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;SACtC;KACD;;;YAdD,SAAS,SAAC;gBACV,QAAQ,EAAE,YAAY;aACtB;;;YAjI8B,UAAU;YAmIgC,cAAc,uBAA7C,QAAQ;;MAgBrC,yBAAyB;IACrC,YAAmB,OAAmB,EAAsB,UAA0B;QAAnE,YAAO,GAAP,OAAO,CAAY;QAAsB,eAAU,GAAV,UAAU,CAAgB;QACrF,IAAI,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;SACtC;KACD;IAED,WAAW;QACV,IAAI,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC;SACzC;KACD;;;YAdD,SAAS,SAAC;gBACV,QAAQ,EAAE,kBAAkB;aAC5B;;;YAlJ8B,UAAU;YAoJgC,cAAc,uBAA7C,QAAQ;;;MC7IrC,sBAAsB;IAElC;QACC,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC;KACtB;;;YARD,SAAS,SAAC;gBACV,QAAQ,EAAE,SAAS;gBACnB,QAAQ,EAAE,wCAAwC;aAClD;;;MAYY,kBAAkB;IAE9B;QACC,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;KAClB;;;YARD,SAAS,SAAC;gBACV,QAAQ,EAAE,KAAK;gBACf,QAAQ,EAAE,wCAAwC;aAClD;;;;MCVY,aAAa,GAAG,CAAC,iBAAiB,EAAE,oBAAoB,EAAE,gBAAgB,EAAE,oBAAoB,EAAE,kBAAkB,EAAE,cAAc,EAAE,mBAAmB,EAAE,yBAAyB,EAAE,sBAAsB,EAAE,kBAAkB;;MCWhO,wBAAwB;;;YAPpC,QAAQ,SAAC;gBACT,YAAY,EAAE,CAAC,iBAAiB,EAAE,oBAAoB,EAAE,gBAAgB,EAAE,oBAAoB,EAAE,kBAAkB,EAAE,cAAc,EAAE,mBAAmB,EAAE,yBAAyB,EAAE,sBAAsB,EAAE,kBAAkB,CAAC;gBAC/N,SAAS,EAAE,CAAC,kBAAkB,EAAE,qBAAqB,EAAE,oBAAoB,EAAE,mBAAmB,CAAC;gBACjG,OAAO,EAAE,CAAC,YAAY,CAAC;gBACvB,OAAO,EAAE,CAAC,YAAY,EAAE,iBAAiB,EAAE,oBAAoB,EAAE,gBAAgB,EAAE,oBAAoB,EAAE,kBAAkB,EAAE,cAAc,EAAE,mBAAmB,EAAE,yBAAyB,EAAE,sBAAsB,EAAE,kBAAkB,CAAC;gBACxO,OAAO,EAAE,CAAC,gBAAgB,CAAC;aAC3B;;;ACZD,MAAM,iBAAiB,GAAG,CAAC,CAAC;AAC5B,MAAM,cAAc,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,gBAAgB,CAAC,CAAC,CAAC;AACrF,MAAM,kBAAkB,GAAG,KAAK,CAAC;SASjB,QAAQ,CAAC,IAAS;IACjC,OAAO,IAAI,YAAY,UAAU,CAAC;AACnC,CAAC;SAEe,aAAa,CAAC,IAAS;IACtC,OAAO,IAAI,YAAY,WAAW,CAAC;AACpC,CAAC;AAED,MAAM,YAAY,GAAuC,IAAI,GAAG,EAAiC,CAAC;MAErF,QAAQ;IAIpB,YAAY,MAAqB;QAChC,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,EAAE,KAAK,aAAa,CAAC,GAAG,CAAC;QAC7C,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,EAAE,KAAK,aAAa,CAAC,OAAO,CAAC;KACrD;IAEM,WAAW,CAAC,MAAY,EAAE,KAAW,EAAE,QAAiB,EAAE,IAAa;QAC7E,IAAI,CAAC,MAAM,EAAE;YACZ,OAAO;SACP;QAED,MAAM,cAAc,GAAG,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC;QAC3D,MAAM,aAAa,GAAG,IAAI,CAAC,sBAAsB,CAAC,KAAK,CAAC,CAAC;QAEzD,IAAI,CAAC,QAAQ,EAAE;YACd,QAAQ,GAAG,cAAc,CAAC,SAAS,CAAC;SACpC;QACD,IAAI,CAAC,UAAU,CAAC,cAAc,EAAE,aAAa,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;QAE/D,IAAI,eAAe,CAAC,KAAK,CAAC,EAAE;YAC3B,aAAa,CAAC,UAAU,GAAG,cAAc,CAAC;SAC1C;QAED,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,EAAE;YAC9B,MAAM,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;YAC7C,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,aAAa,EAAE,UAAU,CAAC,CAAC;SAChE;KACD;IAEO,UAAU,CAAC,MAAc,EAAE,KAAa,EAAE,QAAgB,EAAE,IAAY;QAC/E,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,+BAA+B,MAAM,WAAW,KAAK,IAAI,GAAG,aAAa,QAAQ,WAAW,IAAI,EAAE,CAAC,CAAC;SAClI;QAED,IAAI,QAAQ,EAAE;YACb,QAAQ,CAAC,WAAW,GAAG,KAAK,CAAC;SAC7B;aAAM;YACN,MAAM,CAAC,UAAU,GAAG,KAAK,CAAC;SAC1B;QAED,IAAI,IAAI,EAAE;YACT,KAAK,CAAC,WAAW,GAAG,IAAI,CAAC;SACzB;aAAM;YACN,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;SAClC;KACD;IAEO,aAAa,CAAC,MAAc,EAAE,IAAY;QACjD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,kCAAkC,MAAM,UAAU,IAAI,EAAE,CAAC,CAAC;SACxF;QAED,IAAI,MAAM,CAAC,SAAS,EAAE;YACrB,MAAM,CAAC,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC;SACpC;QAED,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC;KACxB;IAEO,eAAe,CAAC,MAAc,EAAE,KAAa,EAAE,IAAY;QAClE,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,oCAAoC,MAAM,WAAW,KAAK,WAAW,IAAI,EAAE,CAAC,CAAC;SAC3G;QAED,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE;YAC3C,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;SAC7C;aAAM,IAAI,QAAQ,CAAC,MAAM,CAAC,EAAE;YAC5B,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;SACzC;aAAM,IAAI,aAAa,CAAC,MAAM,CAAC,EAAE;YACjC,MAAM,CAAC,OAAO,GAAG,KAAK,CAAC;SACvB;aAAM,IAAI,MAAM,IAAU,MAAO,CAAC,oBAAoB,EAAE;YAClD,MAAO,CAAC,oBAAoB,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;SAC1D;KACD;IAEO,cAAc,CAAC,MAAoB,EAAE,KAAa,EAAE,IAAY;QACvE,IAAI,KAAK,CAAC,MAAM,KAAK,MAAM,EAAE;YAC5B,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;SACtC;QAED,MAAM,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QAC7C,IAAI,UAAU,EAAE;YACf,MAAM,KAAK,GAAG,MAAM,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;YAC/C,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;SACjC;aAAM;YACN,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;SACvB;KACD;IAEO,cAAc,CAAC,IAAY;QAClC,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,OAAO,IAAI,IAAI,iBAAiB,CAAC,IAAI,CAAC,EAAE;YACvC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC;SACxB;QAED,OAAO,IAAI,CAAC;KACZ;IAEM,WAAW,CAAC,MAAY,EAAE,KAAW;QAC3C,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,gCAAgC,MAAM,WAAW,KAAK,EAAE,CAAC,CAAC;SACxF;QAED,IAAI,CAAC,MAAM,EAAE;YACZ,OAAO;SACP;QAED,MAAM,cAAc,GAAG,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC;QAC3D,MAAM,aAAa,GAAG,IAAI,CAAC,sBAAsB,CAAC,KAAK,CAAC,CAAC;QAEzD,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,aAAa,CAAC,CAAC;QACpD,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,EAAE;YACtC,IAAI,CAAC,oBAAoB,CAAC,cAAc,EAAE,aAAa,CAAC,CAAC;SACzD;KACD;IAEO,eAAe,CAAC,MAAc,EAAE,KAAa;QACpD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,oCAAoC,MAAM,WAAW,KAAK,EAAE,CAAC,CAAC;SAC5F;QAED,IAAI,MAAM,CAAC,UAAU,KAAK,KAAK,IAAI,MAAM,CAAC,SAAS,KAAK,KAAK,EAAE;YAC9D,MAAM,CAAC,UAAU,GAAG,IAAI,CAAC;YACzB,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC;YACxB,KAAK,CAAC,WAAW,GAAG,IAAI,CAAC;YACzB,OAAO;SACP;QAED,IAAI,MAAM,CAAC,UAAU,KAAK,KAAK,EAAE;YAChC,MAAM,CAAC,UAAU,GAAG,KAAK,CAAC,WAAW,CAAC;SACtC;QAED,MAAM,QAAQ,GAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;QACzD,IAAI,MAAM,CAAC,SAAS,KAAK,KAAK,EAAE;YAC/B,MAAM,CAAC,SAAS,GAAG,QAAQ,CAAC;SAC5B;QAED,IAAI,QAAQ,EAAE;YACb,QAAQ,CAAC,WAAW,GAAG,KAAK,CAAC,WAAW,CAAC;SACzC;QAED,KAAK,CAAC,WAAW,GAAG,IAAI,CAAC;KACzB;;IAGO,mBAAmB,CAAC,MAAc,EAAE,KAAa;QACxD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,wCAAwC,MAAM,WAAW,KAAK,EAAE,CAAC,CAAC;SAChG;QAED,IAAI,cAAc,CAAC;QACnB,IAAI,QAAQ,CAAC,MAAM,CAAC,EAAE;YACrB,cAAc,GAAG,IAAI,CAAC,wBAAwB,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;SAC9D;QAED,IAAI,QAAQ,GAAG,cAAc,IAAI,MAAM,CAAC,UAAU,CAAC;;;;QAKnD,OAAO,QAAQ,IAAI,QAAQ,KAAK,KAAK,IAAI,QAAQ,CAAC,WAAW,KAAK,KAAK,EAAE;YACxE,QAAQ,GAAG,QAAQ,CAAC,WAAW,CAAC;SAChC;QAED,OAAO,QAAQ,CAAC;KAChB;IAEO,wBAAwB,CAAC,MAAoB,EAAE,KAAa;QACnE,MAAM,YAAY,GAAG,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAEjD,IAAI,YAAY,GAAG,CAAC,EAAE;YACrB,OAAO,MAAM,CAAC,UAAU,CAAC,YAAY,GAAG,CAAC,CAAW,CAAC;SACrD;KACD;;IAGM,aAAa,CAAC,MAAW,EAAE,KAAa;QAC9C,IAAI,QAAQ,CAAC,MAAM,CAAC,EAAE;YACrB,OAAO,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;SACnC;aAAM,IAAI,aAAa,CAAC,MAAM,CAAC,EAAE;YACjC,OAAO,KAAK,KAAK,MAAM,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;SACzC;KACD;IAEO,oBAAoB,CAAC,MAAc,EAAE,KAAa;QACzD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,yCAAyC,MAAM,WAAW,KAAK,EAAE,CAAC,CAAC;SACjG;QAED,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE;YAC3C,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;SACvC;aAAM,IAAI,QAAQ,CAAC,MAAM,CAAC,EAAE;YAC5B,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;SACtC;aAAM,IAAI,aAAa,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC,OAAO,KAAK,KAAK,EAAE;YAC7D,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC;SACtB;aAAM,IAAI,MAAM,CAAC,MAAM,CAAC,EAAE;YAC1B,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;SAC1B;KACD;IAEO,iBAAiB,CAAC,MAAoB,EAAE,KAAa;QAC5D,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,sCAAsC,MAAM,WAAW,KAAK,EAAE,CAAC,CAAC;SAC9F;QAED,MAAM,KAAK,GAAG,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAE1C,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;YACjB,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;SAC1B;KACD;IAEM,aAAa;QACnB,OAAO,IAAI,WAAW,EAAE,CAAC;KACzB;IAEM,UAAU;QAChB,OAAO,IAAI,QAAQ,EAAE,CAAC;KACtB;IAEM,UAAU,CAAC,IAAY;QAC7B,MAAM,YAAY,GAAG,IAAI,CAAC;QAC1B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE;YACvB,IAAI,GAAG,oBAAoB,CAAC;SAC5B;QAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,kBAAkB,YAAY,IAAI,IAAI,EAAE,CAAC,CAAC;SACxE;QAED,MAAM,SAAS,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;QACrC,MAAM,IAAI,GAAW,IAAI,SAAS,EAAE,CAAC;QACrC,MAAM,MAAM,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAEpD,OAAO,MAAM,CAAC;KACd;IAEO,sBAAsB,CAAC,IAAU;QACxC,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;YAChC,OAAO,IAAc,CAAC;SACtB;aAAM;YACN,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC;YAC1B,MAAM,MAAM,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;YAEpD,OAAO,MAAM,CAAC;SACd;KACD;IAEO,mBAAmB,CAAC,IAAU,EAAE,IAAY;QACnD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,4BAA4B,IAAI,WAAW,IAAI,GAAG,CAAC,CAAC;SAClF;QAED,MAAM,MAAM,GAAG,IAAc,CAAC;QAC9B,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC;QACvB,MAAM,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC;;;;QAKhC,MAAM,CAAC,QAAQ,GAAG,iBAAiB,CAAC;QAEpC,OAAO,MAAM,CAAC;KACd;IAEM,WAAW,CAAC,IAAY,EAAE,aAAqB,EAAE,KAAU,EAAE,SAAkB;QACrF,IAAI,CAAC,IAAI,KAAK,SAAS,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE;YACpD,OAAO;SACP;QAED,IAAI,aAAa,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;;YAEtC,MAAM,UAAU,GAAG,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC5C,aAAa,GAAG,UAAU,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAElD,IAAI,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;YACvC,IAAI,CAAC,GAAG,CAAC,CAAC;YACV,OAAO,CAAC,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;gBAChE,IAAI,IAAI,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;gBACzB,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;oBACtB,IAAI,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;iBACzB;gBAED,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;gBAClB,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;gBACnC,CAAC,EAAE,CAAC;aACJ;SACD;QAED,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;YAChC,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,aAAa,EAAE,KAAK,CAAC,CAAC;SACrD;KACD;IAEO,MAAM,CAAC,QAAgB;QAC9B,OAAO,CAAC,QAAQ,KAAK,KAAK,IAAI,IAAI,CAAC,KAAK,MAAM,QAAQ,KAAK,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC;KACxF;IAEO,mBAAmB,CAAC,IAAY,EAAE,aAAqB,EAAE,KAAU;QAC1E,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,sBAAsB,aAAa,IAAI,KAAK,OAAO,IAAI,EAAE,CAAC,CAAC;SACzF;QAED,IAAI,aAAa,KAAK,OAAO,EAAE;YAC9B,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;YAC7B,OAAO;SACP;QAED,IAAI,cAAc,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,EAAE;YACjD,IAAI,CAAC,aAAa,CAAC,GAAG,KAAK,CAAC;YAC5B,OAAO;SACP;QAED,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QACzC,MAAM,YAAY,GAAG,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;;QAGhD,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YACzB,IAAI,CAAC,+BAA+B,CAAC,KAAK,CAAC,CAAC;SAC5C;QAED,IAAI,YAAY,EAAE;;YAEjB,IAAI,CAAC,YAAY,CAAC,GAAG,KAAK,CAAC;YAC3B,OAAO;SACP;;QAGD,IAAI,CAAC,aAAa,CAAC,GAAG,KAAK,CAAC;KAC5B;IAEO,+BAA+B,CAAC,KAAY;QACnD,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE;YACzB,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,UAAU,EAAE;gBACnC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;oBACrC,iBAAiB,CAAC,WAAW,CAAC,sBAAsB,IAAI,CAAC,UAAU,cAAc,IAAI,EAAE,CAAC,CAAC;iBACzF;gBACD,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC;gBACxB,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;aAC5B;SACD;KACD;IAEO,aAAa,CAAC,QAAa;QAClC,MAAM,IAAI,GAAG,QAAQ,IAAI,QAAQ,CAAC,WAAW,CAAC;QAC9C,IAAI,CAAC,IAAI,EAAE;YACV,OAAO,IAAI,GAAG,EAAkB,CAAC;SACjC;QAED,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;YAC5B,IAAI,OAAO,GAAG,IAAI,GAAG,EAAkB,CAAC;YACxC,KAAK,IAAI,QAAQ,IAAI,QAAQ,EAAE;;gBAE9B,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,WAAW,EAAE,EAAE,QAAQ,CAAC,CAAC;aAC9C;YACD,YAAY,CAAC,GAAG,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;SAChC;QAED,OAAO,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;KAC9B;IAEO,UAAU,CAAC,IAAY;QAC9B,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACvB,IAAI,CAAC,YAAY,GAAG,IAAI,GAAG,EAAmB,CAAC;SAC/C;QACD,OAAO,IAAI,CAAC,YAAY,CAAC;KACzB;IAEM,QAAQ,CAAC,IAAY,EAAE,SAAiB;QAC9C,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QAC3C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;KACvB;IAEM,WAAW,CAAC,IAAY,EAAE,SAAiB;QACjD,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QACxC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;KACvB;IAEO,UAAU,CAAC,IAAY,EAAE,YAAoB;QACpD,IAAI,OAAO,GAAG,YAAY,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;QACrD,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,CAAC;QAC9B,OAAO,CAAC,OAAO,CAAC,CAAC,SAAS,KAAK,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC,CAAC;QAC3E,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;KACvB;IAEO,WAAW,CAAC,IAAY;QAC/B,IAAI,UAAU,GAAS,KAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC3E,IAAI,CAAC,SAAS,GAAG,UAAU,CAAC;KAC5B;IAEM,QAAQ,CAAC,IAAY,EAAE,SAAiB,EAAE,KAAU;QAC1D,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,KAAK,CAAC;KAC9B;IAEM,WAAW,CAAC,IAAY,EAAE,SAAiB;QACjD,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,UAAU,CAAC;KACnC;;;MC3ZW,oBAAqB,SAAQ,SAAS;IAGlD,YAAoB,QAAgB,EAAU,IAAY,EAAU,QAAkB;QACrF,KAAK,EAAE,CAAC;QADW,aAAQ,GAAR,QAAQ,CAAQ;QAAU,SAAI,GAAJ,IAAI,CAAQ;QAAU,aAAQ,GAAR,QAAQ,CAAU;QAFtF,SAAI,GAA2B,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAIlD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,8BAA8B,CAAC,CAAC;SAC9D;KACD;IAGD,WAAW,CAAC,MAAc,EAAE,QAAgB;QAC3C,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,2CAA2C,QAAQ,YAAY,MAAM,EAAE,CAAC,CAAC;SACvG;QACD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;KAC5C;IAGD,YAAY,CAAC,MAAc,EAAE,QAAgB,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAoB;QAClF,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,4CAA4C,QAAQ,GAAG,GAAG,WAAW,MAAM,cAAc,QAAQ,UAAU,IAAI,EAAE,CAAC,CAAC;SACjJ;QACD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;KAC5D;IAGD,WAAW,CAAC,MAAW,EAAE,QAAgB;QACxC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,2CAA2C,QAAQ,YAAY,MAAM,EAAE,CAAC,CAAC;SACvG;QACD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;KAC5C;IAGD,iBAAiB,CAAC,QAAgB;QACjC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,2CAA2C,QAAQ,EAAE,CAAC,CAAC;SACrF;QACD,IAAI,QAAQ,IAAI,QAAQ,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;YACpC,MAAM,MAAM,GAAG,WAAW,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YAC7D,QAAQ,MAAM,IAAI,IAAI,CAAC,QAAQ,EAAY;SAC3C;QACD,OAAO,IAAI,CAAC,QAAQ,CAAC;KACrB;IAGD,UAAU,CAAC,IAAY;QACtB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,6CAA6C,IAAI,OAAO,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC;SACzG;QACD,OAAO,IAAI,CAAC,UAAU,CAAC;KACvB;IAGD,WAAW,CAAC,IAAY;QACvB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,uCAAuC,IAAI,OAAO,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;SACpG;QAED,OAAO;YACN,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,IAAI,CAAC,WAAW;SACtB,CAAC;KACF;IAGD,aAAa,CAAC,MAAW;QACxB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,sCAAsC,MAAM,EAAE,CAAC,CAAC;SAC9E;QACD,OAAO,IAAI,CAAC,QAAQ,CAAC,aAAa,EAAE,CAAC;KACrC;IAGD,aAAa,CAAC,IAAS,EAAE,UAAkB;QAC1C,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,uCAAuC,IAAI,EAAE,CAAC,CAAC;SAC7E;QACD,OAAO,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;KACtC;IAGD,UAAU,CAAC,MAAc;QACxB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,mCAAmC,MAAM,EAAE,CAAC,CAAC;SAC3E;QACD,OAAO,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;KAClC;IAGD,cAAc,CAAC,WAAmB;QACjC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,uCAAuC,WAAW,CAAC,QAAQ,EAAE,CAAC,CAAC;SAC7F;QACD,OAAO,WAAW,CAAC;KACnB;IAGD,YAAY,CAAC,aAAqB,EAAE,KAAe;QAClD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,mCAAmC,CAAC,CAAC;SACnE;QACD,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC;KACxE;IAGD,OAAO;QACN,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,8BAA8B,CAAC,CAAC;SAC9D;;;KAGD;IAGD,YAAY,CAAC,IAAY,EAAE,IAAY,EAAE,KAAa,EAAE,SAAkB;QACzE,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,qCAAqC,IAAI,MAAM,IAAI,MAAM,KAAK,gBAAgB,SAAS,EAAE,CAAC,CAAC;SACzH;QACD,OAAO,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;KAC/D;IAGD,eAAe,CAAC,GAAW,EAAE,KAAa;QACzC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,wCAAwC,GAAG,KAAK,KAAK,EAAE,CAAC,CAAC;SACvF;KACD;IAGD,WAAW,CAAC,IAAS,EAAE,IAAY,EAAE,KAAU;QAC9C,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,oCAAoC,IAAI,MAAM,IAAI,MAAM,KAAK,EAAE,CAAC,CAAC;SAC/F;QACD,OAAO,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;KACpD;IAGD,QAAQ,CAAC,IAAY,EAAE,IAAY;QAClC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,iCAAiC,IAAI,EAAE,CAAC,CAAC;SACvE;QACD,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KACnC;IAGD,WAAW,CAAC,IAAY,EAAE,IAAY;QACrC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,oCAAoC,IAAI,EAAE,CAAC,CAAC;SAC1E;QACD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KACtC;IAGD,QAAQ,CAAC,IAAY,EAAE,SAAiB,EAAE,KAAU,EAAE,MAA4B;QACjF,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,kCAAkC,SAAS,MAAM,KAAK,EAAE,CAAC,CAAC;SACxF;QACD,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;KAC/C;IAGD,WAAW,CAAC,IAAY,EAAE,SAAiB,EAAE,MAA4B;QACxE,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,gDAAgD,CAAC,CAAC;SAChF;QACD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;KAC3C;;;IAKD,mBAAmB,CAAC,aAAqB,EAAE,YAAoB,EAAE,aAAqB;QACrF,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,6CAA6C,aAAa,KAAK,YAAY,MAAM,aAAa,EAAE,CAAC,CAAC;SAChI;KACD;IAGD,mBAAmB,CAAC,aAAkB,EAAE,KAAU;QACjD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,6CAA6C,aAAa,EAAE,CAAC,CAAC;SAC5F;KACD;IAGD,mBAAmB,CAAC,cAAsB,EAAE,UAAkB,EAAE,IAAgB;QAC/E,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,4CAA4C,UAAU,IAAI,IAAI,EAAE,CAAC,CAAC;SAChG;KACD;IAGD,QAAQ,CAAC,WAAgB,EAAE,MAAc;QACxC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,6CAA6C,WAAW,YAAY,MAAM,EAAE,CAAC,CAAC;SAC5G;KACD;IAGD,MAAM,CAAC,aAAkB,EAAE,SAAiB,EAAE,QAAiC;QAC9E,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,gCAAgC,SAAS,EAAE,CAAC,CAAC;SAC3E;;QAED,IAAI,aAAa,GAAG,CAAC,GAAG,IAAI;YAC3B,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;gBACb,QAAQ,CAAC,KAAK,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;aAChC,CAAC,CAAC;SACH,CAAC;QAEF,aAAa,CAAC,EAAE,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;QAC3C,IAAI,SAAS,KAAK,IAAI,CAAC,WAAW,IAAI,aAAa,CAAC,QAAQ,EAAE;YAC7D,MAAM,UAAU,GAAG,EAAE,SAAS,EAAE,IAAI,CAAC,WAAW,EAAE,MAAM,EAAE,aAAa,EAAE,CAAC;YAC1E,aAAa,CAAC,UAAU,CAAC,CAAC;SAC1B;QACD,OAAO,MAAM,aAAa,CAAC,GAAG,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;KACzD;;;YA3ND,UAAU;;;;YAb4B,MAAM;YAIpC,QAAQ;;AAqBhB;IADC,OAAO;uDAMP;AAGD;IADC,OAAO;wDAMP;AAGD;IADC,OAAO;uDAMP;AAGD;IADC,OAAO;6DAUP;AAGD;IADC,OAAO;sDAMP;AAGD;IADC,OAAO;uDAUP;AAGD;IADC,OAAO;yDAMP;AAGD;IADC,OAAO;yDAMP;AAGD;IADC,OAAO;sDAMP;AAGD;IADC,OAAO;0DAMP;AAGD;IADC,OAAO;wDAMP;AAGD;IADC,OAAO;mDAOP;AAGD;IADC,OAAO;wDAMP;AAGD;IADC,OAAO;2DAKP;AAGD;IADC,OAAO;uDAMP;AAGD;IADC,OAAO;oDAMP;AAGD;IADC,OAAO;uDAMP;AAGD;IADC,OAAO;oDAMP;AAGD;IADC,OAAO;uDAMP;AAKD;IADC,OAAO;+DAKP;AAGD;IADC,OAAO;+DAKP;AAGD;IADC,OAAO;+DAKP;AAGD;IADC,OAAO;oDAKP;AAGD;IADC,OAAO;kDAkBP;;AChOF;AACA,MAAM,eAAe,GAAG,SAAS,CAAC;AAClC,MAAM,cAAc,GAAG,IAAI,CAAC;AACrB,MAAM,kBAAkB,GAAG,QAAQ,CAAC;AACpC,MAAM,SAAS,GAAG,WAAW,kBAAkB,EAAE,CAAC;AAClD,MAAM,YAAY,GAAG,cAAc,kBAAkB,EAAE,CAAC;AAE/D,MAAM,kBAAkB,GAAG,UAAU,KAAa,EAAE,WAAmB;IACtE,OAAO,KAAK,CAAC,OAAO,CAAC,eAAe,EAAE,WAAW,CAAC,CAAC;AACpD,CAAC,CAAC;;aAEoE,SAAS,mBAAmB,CAAC,KAAa;IAC/G,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;AACjC,CAAC;AAFD,MAAM,mBAAmB,GAAG,OAAO,CAAC,gCAAgC,OAElE,CAAC;MAGU,gBAAiB,SAAQ,oBAAoB;IAIzD,YAAY,SAAwB,EAAE,QAAgB,EAAE,IAAY,EAAE,QAAkB;QACvF,KAAK,CAAC,QAAQ,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;QAEhC,MAAM,WAAW,GAAG,SAAS,CAAC,EAAE,CAAC,OAAO,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC;QAC9D,IAAI,CAAC,WAAW,GAAG,kBAAkB,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;QACjE,IAAI,CAAC,QAAQ,GAAG,kBAAkB,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;QAC3D,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;KAC9C;IAED,WAAW,CAAC,IAAY;QACvB,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;KAC5C;IAED,WAAW,CAAC,MAAW,EAAE,QAAgB;QACxC,KAAK,CAAC,WAAW,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;KACpC;IAED,aAAa,CAAC,MAAW,EAAE,IAAY;QACtC,MAAM,IAAI,GAAG,KAAK,CAAC,aAAa,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;;;QAI/C,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;QAE/C,OAAO,IAAI,CAAC;KACZ;IAGO,SAAS,CAAC,MAA0B,EAAE,WAAmB;QAChE,MAAM;aACJ,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,QAAQ,EAAE,CAAC;aACxB,GAAG,CAAC,CAAC,CAAC,KAAK,kBAAkB,CAAC,CAAC,EAAE,WAAW,CAAC,CAAC;aAC9C,OAAO,CAAC,mBAAmB,CAAC,CAAC;KAC/B;;;YAtCD,UAAU;;;;;YAvB8C,MAAM;YAGtD,QAAQ;;AAqDhB;IADC,OAAO;iDAMP;;aCpDwD,SAAS,aAAa,CAAC,KAAa;IAC7F,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AAC3B,CAAC;AAFD,MAAM,aAAa,GAAG,OAAO,CAAC,0BAA0B,OAEtD,CAAC;MAGU,2BAA2B;IAMvC,YAA+C,QAAc,EAAU,IAAY;QAAZ,SAAI,GAAJ,IAAI,CAAQ;QALnF,uBAAkB,GAAG,IAAI,GAAG,EAAgC,CAAC;QAM5D,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ,CAAC,MAAM,CAAC,CAAC;QACrC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QAC7B,IAAI,CAAC,eAAe,GAAG,IAAI,oBAAoB,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;KACtF;IAEO,aAAa,CAAC,QAAa;QAClC,IAAI,CAAC,QAAQ,EAAE;YACd,QAAQ,GAAG,WAAW,EAAE,CAAC;SACzB;QAED,QAAQ,CAAC,QAAQ,GAAG,MAAM,CAAC;QAC3B,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC;KAC3B;IAED,cAAc,CAAC,OAAY,EAAE,IAAmB;QAC/C,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,EAAE;YACtB,OAAO,IAAI,CAAC,eAAe,CAAC;SAC5B;QAED,IAAI,QAAQ,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACpD,IAAI,QAAQ,EAAE;YACb,IAAI,QAAQ,YAAY,gBAAgB,EAAE;gBACzC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;aAC9B;YAED,OAAO,QAAQ,CAAC;SAChB;QAED,IAAI,IAAI,CAAC,aAAa,KAAK,iBAAiB,CAAC,IAAI,EAAE;YAClD,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;YAC5D,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC;SAChC;aAAM;YACN,QAAQ,GAAG,IAAI,gBAAgB,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9D,QAAS,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;SAClD;QAED,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;QAC/C,OAAO,QAAQ,CAAC;KAChB;IAED,WAAW;QACV,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,WAAW,CAAC,2CAA2C,CAAC,CAAC;SAC3E;QAED,OAAO,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;YACrD,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;SACvE;KACD;;;YAxDD,UAAU;;;YAZF,IAAI,uBAmBC,QAAQ,YAAI,MAAM,SAAC,aAAa;YApBW,MAAM;;;SCU/C,mBAAmB;IAClC,OAAO,IAAI,YAAY,EAAE,CAAC;AAC3B,CAAC;MAYY,kBAAkB;IAC9B,YAAoC,YAAgC;;QAEnE,oBAAoB,CAAC,YAAY,EAAE,oBAAoB,CAAC,CAAC;KACzD;;;YAZD,QAAQ,SAAC;gBACT,YAAY,EAAE,CAAC,cAAc,CAAC;gBAC9B,SAAS,EAAE,CAAC,YAAY,EAAE,2BAA2B,EAAE,sBAAsB,EAAE,EAAE,OAAO,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,EAAE,EAAE,EAAE,OAAO,EAAE,YAAY,EAAE,UAAU,EAAE,mBAAmB,EAAE,EAAE,EAAE,OAAO,EAAE,gBAAgB,EAAE,WAAW,EAAE,2BAA2B,EAAE,EAAE,EAAE,OAAO,EAAE,gBAAgB,EAAE,QAAQ,EAAEC,qBAAoB,EAAE,CAAC;gBAClU,eAAe,EAAE,CAAC,cAAc,CAAC;gBACjC,OAAO,EAAE,CAAC,iBAAiB,EAAE,wBAAwB,CAAC;gBACtD,OAAO,EAAE,CAAC,iBAAiB,EAAE,wBAAwB,EAAE,cAAc,CAAC;gBACtE,OAAO,EAAE,CAAC,gBAAgB,CAAC;aAC3B;;;YAEkD,kBAAkB,uBAAvD,QAAQ,YAAI,QAAQ;;;AClBlC,MAAM,gBAAgB,GAAG,eAAe,CAAC;SACzB,mBAAmB,CAAC,KAAa;IAChD,OAAO,KAAK,CAAC,OAAO,CAAC,gBAAgB,EAAE,CAAC,GAAG,CAAQ,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC;AAC7E,CAAC;SAEe,uBAAuB,CAAC,MAAkB,EAAE,QAAgB,EAAE,KAAa,EAAE,MAAc;IAC1G,MAAM,IAAI,GAAG,2BAA2B,CAAC,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;IAC1E,OAAO,iBAAiB,CAAC,yBAAyB,CAAC,IAAI,CAAC,CAAC;AAC1D,CAAC;AAED,MAAM,2BAA2B,GAAG,CAAC,MAAkB,EAAE,QAAgB,EAAE,KAAa,EAAE,MAAc,MAA6B;IACpI,UAAU,EAAE,IAAI;IAChB,QAAQ,EAAE,QAAQ,IAAI,IAAI;IAC1B,KAAK;IACL,KAAK,EAAE,QAAQ,CAAC,MAAM,CAAC;IACvB,SAAS,EAAE,MAAM,CAAC,GAAG,CAAC,sBAAsB,CAAC;CAC7C,CAAC,CAAC;;AAEH,MAAM,QAAQ,GAAG,CAAC,KAAa,KAAK,gCAAgC,CAAC,KAAK,CAAC,CAAC;;AAE5E,MAAM,sBAAsB,GAAG,CAAC,MAAgB,MAAoB;IACnE,QAAQ,EAAE,mBAAmB,CAAC,MAAM,CAAC;IACrC,YAAY,EAAE,eAAe,CAAC,MAAM,CAAC;CACrC,CAAC,CAAC;;AAEH,MAAM,mBAAmB,GAAG,CAAC,MAAgB,KAAa,MAAM,CAAC,MAAM,CAAC;;AAExE,SAAS,eAAe,CAAC,MAAgB;IACxC,MAAM,oBAAoB,GAA0B,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,QAAQ,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;IAEnI,OAAO,yBAAyB,CAAC,oBAAoB,CAAC,CAAC;AACxD;;MC/Ba,2BAA2B;IASvC,YAAoB,MAAc,EAAE,SAAqB,EAAU,QAAgB,EAAU,KAAa,EAAE,MAAc;QAAtG,WAAM,GAAN,MAAM,CAAQ;QAAiC,aAAQ,GAAR,QAAQ,CAAQ;QAAU,UAAK,GAAL,KAAK,CAAQ;QARnG,iBAAY,GAAoB,IAAI,CAAC;QAEpC,wBAAmB,GAAe,EAAE,CAAC;QACrC,uBAAkB,GAAe,EAAE,CAAC;QACpC,cAAS,GAAG,KAAK,CAAC;QAClB,aAAQ,GAAG,KAAK,CAAC;QAIxB,IAAI,CAAC,qBAAqB,CAAC,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;KAC/D;IAED,IAAI,SAAS;QACZ,OAAO,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC;KAClC;IAED,IAAI,MAAW;IAEf,UAAU;QACT,OAAO,IAAI,CAAC,QAAQ,CAAC;KACrB;IAED,OAAO,CAAC,EAAY;QACnB,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KAClC;IACD,MAAM,CAAC,EAAY;QAClB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACjC;IACD,SAAS,CAAC,EAAY;QACrB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;KACjC;IAED,IAAI;QACH,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,aAAa,CAAC,kCAAkC,CAAC,CAAC;SACpE;QAED,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACpB,OAAO;SACP;QAED,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YACnB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;YAC/C,IAAI,CAAC,mBAAmB,GAAG,EAAE,CAAC;SAC9B;;;QAID,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE;YACzB,IAAI,CAAC,aAAa,EAAE,CAAC;SACrB;aAAM;YACN,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SACjE;KACD;IAEO,cAAc,CAAC,IAAe;QACrC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;QACvD,IAAI,CAAC,aAAa,EAAE,CAAC;KACrB;IAEO,aAAa;QACpB,IAAI,CAAC,SAAS;aACZ,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;aACjB,IAAI,CAAC,MAAM,IAAI,CAAC,QAAQ,EAAE,CAAC;aAC3B,KAAK,CAAC,CAAC,EAAE,QAAO,CAAC,CAAC;KACpB;IAED,KAAK,MAAW;IAEhB,MAAM;QACL,IAAI,CAAC,QAAQ,EAAE,CAAC;KAChB;IAED,KAAK;QACJ,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,aAAa,CAAC,mCAAmC,CAAC,CAAC;SACrE;QAED,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE;YAC/C,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC;SACxB;KACD;IAED,OAAO;QACN,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,aAAa,CAAC,qCAAqC,CAAC,CAAC;SACvE;QAED,IAAI,CAAC,KAAK,EAAE,CAAC;QACb,IAAI,CAAC,IAAI,EAAE,CAAC;KACZ;IAED,OAAO;QACN,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,aAAa,CAAC,qCAAqC,CAAC,CAAC;SACvE;QACD,IAAI,CAAC,QAAQ,EAAE,CAAC;KAChB;IAED,WAAW,CAAC,EAAO;QAClB,MAAM,IAAI,KAAK,CAAC,sDAAsD,CAAC,CAAC;KACxE;IAED,WAAW;QACV,OAAO,CAAC,CAAC;KACT;IAEO,qBAAqB,CAAC,SAAqB,EAAE,QAAgB,EAAE,KAAa,EAAE,MAAc;QACnG,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,aAAa,CAAC,mDAAmD,CAAC,CAAC;SACrF;QAED,IAAI,CAAC,SAAS,GAAG,uBAAuB,CAAC,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;KAC7E;IAEO,QAAQ;QACf,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,aAAa,CAAC,sCAAsC,CAAC,CAAC;SACxE;QAED,IAAI,IAAI,CAAC,SAAS,EAAE;YACnB,OAAO;SACP;QAED,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QACtB,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;QAC9C,IAAI,CAAC,kBAAkB,GAAG,EAAE,CAAC;KAC7B;;;AC/GF,MAAM,QAAQ;IAIb,YAAY,WAAmB;QAC9B,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;KACxB;IAED,KAAK,CAAC,OAAe;QACpB,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;KAC1E;IAEO,KAAK,CAAC,WAAmB;QAChC,MAAM,SAAS,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;QAE9D,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QAC3D,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;KAC5F;IAEO,eAAe,CAAC,OAAe;QACtC,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;KACtD;IAEO,mBAAmB,CAAC,OAAe;QAC1C,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC;KAClE;;;;IAKO,QAAQ,CAAC,OAAe,EAAE,GAAW;QAC5C,OAAO,OAAO,IAAI,OAAO,CAAC,WAAW,CAAC,IAAI,OAAO,CAAC,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC;KACpE;CACD;MAEY,2BAA2B;IAGvC,qBAAqB,CAAC,QAAgB;QACrC,iBAAiB,CAAC,aAAa,CAAC,+CAA+C,QAAQ,EAAE,CAAC,CAAC;QAC3F,OAAO,2BAA2B,CAAC,eAAe,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;KAC5E;IAED,cAAc,CAAC,OAAe,EAAE,WAAmB;QAClD,iBAAiB,CAAC,aAAa,CAAC,6CAA6C,GAAG,YAAY,OAAO,eAAe,WAAW,EAAE,CAAC,CAAC;QAEjI,MAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;QAChD,OAAO,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;KAC/B;IAED,eAAe,CAAC,IAAY,EAAE,IAAY;QACzC,iBAAiB,CAAC,aAAa,CAAC,8CAA8C,GAAG,aAAa,IAAI,eAAe,IAAI,EAAE,CAAC,CAAC;;QAGzH,IAAI,IAAI,CAAC,YAAY,CAAC,EAAE;YACvB,OAAO,IAAI,CAAC;SACZ;QAED,MAAM,MAAM,GAAoB,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;QACvD,MAAM,MAAM,GAAoB,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;QAEjF,OAAO,MAAM,CAAC,KAAK,CAAC;KACpB;IAED,KAAK,CAAC,OAAe,EAAE,WAAmB,EAAE,KAAc;QACzD,iBAAiB,CAAC,aAAa,CAAC,oCAAoC,GAAG,YAAY,OAAO,eAAe,WAAW,GAAG,GAAG,UAAU,KAAK,EAAE,CAAC,CAAC;QAE7I,MAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;QAChD,MAAM,MAAM,GAAgB,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;QAChD,MAAM,MAAM,GAAgB,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,gBAAgB,EAAE,MAAM,CAAC,CAAC;QAErF,OAAO,MAAM,CAAC,OAAO,IAAI,EAAE,CAAC;KAC5B;IAED,YAAY,CAAC,OAAe,EAAE,IAAY;QACzC,iBAAiB,CAAC,aAAa,CAAC,2CAA2C,GAAG,YAAY,OAAO,WAAW,IAAI,EAAE,CAAC,CAAC;QAEpH,MAAM,aAAa,GAAG,mBAAmB,CAAC,IAAI,CAAC,CAAC;QAChD,OAAO,OAAO,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;KACpC;IAED,OAAO,CAAC,OAAe,EAAE,SAAqB,EAAE,QAAgB,EAAE,KAAa,EAAE,MAAc;QAC9F,iBAAiB,CAAC,aAAa,CAAC,sCAAsC,GAAG,YAAY,OAAO,gBAAgB,SAAS,GAAG,GAAG,aAAa,QAAQ,YAAY,KAAK,GAAG,GAAG,WAAW,MAAM,EAAE,CAAC,CAAC;QAE5L,OAAO,IAAI,2BAA2B,CAAC,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;KACpF;IAEO,YAAY,CAAC,WAAmB;QACvC,OAAO,IAAI,QAAQ,CAAC,WAAW,CAAC,CAAC;KACjC;IAEO,gBAAgB,CAAC,OAAe,EAAE,EAAwD,EAAE,QAAa;QAChH,MAAM,MAAM,GAAG,EAAE,CAAC;;QAElB,cAAc,CAAC,OAAO,EAAE,CAAC,KAAa,KAAK,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC;QAExE,OAAO,MAAM,CAAC;KACd;;AA7Dc,2CAAe,GAAG,CAAC,GAAG,oBAAoB,CAAC,iBAAiB,EAAE,EAAE,WAAW,CAAC,CAAC;AAgE7F,SAAS,WAAW,CAAC,OAAe,EAAE,MAAuB,EAAE,MAAuB;IACrF,IAAI,OAAO,KAAK,MAAM,CAAC,YAAY,EAAE;QACpC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC;KACpB;IAED,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC;AACtB,CAAC;AAED,SAAS,gBAAgB,CAAC,OAAe,EAAE,MAAmB,EAAE,MAAmB;IAClF,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;QACpB,MAAM,CAAC,OAAO,GAAG,EAAE,CAAC;KACpB;IAED,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,MAAM,CAAC;;;;IAKnC,IAAI,OAAO,YAAY,aAAa,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE;QACjE,OAAO,IAAI,CAAC;KACZ;IAED,IAAI,OAAO,YAAY,kBAAkB,EAAE;QAC1C,OAAO,CAAC,SAAS,CAAC,CAAC,KAAa;YAC/B,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC3B,OAAO,IAAI,CAAC;SACZ,CAAC,CAAC;KACH;SAAM;QACN,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KAC7B;IAED,OAAO,KAAK,CAAC;AACd;;MC/Ia,yBAA0B,SAAQC,gBAAe;IAC7D,YAA8B,GAAQ,EAAE,MAAuB,EAAE,UAAoC;QACpG,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,MAAM,EAAE,UAAU,CAAC,CAAC;KACpC;;;YAJD,UAAU;;;4CAEG,MAAM,SAAC,QAAQ;YAZpB,eAAe;YAA+BC,yBAAwB;;SAiB/D,mCAAmC;IAClD,OAAO,IAAI,2BAA2B,EAAE,CAAC;AAC1C,CAAC;SAEe,0BAA0B,CAAC,QAAqC,EAAE,MAAuB,EAAE,IAAY;IACtH,OAAO,IAAIC,yBAAwB,CAAC,QAAQ,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;AAC7D,CAAC;SAEe,iCAAiC;IAChD,OAAO,IAAIC,6BAA4B,EAAE,CAAC;AAC3C,CAAC;MAsBY,4BAA4B;IACxC,YAAoC,YAA0C;;QAE7E,oBAAoB,CAAC,YAAY,EAAE,8BAA8B,CAAC,CAAC;KACnE;;;YAxBD,QAAQ,SAAC;gBACT,OAAO,EAAE,CAAC,wBAAwB,CAAC;gBACnC,SAAS,EAAE;oBACV;wBACC,OAAO,EAAE,eAAe;wBACxB,UAAU,EAAE,mCAAmC;qBAC/C;oBACD,EAAE,OAAO,EAAE,gBAAgB,EAAE,QAAQ,EAAEC,wBAAuB,EAAE;oBAChE;wBACC,OAAO,EAAEH,yBAAwB;wBACjC,UAAU,EAAE,iCAAiC;qBAC7C;oBACD,EAAE,OAAO,EAAED,gBAAe,EAAE,QAAQ,EAAE,yBAAyB,EAAE;oBACjE;wBACC,OAAO,EAAE,gBAAgB;wBACzB,UAAU,EAAE,0BAA0B;wBACtC,IAAI,EAAE,CAAC,2BAA2B,EAAEA,gBAAe,EAAE,MAAM,CAAC;qBAC5D;iBACD;aACD;;;YAEkD,4BAA4B,uBAAjE,QAAQ,YAAI,QAAQ;;;SC9ClB,cAAc,CAAC,GAAW;IACzC,OAAO,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;AACzD,CAAC;SAEe,eAAe,CAAC,GAAW,EAAE,YAA0B;IACtE,GAAG,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;IAC5C,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;IACrD,OAAO,GAAG,CAAC;AACZ,CAAC;SAEe,uBAAuB,CAAI,GAAW,EAAE,YAA0B,EAAE,eAAuC,EAAE,aAA+B;IAC3J,GAAG,GAAG,eAAe,CAAC,GAAG,EAAE,YAAY,CAAC,CAAC;;IAGzC,OAAO,IAAI,UAAU,CAAC,CAAC,QAAqB;QAC3C,IAAI,YAAY,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;YACjC,MAAM,SAAS,GAAG,YAAY,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;YACjD,SAAS,CAAC,QAAQ,EAAE,CAAC,IAAI,CACxB,CAAC,IAAI;gBACJ,IAAI;oBACH,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;oBAC9B,QAAQ,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC;oBAC/C,QAAQ,CAAC,QAAQ,EAAE,CAAC;iBACpB;gBAAC,OAAO,KAAK,EAAE;;;oBAGf,MAAM,WAAW,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;oBAC1C,QAAQ,CAAC,KAAK,CAAC,aAAa,CAAC,GAAG,EAAE,WAAW,EAAE,GAAG,CAAC,CAAC,CAAC;iBACrD;aACD,EACD,CAAC,GAAW;gBACX,QAAQ,CAAC,KAAK,CAAC,aAAa,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;aAC7C,CACD,CAAC;SACF;aAAM;YACN,QAAQ,CAAC,KAAK,CAAC,aAAa,CAAC,GAAG,EAAE,WAAW,EAAE,GAAG,CAAC,CAAC,CAAC;SACrD;KACD,CAAC,CAAC;AACJ;;MCtCa,aAAc,SAAQ,cAAc;IAChD,YAAY,UAAsB,EAAU,YAA0B;QACrE,KAAK,CAAC,UAAU,CAAC,CAAC;QADyB,iBAAY,GAAZ,YAAY,CAAc;KAErE;IAED,MAAM,CAAC,GAAqB;QAC3B,IAAI,MAAkC,CAAC;QAEvC,IAAI,cAAc,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;YAC5B,MAAM,GAAG,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;SAC9C;aAAM;YACN,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;SAC3B;QAED,OAAO,MAAM,CAAC;KACd;IAEO,sBAAsB,CAAC,GAAW;QACzC,OAAO,uBAAuB,CAAC,GAAG,EAAE,IAAI,CAAC,YAAY,EAAE,qBAAqB,EAAE,mBAAmB,CAAC,CAAC;KACnG;;;YApBD,UAAU;;;YANsB,UAAU;YAGlC,YAAY;;AA0BrB,SAAS,qBAAqB,CAAC,GAAW,EAAE,IAAS,EAAE,MAAc;IACpE,OAAO,IAAI,YAAY,CAAC;QACvB,GAAG;QACH,IAAI;QACJ,MAAM;QACN,UAAU,EAAE,IAAI;KAChB,CAAC,CAAC;AACJ,CAAC;AAED,SAAS,mBAAmB,CAAC,GAAW,EAAE,IAAS,EAAE,MAAc;IAClE,OAAO,IAAI,iBAAiB,CAAC;QAC5B,GAAG;QACH,KAAK,EAAE,IAAI;QACX,MAAM;QACN,UAAU,EAAE,OAAO;KACnB,CAAC,CAAC;AACJ;;MClCa,4BAA4B;;;YALxC,QAAQ,SAAC;gBACT,SAAS,EAAE,CAAC,YAAY,EAAE,aAAa,EAAE,EAAE,OAAO,EAAE,WAAW,EAAE,WAAW,EAAE,aAAa,EAAE,CAAC;gBAC9F,OAAO,EAAE,CAAC,gBAAgB,CAAC;gBAC3B,OAAO,EAAE,CAAC,gBAAgB,CAAC;aAC3B;;;MCNY,iBAAiB;IAK7B,YAAmB,IAAW;QAAX,SAAI,GAAJ,IAAI,CAAO;QAJtB,8BAAyB,GAAQ,CAAC,CAAC;QAC3C,aAAQ,GAAG,CAAC,CAAC,QAAO,CAAC;QACrB,cAAS,GAAG,SAAQ,CAAC;KAEa;IAElC,gBAAgB,CAAC,EAAoB;QACpC,IAAI,CAAC,QAAQ,GAAG,CAAC,GAAG;YACnB,IAAI,IAAI,CAAC,yBAAyB,EAAE;gBACnC,YAAY,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;aAC7C;YACD,IAAI,CAAC,yBAAyB,GAAG,UAAU,CAAC;gBAC3C,IAAI,CAAC,yBAAyB,GAAG,CAAC,CAAC;gBACnC,EAAE,CAAC,GAAG,CAAC,CAAC;aACR,EAAE,EAAE,CAAC,CAAC;SACP,CAAC;KACF;IAED,iBAAiB,CAAC,EAAc;QAC/B,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;KACpB;IAED,gBAAgB,CAAC,UAAmB;QACnC,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,UAAU,CAAC;KAClC;IAED,UAAU,CAAC,CAAM,KAAI;IAEX,cAAc,CAAC,KAAU;QAClC,OAAO,OAAO,CAAC,KAAK,CAAC,GAAG,UAAU,GAAG,KAAK,CAAC;KAC3C;;;AC/BF,MAAM,mBAAmB,GAAG;IAC3B,OAAO,EAAE,iBAAiB;IAC1B,WAAW,EAAE,UAAU,CAAC,MAAM,iBAAiB,CAAC;IAChD,KAAK,EAAE,IAAI;CACX,CAAC;AAIF;;;;;;;;;MA6Ba,iBAAkB,SAAQ,iBAA2B;;IAEjE,YAAY,UAAsB;QACjC,KAAK,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;KAChC;IAED,UAAU,CAAC,KAAU;QACpB,MAAM,UAAU,GAAG,KAAK,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC;KAC5B;;;YA7BD,SAAS,SAAC;gBACV,QAAQ,EACP,uEAAuE;oBACvE,uEAAuE;oBACvE,uEAAuE;oBACvE,0EAA0E;oBAC1E,oEAAoE;oBACpE,oEAAoE;oBACpE,oEAAoE;oBACpE,uEAAuE;oBACvE,uEAAuE;oBACvE,uEAAuE;oBACvE,uEAAuE;oBACvE,0EAA0E;gBAC3E,SAAS,EAAE,CAAC,mBAAmB,CAAC;gBAChC,IAAI,EAAE;oBACL,QAAQ,EAAE,aAAa;oBACvB,cAAc,EAAE,wBAAwB;iBACxC;aACD;;;YAzCmB,UAAU;;;ACK9B,MAAM,sBAAsB,GAAG;IAC9B,OAAO,EAAE,iBAAiB;IAC1B,WAAW,EAAE,UAAU,CAAC,MAAM,oBAAoB,CAAC;IACnD,KAAK,EAAE,IAAI;CACX,CAAC;AAEF;;;;;;;;;MAgBa,oBAAqB,SAAQ,iBAAyB;;IAElE,YAAY,UAAsB;QACjC,KAAK,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;KAChC;IAED,UAAU,CAAC,KAAU;QACpB,MAAM,UAAU,GAAG,KAAK,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,UAAU,CAAC;KAC/B;;;YAhBD,SAAS,SAAC;gBACV,QAAQ,EAAE,8DAA8D,GAAG,6DAA6D;gBACxI,SAAS,EAAE,CAAC,sBAAsB,CAAC;gBACnC,IAAI,EAAE;oBACL,iBAAiB,EAAE,wBAAwB;iBAC3C;aACD;;;YA1BmB,UAAU;;;ACK9B,MAAM,mBAAmB,GAAG;IAC3B,OAAO,EAAE,iBAAiB;IAC1B,WAAW,EAAE,UAAU,CAAC,MAAM,iBAAiB,CAAC;IAChD,KAAK,EAAE,IAAI;CACX,CAAC;AAEF;;;;;;;;;MAgBa,iBAAkB,SAAQ,iBAA6B;;IAEnE,YAAY,UAAsB;QACjC,KAAK,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;KAChC;IAED,UAAU,CAAC,KAAU;QACpB,MAAM,UAAU,GAAG,KAAK,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC;KAC5B;;;YAhBD,SAAS,SAAC;gBACV,QAAQ,EAAE,0EAA0E,GAAG,0EAA0E,GAAG,0EAA0E,GAAG,4EAA4E;gBAC7T,SAAS,EAAE,CAAC,mBAAmB,CAAC;gBAChC,IAAI,EAAE;oBACL,cAAc,EAAE,wBAAwB;iBACxC;aACD;;;YA1BmB,UAAU;;;ACK9B,MAAM,mBAAmB,GAAG;IAC3B,OAAO,EAAE,iBAAiB;IAC1B,WAAW,EAAE,UAAU,CAAC,MAAM,iBAAiB,CAAC;IAChD,KAAK,EAAE,IAAI;CACX,CAAC;AAEF;;;;;;;;;MAgBa,iBAAkB,SAAQ,iBAA6B;;IAEnE,YAAY,UAAsB;QACjC,KAAK,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;KAChC;IAED,UAAU,CAAC,KAAU;QACpB,MAAM,UAAU,GAAG,KAAK,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC;KAC5B;;;YAhBD,SAAS,SAAC;gBACV,QAAQ,EAAE,0EAA0E,GAAG,0EAA0E,GAAG,0EAA0E,GAAG,4EAA4E;gBAC7T,SAAS,EAAE,CAAC,mBAAmB,CAAC;gBAChC,IAAI,EAAE;oBACL,cAAc,EAAE,wBAAwB;iBACxC;aACD;;;YA1BmB,UAAU;;;ACK9B,MAAM,qBAAqB,GAAG;IAC7B,OAAO,EAAE,iBAAiB;IAC1B,WAAW,EAAE,UAAU,CAAC,MAAM,mBAAmB,CAAC;IAClD,KAAK,EAAE,IAAI;CACX,CAAC;AAEF;;;;;;;;;MAgBa,mBAAoB,SAAQ,iBAAyB;;IAEjE,YAAY,UAAsB;QACjC,KAAK,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;KAChC;IAED,UAAU,CAAC,KAAU;QACpB,MAAM,UAAU,GAAG,KAAK,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC;KAC7B;;;YAhBD,SAAS,SAAC;gBACV,QAAQ,EAAE,8DAA8D,GAAG,6DAA6D;gBACxI,SAAS,EAAE,CAAC,qBAAqB,CAAC;gBAClC,IAAI,EAAE;oBACL,eAAe,EAAE,wBAAwB;iBACzC;aACD;;;YA1BmB,UAAU;;;ACK9B,MAAM,6BAA6B,GAAG;IACrC,OAAO,EAAE,iBAAiB;IAC1B,WAAW,EAAE,UAAU,CAAC,MAAM,0BAA0B,CAAC;IACzD,KAAK,EAAE,IAAI;CACX,CAAC;AAIF;;;;;;;;;MA4Ba,0BAA2B,SAAQ,iBAAiC;;IAEhF,YAAY,UAAsB;QACjC,KAAK,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;KAChC;IAKD,UAAU,CAAC,KAAU;QACpB,MAAM,UAAU,GAAG,KAAK,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAC/C,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC;QAExB,IAAI,IAAI,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC;SACrC;KACD;IAED,eAAe;QACd,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;QAC5B,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC;KACrC;;;YAxCD,SAAS,SAAC;gBACV,QAAQ,EACP,gFAAgF;oBAChF,gFAAgF;oBAChF,gFAAgF;oBAChF,mFAAmF;oBACnF,0EAA0E;oBAC1E,0EAA0E;oBAC1E,0EAA0E;oBAC1E,6EAA6E;oBAC7E,iEAAiE;oBACjE,iEAAiE;oBACjE,iEAAiE;oBACjE,mEAAmE;gBACpE,SAAS,EAAE,CAAC,6BAA6B,CAAC;gBAC1C,IAAI,EAAE;oBACL,uBAAuB,EAAE,wBAAwB;iBACjD;aACD;;;YAxCmB,UAAU;;;MCYjB,uBAAuB;;;YANnC,QAAQ,SAAC;gBACT,YAAY,EAAE,CAAC,iBAAiB,EAAE,oBAAoB,EAAE,iBAAiB,EAAE,iBAAiB,EAAE,0BAA0B,EAAE,mBAAmB,CAAC;gBAC9I,SAAS,EAAE,EAAE;gBACb,OAAO,EAAE,CAAC,WAAW,CAAC;gBACtB,OAAO,EAAE,CAAC,WAAW,EAAE,iBAAiB,EAAE,oBAAoB,EAAE,iBAAiB,EAAE,iBAAiB,EAAE,0BAA0B,EAAE,mBAAmB,CAAC;aACtJ;;;ACRD;;;;;;;;;;;;;;;;;;SAkBgB,kCAAkC,CAAC,cAAsC;IACxF,IAAI,oBAAoB,GAAG,cAAc,CAAC;IAE1C,OAAO,oBAAoB,CAAC,MAAM,IAAI,oBAAoB,CAAC,MAAM,CAAC,WAAW,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,WAAW,CAAC,SAAS,EAAE;QACpI,oBAAoB,GAAG,oBAAoB,CAAC,MAAM,CAAC;KACnD;IAED,OAAO,oBAAoB,CAAC;AAC7B,CAAC;AAEM,MAAM,yBAAyB,GAAG,MAAM,CAAC,uBAAuB,CAAC,CAAC;AAClE,MAAM,eAAe,GAAG,MAAM,CAAC,YAAY,CAAC,CAAC;SAEpC,mBAAmB,CAAC,YAA+B;IAClE,IAAI,YAAY,EAAE;QACjB,MAAM,SAAS,GAAG,YAAY,CAAC,eAAe,CAAC,CAAC;QAChD,IAAI,SAAS,EAAE;YACd,SAAS,CAAC,OAAO,EAAE,CAAC;SACpB;QACD,YAAY,CAAC,OAAO,EAAE,CAAC;KACvB;AACF;;MCxBa,gBAAgB;IAC5B,YAAmB,MAAc,EAAS,gBAAoC,EAAS,YAA0B;QAA9F,WAAM,GAAN,MAAM,CAAQ;QAAS,qBAAgB,GAAhB,gBAAgB,CAAoB;QAAS,iBAAY,GAAZ,YAAY,CAAc;KAAI;IAE9G,QAAQ,CAAC,QAAe,EAAE,MAAiC;QACjE,IAAI,MAAM,EAAE;YACX,IAAI,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;SACpD;QACD,OAAO,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;KAC9C;IAEM,aAAa,CAAC,GAAqB,EAAE,OAA2B;QACtE,IAAI,OAAO,EAAE;YACZ,IAAI,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;SACrD;QACD,OAAO,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;KACtC;IAEM,IAAI,CAAC,qBAA6C;QACxD,IAAI,qBAAqB,EAAE;YAC1B,IAAI,CAAC,WAAW,CAAC,qBAAqB,CAAC,CAAC;SACxC;aAAM;YACN,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;SAC7B;KACD;IAEM,SAAS,CAAC,qBAA6C;QAC7D,IAAI,SAAS,GAAG,IAAI,CAAC;QACrB,IAAI,qBAAqB,EAAE;YAC1B,MAAM,EAAE,aAAa,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,CAAC;YAEjF,IAAI,aAAa,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM,EAAE;gBAC5C,iBAAiB,CAAC,WAAW,CAAC,6CAA6C,CAAC,CAAC;aAC7E;iBAAM;gBACN,aAAa,CAAC,OAAO,CAAC,CAAC,YAAY;oBAClC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,YAAY,CAAC,EAAE;wBACnD,SAAS,GAAG,KAAK,CAAC;qBAClB;iBACD,CAAC,CAAC;aACH;SACD;aAAM;YACN,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC;SAC9C;QAED,OAAO,SAAS,CAAC;KACjB;IAEM,kBAAkB;QACxB,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,MAAM,EAAE,CAAC;KACtC;IAEM,uBAAuB;QAC7B,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,SAAS,EAAE,CAAC;KAChD;IAEO,WAAW,CAAC,OAA8B;QACjD,MAAM,EAAE,aAAa,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;QAEnE,IAAI,aAAa,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM,EAAE;YAC5C,iBAAiB,CAAC,WAAW,CAAC,6CAA6C,CAAC,CAAC;SAC7E;aAAM;YACN,aAAa,CAAC,OAAO,CAAC,CAAC,YAAY;gBAClC,IAAI,YAAY,CAAC,oBAAoB,EAAE;oBACtC,iBAAiB,CAAC,WAAW,CAAC,iDAAiD,CAAC,CAAC;iBACjF;qBAAM;oBACN,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;iBACzC;aACD,CAAC,CAAC;SACH;KACD;;IAGO,iBAAiB,CAAC,OAA+B;QACxD,MAAM,aAAa,GAAkB,EAAE,CAAC;QACxC,MAAM,SAAS,GAAmB,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC;QAC/D,IAAI,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;QAC9B,IAAI,aAAa,GAAG,OAAO,CAAC,UAAU,IAAI,SAAS,CAAC;QAEpD,MAAM,mBAAmB,GAAG,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,CAAC;QAClE,MAAM,eAAe,GAAG,mBAAmB,IAAI,mBAAmB,CAAC,eAAe,CAAC;;;QAInF,IAAI,eAAe,IAAI,aAAa,CAAC,MAAM,KAAK,SAAS,EAAE;YAC1D,aAAa,GAAG,aAAa,CAAC,MAAM,IAAI,aAAa,CAAC;SACtD;QAED,MAAM,aAAa,GAAG,OAAO,GAAG,aAAa,CAAC,QAAQ,GAAG,CAAC,aAAa,CAAC,CAAC;QACzE,OAAO,GAAG,OAAO,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAE5C,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,aAAa,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE;YAC1D,MAAM,YAAY,GAAG,aAAa,CAAC,KAAK,CAAC,CAAC;YAC1C,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,aAAa,KAAK,aAAa,KAAK,YAAY,CAAC,MAAM,CAAC,EAAE;gBAC3E,MAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;gBAEpD,IAAI,MAAM,EAAE;oBACX,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;iBAC3B;aACD;SACD;QAED,OAAO,EAAE,aAAa,EAAE,aAAa,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC;KAC1D;IAEO,iBAAiB,CAAC,YAA4B;QACrD,IAAI,MAAM,CAAC;QAEX,MAAM,oBAAoB,GAAG,kCAAkC,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;QACvF,MAAM,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,CAAC;QAC/E,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,SAAS,EAAE,oBAAoB,CAAC,CAAC;QAE3E,OAAO,MAAM,CAAC;KACd;;;;YAlHD,UAAU,SAAC;gBACX,UAAU,EAAE,MAAM;aAClB;;;YAhBQ,MAAM;YACN,kBAAkB;YAElB,YAAY;;;ACOrB;;;;;;;;;;;;;;;;;;;;;;;;MAyBa,YAAY;IAkBxB,YAAoB,MAAc,EAAU,SAA2B,EAAU,KAAqB;QAAlF,WAAM,GAAN,MAAM,CAAQ;QAAU,cAAS,GAAT,SAAS,CAAkB;QAAU,UAAK,GAAL,KAAK,CAAgB;QAL7F,mBAAc,GAA4C,IAAI,CAAC;QAGhE,aAAQ,GAAU,EAAE,CAAC;KAE6E;IAE1G,IACI,MAAM,CAAC,IAAoB;QAC9B,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACxB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;SACrB;aAAM;YACN,IAAI,CAAC,QAAQ,GAAG,CAAC,IAAI,CAAC,CAAC;SACvB;KACD;IAGD,KAAK;QACJ,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,wBAAwB,IAAI,CAAC,QAAQ,GAAG,GAAG,UAAU,IAAI,CAAC,YAAY,GAAG,GAAG,eAAe,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,GAAG,aAAa,IAAI,CAAC,sBAAsB,EAAE,CAAC,CAAC;SAC5M;QAED,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAChC,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;KACnD;IAEO,SAAS;QAChB,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;QACxC,OAAO;YACN,kBAAkB,EAAE,aAAa,CAAC,IAAI,CAAC,kBAAkB,CAAC;YAC1D,UAAU,EAAE,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC;YAE1C,YAAY,EAAE,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,YAAY,CAAC;YACzD,QAAQ,EAAE,UAAU,CAAC,QAAQ;YAC7B,UAAU,EAAE,UAAU,CAAC,UAAU;SACjC,CAAC;KACF;IAED,IAAI,OAAO;QACV,MAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,EAAE;YACxD,UAAU,EAAE,IAAI,CAAC,KAAK;YACtB,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,mBAAmB,EAAE,aAAa,CAAC,IAAI,CAAC,mBAAmB,CAAC;YAC5D,mBAAmB,EAAE,IAAI,CAAC,mBAAmB;YAC7C,gBAAgB,EAAE,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC;SACtD,CAAC,CAAC;QAEH,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,iCAAiC,OAAO,EAAE,CAAC,CAAC;SACxE;QAED,OAAO,OAAO,CAAC;KACf;IAEO,mBAAmB,CAAC,KAAuB;QAClD,OAAO,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,MAAM,CAAC;KAC1C;IAEO,aAAa;QACpB,IAAI,UAAgC,CAAC;QACrC,IAAI,QAAiB,CAAC;QAEtB,IAAI,OAAO,IAAI,CAAC,cAAc,KAAK,SAAS,EAAE;YAC7C,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC;SAC/B;aAAM,IAAI,OAAO,IAAI,CAAC,cAAc,KAAK,QAAQ,EAAE;YACnD,IAAI,IAAI,CAAC,cAAc,KAAK,MAAM,IAAI,IAAI,CAAC,cAAc,KAAK,OAAO,EAAE;gBACtE,QAAQ,GAAG,KAAK,CAAC;aACjB;iBAAM;gBACN,QAAQ,GAAG,IAAI,CAAC;gBAChB,UAAU,GAAG;oBACZ,IAAI,EAAU,IAAI,CAAC,cAAc;iBACjC,CAAC;aACF;SACD;aAAM;YACN,QAAQ,GAAG,IAAI,CAAC;YAChB,UAAU,GAAyB,IAAI,CAAC,cAAc,CAAC;SACvD;QAED,IAAI,QAAQ,GAAG,CAAC,IAAI,CAAC,sBAAsB,CAAC;QAC5C,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE;YACrB,UAAU,GAAG,UAAU,IAAI,EAAE,CAAC;YAC9B,UAAU,CAAC,QAAQ,GAAG,QAAQ,CAAC;SAC/B;QAED,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC;KAChC;;;YApGD,SAAS,SAAC,EAAE,QAAQ,EAAE,gBAAgB,EAAE;;;YAjChB,MAAM;YAGtB,gBAAgB;YAHhB,cAAc;;;qBAoCrB,KAAK;0BACL,KAAK;uBACL,KAAK;kCAEL,KAAK;kCACL,KAAK;+BACL,KAAK;iCACL,KAAK;yBACL,KAAK;2BAEL,KAAK;6BACL,KAAK;qCACL,KAAK;qBAML,KAAK,SAAC,cAAc;oBASpB,YAAY,SAAC,KAAK;;AAyEpB,SAAS,aAAa,CAAC,CAAM;IAC5B,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;AACxB;;AC5IA;SAMgB,YAAY,CAAC,SAAkB,EAAE,SAAkB,EAAE,KAAc;IAClF,IAAI,KAAK,EAAE;QACV,OAAO,kBAAkB,CAAC,SAAS,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC;KAC1D;SAAM;QACN,OAAO,oBAAoB,CAAC,SAAS,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC;KAC5D;AACF,CAAC;AAED,SAAS,kBAAkB,CAAC,SAA0B,EAAE,SAA0B;IACjF,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ,EAAE,SAAS,CAAC,QAAQ,CAAC,EAAE;QACvD,OAAO,KAAK,CAAC;KACb;IACD,IAAI,SAAS,CAAC,gBAAgB,KAAK,SAAS,CAAC,gBAAgB,EAAE;QAC9D,OAAO,KAAK,CAAC;KACb;IACD,KAAK,IAAI,CAAC,IAAI,SAAS,CAAC,QAAQ,EAAE;QACjC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;YAC3B,OAAO,KAAK,CAAC;SACb;QACD,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE;YACtE,OAAO,KAAK,CAAC;SACb;KACD;IACD,OAAO,IAAI,CAAC;AACb,CAAC;AAED,SAAS,oBAAoB,CAAC,SAA0B,EAAE,SAA0B;IACnF,OAAO,0BAA0B,CAAC,SAAS,EAAE,SAAS,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC;AAC7E,CAAC;AAED,SAAS,0BAA0B,CAAC,SAA0B,EAAE,SAA0B,EAAE,cAA4B;IACvH,IAAI,SAAS,CAAC,QAAQ,CAAC,MAAM,GAAG,cAAc,CAAC,MAAM,EAAE;QACtD,MAAM,OAAO,GAAG,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,cAAc,CAAC,MAAM,CAAC,CAAC;QACnE,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,cAAc,CAAC,EAAE;YACxC,OAAO,KAAK,CAAC;SACb;QACD,IAAI,SAAS,CAAC,WAAW,EAAE,EAAE;YAC5B,OAAO,KAAK,CAAC;SACb;QACD,OAAO,IAAI,CAAC;KACZ;SAAM,IAAI,SAAS,CAAC,QAAQ,CAAC,MAAM,KAAK,cAAc,CAAC,MAAM,EAAE;QAC/D,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ,EAAE,cAAc,CAAC,EAAE;YACnD,OAAO,KAAK,CAAC;SACb;QACD,KAAK,IAAI,CAAC,IAAI,SAAS,CAAC,QAAQ,EAAE;YACjC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;gBAC3B,OAAO,KAAK,CAAC;aACb;YACD,IAAI,CAAC,oBAAoB,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE;gBACxE,OAAO,KAAK,CAAC;aACb;SACD;QACD,OAAO,IAAI,CAAC;KACZ;SAAM;QACN,MAAM,OAAO,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC,EAAE,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACnE,MAAM,IAAI,GAAG,cAAc,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QAC7D,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE;YAC5C,OAAO,KAAK,CAAC;SACb;QACD,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,cAAc,CAAC,EAAE;YACxC,OAAO,KAAK,CAAC;SACb;QACD,OAAO,0BAA0B,CAAC,SAAS,CAAC,QAAQ,CAAC,cAAc,CAAC,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;KACvF;AACF,CAAC;SAEe,SAAS,CAAC,CAAe,EAAE,CAAe;IACzD,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,MAAM,EAAE;QAC1B,OAAO,KAAK,CAAC;KACb;IACD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;QAClC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;YAC5B,OAAO,KAAK,CAAC;SACb;KACD;IACD,OAAO,IAAI,CAAC;AACb;;AC1EA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MA8Ca,kBAAkB;IAU9B,YAAoB,MAAc,EAAU,OAAmB,EAAU,QAAmB;QAAxE,WAAM,GAAN,MAAM,CAAQ;QAAU,YAAO,GAAP,OAAO,CAAY;QAAU,aAAQ,GAAR,QAAQ,CAAW;QANpF,YAAO,GAAa,EAAE,CAAC;QAEvB,WAAM,GAAY,KAAK,CAAC;QAEvB,8BAAyB,GAAuB,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;QAGzE,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;YAC7C,IAAI,CAAC,YAAY,aAAa,EAAE;gBAC/B,IAAI,CAAC,MAAM,EAAE,CAAC;aACd;SACD,CAAC,CAAC;KACH;IAED,IAAI,QAAQ;QACX,OAAO,IAAI,CAAC,MAAM,CAAC;KACnB;IAED,kBAAkB;QACjB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;QAClD,IAAI,CAAC,MAAM,EAAE,CAAC;KACd;IAED,IACI,kBAAkB,CAAC,IAAuB;QAC7C,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACxB,IAAI,CAAC,OAAO,GAAQ,IAAI,CAAC;SACzB;aAAM;YACN,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;SAC/B;KACD;IAED,WAAW,CAAC,CAAK;QAChB,IAAI,CAAC,MAAM,EAAE,CAAC;KACd;IACD,WAAW;QACV,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;KAChC;IAEO,MAAM;QACb,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YAChB,OAAO;SACP;QACD,MAAM,cAAc,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;;QAE7C,IAAI,IAAI,CAAC,MAAM,KAAK,cAAc,EAAE;YACnC,MAAM,cAAc,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;YAC7D,MAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,cAAc,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YAClE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,CAAC,EAAE,aAAa,CAAC,CAAC,CAAC;SAClG;QACD,OAAO,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM,MAAM,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC;KACzE;IAEO,UAAU,CAAC,cAAuB,EAAE,CAAiB;QAC5D,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,GAAY,EAAE,IAAkB;YAChD,OAAO,GAAG,IAAI,YAAY,CAAC,cAAc,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,yBAAyB,CAAC,KAAK,CAAC,CAAC;SAC/F,EAAE,KAAK,CAAC,CAAC;KACV;IAEO,YAAY,CAAC,MAAc;QAClC,OAAO,CAAC,IAAkB,KAAK,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,yBAAyB,CAAC,KAAK,CAAC,CAAC;KACnG;IAEO,cAAc;QACrB,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;KACvD;;;YAzED,SAAS,SAAC;gBACV,QAAQ,EAAE,sBAAsB;gBAChC,QAAQ,EAAE,kBAAkB;aAC5B;;;YAlDuB,MAAM;YAHyB,UAAU;YAA0C,SAAS;;;oBAwDlH,eAAe,SAAC,YAAY;wCAM5B,KAAK;iCAmBL,KAAK,SAAC,oBAAoB;;;ACpE5B,MAAM,cAAc,GAAG,UAAU,QAAgC;IAChE,OAAO,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACzC,CAAC,CAAC;;AAEF;;;AAGA,MAAM,kBAAkB;IAAxB;QACS,UAAK,GAAG,IAAI,KAAK,EAAa,CAAC;KAgEvC;IA9DA,IAAW,MAAM;QAChB,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;KACzB;IAEM,IAAI,CAAC,SAAoB;QAC/B,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;KAC3B;IAEM,GAAG;QACT,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;KACxB;IAEM,IAAI;QACV,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;KACzC;IAEM,KAAK;QACX,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,qBAAqB,CAAC,8BAA8B,IAAI,CAAC,KAAK,CAAC,MAAM,0BAA0B,CAAC,CAAC;SACnH;QAED,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YAC7B,MAAM,KAAK,GAAQ,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC;YAC1C,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE;gBACxB,MAAM,IAAI,KAAK,CAAC,8CAA8C,CAAC,CAAC;aAChE;YAED,mBAAmB,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;SACxC;KACD;IAEM,eAAe;QACrB,IAAI,iBAAiB,GAAG,CAAC,CAAC;QAC1B,MAAM,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,SAAS;YAC/C,OAAO,SAAS,CAAC,OAAO,CAAC;SACzB,CAAC,CAAC;QAEH,IAAI,aAAa,EAAE;YAClB,IAAI,iBAAiB,GAAG,KAAK,CAAC;YAE9B,OAAO,CAAC,iBAAiB,EAAE;gBAC1B,IAAI,SAAS,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;gBAC5B,MAAM,KAAK,GAAQ,SAAS,CAAC,KAAK,CAAC;gBAEnC,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE;oBACxB,MAAM,IAAI,KAAK,CAAC,8CAA8C,CAAC,CAAC;iBAChE;gBAED,mBAAmB,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;gBACxC,IAAI,SAAS,CAAC,OAAO,EAAE;oBACtB,iBAAiB,GAAG,IAAI,CAAC;iBACzB;gBAED,IAAI,CAAC,GAAG,EAAE,CAAC;gBACX,iBAAiB,EAAE,CAAC;aACpB;SACD;QAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,qBAAqB,CAAC,wCAAwC,iBAAiB,0BAA0B,CAAC,CAAC;SAC7H;KACD;CACD;AAED;;;;;MAMa,oBAAoB;IAGhC,YAAoB,QAA4B;QAA5B,aAAQ,GAAR,QAAQ,CAAoB;QAFxC,kBAAa,GAA0C,EAAE,CAAC;KAEd;IAEpD,YAAY,CAAC,KAA6B;QACzC,KAAK,GAAG,kCAAkC,CAAC,KAAK,CAAC,CAAC;QAElD,MAAM,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;QACxD,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;QAC1D,MAAM,GAAG,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC;QAClC,MAAM,eAAe,GAAG,KAAK,CAAC,yBAAyB,CAAC,CAAC;QACzD,MAAM,MAAM,GAAG,MAAM,GAAG,MAAM,CAAC,oBAAoB,GAAG,KAAK,CAAC;QAC5D,IAAI,YAAY,GAAG,MAAM,IAAI,CAAC,MAAM,IAAI,eAAe,CAAC;QAExD,IAAI,MAAM,EAAE;YACX,IAAI,MAAM,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE;gBACjD,YAAY,GAAG,KAAK,CAAC;aACrB;YAED,MAAM,CAAC,YAAY,GAAG,YAAY,CAAC;SACnC;QAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,qBAAqB,CAAC,wBAAwB,MAAM,SAAS,GAAG,YAAY,YAAY,EAAE,CAAC,CAAC;SAC9G;QAED,OAAO,YAAY,CAAC;KACpB;IAED,YAAY,CAAC,KAA6B;QACzC,KAAK,GAAG,kCAAkC,CAAC,KAAK,CAAC,CAAC;QAElD,MAAM,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;QACxD,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;QAC1D,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;QAC5C,IAAI,CAAC,KAAK,EAAE;YACX,OAAO,KAAK,CAAC;SACb;QAED,MAAM,GAAG,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC;QAClC,MAAM,MAAM,GAAG,MAAM,GAAG,MAAM,CAAC,oBAAoB,GAAG,KAAK,CAAC;QAC5D,MAAM,YAAY,GAAG,MAAM,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC,GAAG,KAAK,GAAG,CAAC;QAExD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,qBAAqB,CAAC,wBAAwB,MAAM,SAAS,GAAG,YAAY,YAAY,EAAE,CAAC,CAAC;SAC9G;QAED,IAAI,MAAM,EAAE;YACX,MAAM,CAAC,YAAY,GAAG,IAAI,CAAC;SAC3B;QAED,OAAO,YAAY,CAAC;KACpB;IAED,KAAK,CAAC,KAA6B,EAAE,KAA0B;QAC9D,KAAK,GAAG,kCAAkC,CAAC,KAAK,CAAC,CAAC;QAElD,MAAM,GAAG,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC;QAClC,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,qBAAqB,CAAC,cAAc,GAAG,YAAY,KAAK,EAAE,CAAC,CAAC;SAC9E;QAED,MAAM,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;;QAGxD,MAAM,KAAK,IAAI,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,IAAI,IAAI,kBAAkB,EAAE,CAAC,CAAC;QAE1G,IAAI,KAAK,EAAE;YACV,IAAI,OAAO,GAAG,KAAK,CAAC;YACpB,IAAI,IAAI,CAAC,QAAQ,CAAC,qBAAqB,GAAG,CAAC,EAAE;gBAC5C,OAAO,GAAG,IAAI,CAAC;aACf;YAED,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC,CAAC;SACpC;aAAM;YACN,MAAM,OAAO,GAAG,KAAK,CAAC,IAAI,EAAE,CAAC;YAC7B,IAAI,OAAO,CAAC,GAAG,KAAK,GAAG,EAAE;gBACxB,KAAK,CAAC,GAAG,EAAE,CAAC;gBAEZ,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;oBAClB,OAAO,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;iBACrC;aACD;iBAAM;gBACN,MAAM,IAAI,KAAK,CAAC,8DAA8D,GAAG,aAAa,OAAO,CAAC,GAAG,YAAY,GAAG,EAAE,CAAC,CAAC;aAC5H;SACD;KACD;IAED,QAAQ,CAAC,KAA6B;QACrC,KAAK,GAAG,kCAAkC,CAAC,KAAK,CAAC,CAAC;QAElD,MAAM,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;QACxD,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;QAC1D,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;QAC5C,IAAI,CAAC,KAAK,EAAE;YACX,OAAO,IAAI,CAAC;SACZ;QAED,MAAM,GAAG,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC;QAClC,MAAM,MAAM,GAAG,MAAM,GAAG,MAAM,CAAC,oBAAoB,GAAG,KAAK,CAAC;QAC5D,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,EAAE,CAAC;QAEhC,IAAI,KAAK,GAAG,IAAI,CAAC;QACjB,IAAI,MAAM,IAAI,UAAU,IAAI,UAAU,CAAC,GAAG,KAAK,GAAG,EAAE;YACnD,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC;SACzB;QAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,qBAAqB,CAAC,qBAAqB,MAAM,SAAS,GAAG,WAAW,KAAK,EAAE,CAAC,CAAC;SACnG;QAED,OAAO,KAAK,CAAC;KACb;IAED,gBAAgB,CAAC,MAA8B,EAAE,IAA4B;QAC5E,MAAM,WAAW,GAAG,MAAM,CAAC,WAAW,KAAK,IAAI,CAAC,WAAW,CAAC;QAE5D,IAAI,WAAW,IAAI,IAAI,IAAI,IAAI,CAAC,yBAAyB,CAAC,EAAE;;;YAG3D,MAAM,CAAC,yBAAyB,CAAC,GAAG,IAAI,CAAC,yBAAyB,CAAC,CAAC;SACpE;QAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,qBAAqB,CAAC,4BAA4B,WAAW,EAAE,CAAC,CAAC;SACnF;QAED,OAAO,WAAW,CAAC;KACnB;IAED,UAAU,CAAC,SAAiB;QAC3B,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;QAE5C,IAAI,KAAK,EAAE;YACV,KAAK,CAAC,KAAK,EAAE,CAAC;SACd;KACD;IAED,eAAe,CAAC,SAAiB;QAChC,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;QAE5C,IAAI,KAAK,EAAE;YACV,KAAK,CAAC,eAAe,EAAE,CAAC;SACxB;KACD;;;YAlJD,UAAU;;;YAxFF,kBAAkB;;;MCYd,SAAS;IAGrB,YAAY,UAA0B;QACrC,IAAI,CAAC,cAAc,GAAG,IAAI,eAAe,CAAC,UAAU,CAAC,CAAC;KACtD;CACD;MAEY,oBAAoB;IAEhC,YAAoB,qBAAkC,EAAU,MAAgB;QAA5D,0BAAqB,GAArB,qBAAqB,CAAa;QAAU,WAAM,GAAN,MAAM,CAAU;QADxE,SAAI,GAAG,IAAI,GAAG,EAAO,CAAC;KACsD;IACpF,GAAG,CAAI,KAAkC,EAAE,aAAiB,EAAE,KAAmB;QAChF,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,EAAE,aAAa,EAAE,KAAK,CAAC,CAAC;QACzD,IAAI,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;YAC1C,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;SACnB;QACD,OAAO,GAAG,CAAC;KACX;IACD,OAAO;QACN,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG;YACrB,IAAI,GAAG,CAAC,WAAW,YAAY,QAAQ,EAAE;gBACxC,GAAG,CAAC,WAAW,EAAE,CAAC;aAClB;SACD,CAAC,CAAC;QACH,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;KAClB;CACD;AAID,MAAM,aAAa,GAAG,UAAU,cAAuD;IACtF,OAAO,cAAc,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC/C,CAAC,CAAC;;MAGW,gBAAgB;IAiD5B,YAAoB,cAAsC,EAAU,QAA0B,EAAqB,IAAY,EAAoC,mBAA2B,EAA8B,aAAsB,EAAU,gBAAoC,EAAU,wBAAkD,EAAU,QAAkC,EAAU,cAAiC,EAAgC,WAAwB,EAAU,kBAAwC,EAAU,MAAc,EAAE,KAAiB;QAApjB,mBAAc,GAAd,cAAc,CAAwB;QAAU,aAAQ,GAAR,QAAQ,CAAkB;QAA8J,qBAAgB,GAAhB,gBAAgB,CAAoB;QAAU,6BAAwB,GAAxB,wBAAwB,CAA0B;QAAU,aAAQ,GAAR,QAAQ,CAA0B;QAAU,mBAAc,GAAd,cAAc,CAAmB;QAAgC,gBAAW,GAAX,WAAW,CAAa;QAAU,uBAAkB,GAAlB,kBAAkB,CAAsB;QAAU,WAAM,GAAN,MAAM,CAAQ;;QA/C7iB,cAAS,GAA6B,IAAI,CAAC;QAC3C,oBAAe,GAA0B,IAAI,CAAC;QASlC,mBAAc,GAAG,IAAI,YAAY,EAAO,CAAC;QACvC,qBAAgB,GAAG,IAAI,YAAY,EAAO,CAAC;QAqChE,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QACnC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC,aAAa,CAAC;QACjC,IAAI,CAAC,sBAAsB,CAAC,mBAAmB,CAAC,CAAC;QACjD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,uCAAuC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;SACjF;QAED,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,cAAc,CAAC;QACnC,cAAc,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,EAAO,IAAI,CAAC,CAAC;QAE1D,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ,CAAC,MAAM,CAAC,CAAC;QACrC,IAAI,CAAC,qBAAqB,GAAG,QAAQ,CAAC,uBAAuB,CAAC,cAAc,CAAC,CAAC;KAC9E;;IA9CD,IAAI,gBAAgB;QACnB,OAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;KAC9B;;IAED,IAAI,uBAAuB;QAC1B,OAAO,IAAI,CAAC,QAAQ,CAAC;KACrB;IAED,IAAI,WAAW;QACd,OAAO,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;KACxB;IAED,IAAI,SAAS;QACZ,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACpB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,SAAS,CAAC,yBAAyB,CAAC,CAAC;aACvD;YACD,OAAO;SACP;QAED,OAAO,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;KAC/B;IACD,IAAI,cAAc;QACjB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACpB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,SAAS,CAAC,yBAAyB,CAAC,CAAC;aACvD;YACD,OAAO;SACP;QAED,OAAO,IAAI,CAAC,eAAe,CAAC;KAC5B;IAiBD,sBAAsB,CAAC,mBAA2B;QACjD,QAAQ,mBAAmB;YAC1B,KAAK,QAAQ,CAAC;YACd,KAAK,OAAO;gBACX,IAAI,CAAC,KAAK,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;gBACrD,OAAO;YAER;gBACC,IAAI,CAAC,KAAK,CAAC,mBAAmB,GAAG,MAAM,CAAC;SACzC;KACD;IAED,WAAW;;;QAGV,IAAI,CAAC,cAAc,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEtD,IAAI,IAAI,CAAC,MAAM,EAAE;YAChB,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,GAAG;gBAClC,IAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;aAC7C,CAAC,CAAC;YACH,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC9C;aAAM;YACN,iBAAiB,CAAC,SAAS,CAAC,0EAA0E,CAAC,CAAC;SACxG;QAED,IAAI,IAAI,CAAC,WAAW,EAAE;YACrB,MAAM,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;YAClC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;YACjC,mBAAmB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YAEpC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;SACtB;KACD;IAED,UAAU;QACT,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE;YACtD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,SAAS,CAAC,8FAA8F,CAAC,CAAC;aAC5H;YACD,OAAO;SACP;QAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,iEAAiE,CAAC,CAAC;SAC/F;QAED,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACtB,OAAO;SACP;QAED,MAAM,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;QAClC,mBAAmB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAEpC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;QAE5B,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;KAC9B;;;;IAKD,MAAM;QACL,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACtB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,SAAS,CAAC,yBAAyB,CAAC,CAAC;aACvD;YACD,OAAO;SACP;QAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,+BAA+B,aAAa,CAAC,IAAI,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;SAClG;;QAGD,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;QAEjC,MAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QACjC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;QAC5B,OAAO,SAAS,CAAC;KACjB;;;;IAKD,MAAM,CAAC,GAAsB,EAAE,cAA8B;QAC5D,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,+BAA+B,aAAa,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;SAC5F;QAED,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC;;QAGrB,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC;QACvC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;QACnC,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC;QACtC,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,CAAC;QAExC,IAAI,CAAC,gBAAgB,CAAC,yBAAyB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAC5D;;;;;IAOD,YAAY,CAAC,cAA8B,EAAE,QAAyC;QACrF,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QACrE,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YACjB,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,WAAW,CAAC,6CAA6C,CAAC,CAAC;aAC7E;YACD,OAAO;SACP;QAED,IAAI,CAAC,MAAM,CAAC,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC;QACjD,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;QAErF,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE;YACpD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;gBACrC,iBAAiB,CAAC,SAAS,CAAC,0FAA0F,CAAC,CAAC;aACxH;YACD,IAAI,CAAC,gBAAgB,CAAC,yBAAyB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC5D;QAED,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,qCAAqC,aAAa,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;SAClG;QAED,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC;QAEtC,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,CAAC;QAExC,QAAQ,GAAG,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC;QAErC,IAAI,CAAC,mBAAmB,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC;QACnD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;KAClD;IAEO,mBAAmB,CAAC,cAA8B,EAAE,cAAwC;QACnG,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,mDAAmD,GAAG,gDAAgD,CAAC,CAAC;SACpI;QAED,MAAM,OAAO,GAAG,IAAI,CAAC,mBAAmB,CAAC,cAAc,EAAE,cAAc,CAAC,CAAC;QACzE,MAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC;YAC7B,YAAY,EAAE,IAAI;YAClB,aAAa,EAAE,OAAO,CAAC,aAAa;SACpC,CAAC,CAAC;QAEH,MAAM,aAAa,GAAG,IAAI,GAAG,CAAC,EAAE,CAAC,CAAC;QAClC,MAAM,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC;YAChC,SAAS,EAAE;gBACV,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE;gBACjC,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC,KAAK,EAAE;gBACxC,EAAE,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,SAAS,CAAC,cAAc,CAAC,EAAE;gBAC/D,EAAE,OAAO,EAAE,cAAc,EAAE,QAAQ,EAAE,cAAc,EAAE;gBACrD,EAAE,OAAO,EAAE,sBAAsB,EAAE,QAAQ,EAAE,IAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE;aACzG;YACD,MAAM,EAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ;SAC9B,CAAC,CAAC;QAEH,MAAM,aAAa,GAAG,IAAI,oBAAoB,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;QACxE,MAAM,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC,qBAAqB,EAAE,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,aAAa,EAAE,EAAE,CAAC,CAAC;QACrH,SAAS,CAAC,SAAS,CAAC,MAAM,aAAa,CAAC,OAAO,EAAE,CAAC,CAAC;QACnD,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC;QAEnC,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC,QAAQ,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QAC7D,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,IAAI,CAAC,SAAS,EAAE,EAAE,cAAc,EAAE,CAAC,CAAC;QAEnE,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,GAAG,SAAS,CAAC;KAC5C;IAGO,mBAAmB,CAAC,IAAU,EAAE,YAA+B,EAAE,iBAAiB;;QAEzF,MAAM,aAAa,GAAG,YAAY,CAAC,QAAQ,CAAC,aAAa,CAAC;;QAE1D,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,aAAa,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;;QAE/D,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;QAE/C,MAAM,qBAAqB,GAAS,MAAO,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAmB;YACjF,IAAI,IAAI,CAAC,gBAAgB,EAAE;gBAC1B,IAAI,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBAC3D,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;aAC7C;SACD,CAAC,CAAC;;;;;;;;;;QAWH,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,kBAAkB,EAAE,qBAAqB,CAAC,CAAC;QACxD,YAAY,CAAC,SAAS,CAAC;YACtB,IAAI,IAAI,EAAE;gBACT,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,EAAE,qBAAqB,CAAC,CAAC;gBACzD,IAAI,GAAG,IAAI,CAAC;aACZ;SACD,CAAC,CAAC;QAEH,MAAM,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;QAG1E,IAAI,UAAU,CAAC,YAAY,EAAE;YAC5B,MAAM,aAAa,GAAG,MACrB,UAAU,CAAC;gBACV,IAAI,IAAI,CAAC,MAAM,EAAE;oBAChB,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC9D;aACD,CAAC,CAAC;YAEJ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,aAAa,CAAC,CAAC;SAChD;QAED,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;YACnB,MAAM;gBACL,OAAO,IAAI,CAAC;aACZ;YACD,OAAO,EAAE,iBAAiB;YAC1B,YAAY,EAAE,UAAU,CAAC,YAAY;YACrC,QAAQ,EAAE,UAAU,CAAC,QAAQ;YAC7B,UAAU,EAAE,UAAU,CAAC,UAAU;SACjC,CAAC,CAAC;KACH;;;;IAKO,kBAAkB,CAAC,cAA8B;QACxD,MAAM,KAAK,GAAG,EAAE,CAAC;QACjB,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QACpC,IAAI,YAAY,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC;QAEjC,OAAO,YAAY,EAAE;YACpB,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,UAAU;gBACxC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aACvB,CAAC,CAAC;YAEH,MAAM,iBAAiB,GAAG,kCAAkC,CAAC,YAAY,CAAC,CAAC;YAC3E,IAAI,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,CAAC;YAC1E,IAAI,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,SAAS,EAAE,iBAAiB,CAAC,CAAC;YAE5E,IAAI,MAAM,IAAI,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE;gBACnC,iBAAiB,CAAC,yBAAyB,CAAC,GAAG,IAAI,CAAC;gBACpD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;oBACrC,iBAAiB,CAAC,SAAS,CAAC,kCAAkC,GAAG,aAAa,CAAC,iBAAiB,CAAC,CAAC,CAAC;iBACnG;aACD;YAED,YAAY,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC;SAC7B;KACD;IAEO,mBAAmB,CAAC,cAA8B,EAAE,cAAwC;QACnG,MAAM,EAAE,SAAS,EAAE,GAAG,cAAc,CAAC,WAAW,CAAC;QAEjD,OAAO,cAAc,GAAG,cAAc,CAAC,uBAAuB,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC;KAC7I;IAEO,SAAS,CAAC,sBAA8C;QAC/D,MAAM,iBAAiB,GAAG,kCAAkC,CAAC,sBAAsB,CAAC,CAAC;QACrF,MAAM,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,CAAC;QAC5E,IAAI,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,SAAS,EAAE,iBAAiB,CAAC,CAAC;;QAG5E,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,aAAa,EAAE;YAClC,MAAM,eAAe,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;YACzF,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,eAAe,EAAE,iBAAiB,CAAC,MAAM,CAAC,CAAC;YAErF,IAAI,MAAM,EAAE;gBACX,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aAClC;SACD;QAED,OAAO,MAAM,CAAC;KACd;;;YA7VD,SAAS,SAAC,EAAE,QAAQ,EAAE,oBAAoB,EAAE;;;YAjDI,sBAAsB;YAD8G,gBAAgB;yCAoGnG,SAAS,SAAC,MAAM;yCAAiB,SAAS,SAAC,qBAAqB;0CAAgC,SAAS,SAAC,eAAe;YAzFlN,kBAAkB;YAX8B,wBAAwB;YAAxB,wBAAwB;YAA7D,iBAAiB;4CAoGkZ,MAAM,SAAC,YAAY;YAvFjc,oBAAoB;YAbmM,MAAM;YAA/B,UAAU;;;6BA+D/M,MAAM,SAAC,UAAU;+BACjB,MAAM,SAAC,YAAY;;AAgKpB;IADC,OAAO;oDAgCP;AAqCD;IADC,OAAO;2DAwDP;;MCrVW,4BAA6B,SAAQ,gBAAgB;IACjE,YAAoB,gBAAoC;QACvD,KAAK,EAAE,CAAC;QADW,qBAAgB,GAAhB,gBAAgB,CAAoB;QAEvD,IAAI,iBAAiB,CAAC,YAAY,EAAE,EAAE;YACrC,iBAAiB,CAAC,SAAS,CAAC,4CAA4C,CAAC,CAAC;SAC1E;KACD;IAED,QAAQ;QACP,OAAO,SAAS,CAAC;KACjB;IAOD,kBAAkB;QACjB,OAAO,GAAG,CAAC;KACX;IAED,UAAU,CAAC,EAA0B;QACpC,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;KACrC;IAED,YAAY,CAAC,GAA2B,KAAU;IAElD,IAAI,MAAM;QACT,OAAO,EAAE,CAAC;KACV;IACD,IAAI,IAAI;QACP,OAAO,EAAE,CAAC;KACV;IACD,IAAI,QAAQ;QACX,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;KACpC;IACD,IAAI,QAAQ,CAAC,QAAgB;QAC5B,MAAM,IAAI,KAAK,CAAC,6DAA6D,CAAC,CAAC;KAC/E;IAED,SAAS,CAAC,KAAU,EAAE,KAAa,EAAE,GAAW;QAC/C,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;KACzD;IAED,YAAY,CAAC,KAAU,EAAE,KAAa,EAAE,GAAW;QAClD,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;KAC5D;IAED,OAAO;QACN,MAAM,IAAI,KAAK,CAAC,0DAA0D,CAAC,CAAC;KAC5E;IAED,IAAI;QACH,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;KAC7B;;;YAvDD,UAAU;;;YALF,kBAAkB;;;MCQd,sBAAsB;IAElC,YAAoB,IAAU;QAAV,SAAI,GAAJ,IAAI,CAAM;QAC7B,IAAI,IAAI,CAAC,IAAI,EAAE;YACd,IAAI,CAAC,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;YAEjC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE;gBACtB,IAAI,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;oBAC7C,IAAI,CAAC,gBAAgB,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC;iBAClF;aACD,CAAC,CAAC;SACH;KACD;;;YAjBD,SAAS,SAAC;;gBAEV,QAAQ,EAAE,iBAAiB;gBAC3B,QAAQ,EAAE,gEAAgE;aAC1E;;;YANQ,IAAI;;;+BAQX,SAAS,SAAC,gBAAgB,EAAE,EAAE,IAAI,EAAE,gBAAgB,EAAE,MAAM,EAAE,KAAK,EAAE;;;MCN1D,qBAAsB,SAAQ,sBAAsB;IAChE,YAAY,QAAkB,EAAc,MAAqC;QAChF,KAAK,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;QACxB,OAAO,CAAC,GAAG,CAAC,uCAAuC,GAAG,sDAAsD,CAAC,CAAC;KAC9G;;;YALD,UAAU;;;YAFF,QAAQ;YAAgD,4BAA4B,uBAI3D,QAAQ;;;SCoB1B,uBAAuB,CAAC,gBAAoC,EAAE,YAA0B;IACvG,OAAO,gBAAgB,GAAG,gBAAgB,GAAG,IAAI,kBAAkB,CAAC,YAAY,CAAC,CAAC;AACnF,CAAC;MASY,wBAAwB;IACpC,OAAO,OAAO,CAAC,MAAc,EAAE,MAAqB;QACnD,OAAO;YACN,QAAQ,EAAE,wBAAwB;YAClC,SAAS,EAAE;gBACV,GAAG,YAAY,CAAC,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,SAAS;gBACjD;oBACC,OAAO,EAAE,kBAAkB;oBAC3B,UAAU,EAAE,uBAAuB;oBACnC,IAAI,EAAE,CAAC,CAAC,kBAAkB,EAAE,IAAI,QAAQ,EAAE,EAAE,IAAI,QAAQ,EAAE,CAAC,EAAE,YAAY,CAAC;iBAC1E;gBACD,EAAE,OAAO,EAAE,gBAAgB,EAAE,WAAW,EAAE,kBAAkB,EAAE;gBAC9D,4BAA4B;gBAC5B,EAAE,OAAO,EAAE,gBAAgB,EAAE,WAAW,EAAE,4BAA4B,EAAE;gBACxE,gBAAgB;gBAChB,oBAAoB;gBACpB,EAAE,OAAO,EAAE,kBAAkB,EAAE,WAAW,EAAE,oBAAoB,EAAE;aAClE;SACD,CAAC;KACF;IAED,OAAO,QAAQ,CAAC,MAAc;QAC7B,OAAO,EAAE,QAAQ,EAAE,wBAAwB,EAAE,SAAS,EAAE,YAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE,CAAC;KAClG;;;YA9BD,QAAQ,SAAC;gBACT,YAAY,EAAE,CAAC,YAAY,EAAE,kBAAkB,EAAE,gBAAgB,EAAE,sBAAsB,CAAC;gBAC1F,eAAe,EAAE,CAAC,sBAAsB,CAAC;gBACzC,OAAO,EAAE,CAAC,YAAY,EAAE,wBAAwB,CAAC;gBACjD,OAAO,EAAE,CAAC,YAAY,EAAE,YAAY,EAAE,kBAAkB,EAAE,gBAAgB,EAAE,sBAAsB,CAAC;gBACnG,OAAO,EAAE,CAAC,gBAAgB,CAAC;aAC3B;;;AClCD;;ACAA;;;;;;"}