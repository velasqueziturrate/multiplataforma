import { View, LayoutBase, Page, Frame, AbsoluteLayout, ActivityIndicator, BottomNavigation, Button, ContentView, DatePicker, DockLayout, GridLayout, HtmlView, Image, Label, ListPicker, ListView, Placeholder, Progress, ProxyViewContainer, Repeater, ScrollView, SearchBar, SegmentedBar, SegmentedBarItem, Slider, StackLayout, FlexboxLayout, Switch, TabView, TabStrip, TabStripItem, TabContentItem, Tabs, TextField, TextView, TimePicker, WebView, WrapLayout, FormattedString, Span } from '@nativescript/core';
export class InvisibleNode extends View {
    constructor() {
        super();
        this.nodeType = 1;
        this.nodeName = getClassName(this);
    }
    toString() {
        return `${this.nodeName}(${this.id})`;
    }
}
export class CommentNode extends InvisibleNode {
    constructor() {
        super();
        this.meta = {
            skipAddToDom: true,
        };
        this.id = CommentNode.id.toString();
        CommentNode.id += 1;
    }
}
CommentNode.id = 0;
export class TextNode extends InvisibleNode {
    constructor() {
        super();
        this.meta = {
            skipAddToDom: true,
        };
        this.id = TextNode.id.toString();
        TextNode.id += 1;
    }
}
TextNode.id = 0;
const getClassName = (instance) => instance.constructor.name;
const ɵ0 = getClassName;
export function isDetachedElement(element) {
    return element && element.meta && element.meta.skipAddToDom;
}
export function isView(view) {
    return view instanceof View;
}
export function isInvisibleNode(view) {
    return view instanceof InvisibleNode;
}
const elementMap = new Map();
const camelCaseSplit = /([a-z0-9])([A-Z])/g;
const defaultViewMeta = { skipAddToDom: false };
export function registerElement(elementName, resolver, meta) {
    const entry = { resolver, meta };
    elementMap.set(elementName, entry);
    elementMap.set(elementName.toLowerCase(), entry);
    elementMap.set(elementName.replace(camelCaseSplit, '$1-$2').toLowerCase(), entry);
}
export function getViewClass(elementName) {
    const entry = elementMap.get(elementName) || elementMap.get(elementName.toLowerCase());
    if (!entry) {
        throw new TypeError(`No known component for element ${elementName}.`);
    }
    try {
        return entry.resolver();
    }
    catch (e) {
        throw new TypeError(`Could not load view for: ${elementName}.${e}`);
    }
}
export function getViewMeta(nodeName) {
    const entry = elementMap.get(nodeName) || elementMap.get(nodeName.toLowerCase());
    return (entry && entry.meta) || defaultViewMeta;
}
export function isKnownView(elementName) {
    return elementMap.has(elementName) || elementMap.has(elementName.toLowerCase());
}
export function getSingleViewRecursive(nodes, nestLevel) {
    const actualNodes = nodes.filter((node) => !(node instanceof InvisibleNode));
    if (actualNodes.length === 0) {
        throw new Error(`No suitable views found in list template! ` + `Nesting level: ${nestLevel}`);
    }
    else if (actualNodes.length > 1) {
        throw new Error(`More than one view found in list template!` + `Nesting level: ${nestLevel}`);
    }
    const rootLayout = actualNodes[0];
    if (!rootLayout) {
        return getSingleViewRecursive(rootLayout.children, nestLevel + 1);
    }
    const parentLayout = rootLayout.parent;
    if (parentLayout instanceof LayoutBase) {
        let node = rootLayout.parentNode;
        parentLayout.removeChild(rootLayout);
        rootLayout.parentNode = node;
    }
    return rootLayout;
}
const ɵ1 = (parent, child, next) => {
    // Page cannot be added to Frame with _addChildFromBuilder (thwos "use defaultPage" error)
    if (isInvisibleNode(child)) {
        return;
    }
    else if (child instanceof Page) {
        parent.navigate({ create: () => child });
    }
    else {
        throw new Error('Only a Page can be a child of Frame');
    }
};
const frameMeta = {
    insertChild: ɵ1,
};
// Register default NativeScript components
// Note: ActionBar related components are registerd together with action-bar directives.
registerElement('AbsoluteLayout', () => AbsoluteLayout);
registerElement('ActivityIndicator', () => ActivityIndicator);
registerElement('BottomNavigation', () => BottomNavigation);
registerElement('Button', () => Button);
registerElement('ContentView', () => ContentView);
registerElement('DatePicker', () => DatePicker);
registerElement('DockLayout', () => DockLayout);
registerElement('Frame', () => Frame, frameMeta);
registerElement('GridLayout', () => GridLayout);
registerElement('HtmlView', () => HtmlView);
registerElement('Image', () => Image);
// Parse5 changes <Image> tags to <img>. WTF!
registerElement('img', () => Image);
registerElement('Label', () => Label);
registerElement('ListPicker', () => ListPicker);
registerElement('ListView', () => ListView);
registerElement('Page', () => Page);
registerElement('Placeholder', () => Placeholder);
registerElement('Progress', () => Progress);
registerElement('ProxyViewContainer', () => ProxyViewContainer);
registerElement('Repeater', () => Repeater);
registerElement('ScrollView', () => ScrollView);
registerElement('SearchBar', () => SearchBar);
registerElement('SegmentedBar', () => SegmentedBar);
registerElement('SegmentedBarItem', () => SegmentedBarItem);
registerElement('Slider', () => Slider);
registerElement('StackLayout', () => StackLayout);
registerElement('FlexboxLayout', () => FlexboxLayout);
registerElement('Switch', () => Switch);
registerElement('TabView', () => TabView);
registerElement('TabStrip', () => TabStrip);
registerElement('TabStripItem', () => TabStripItem);
registerElement('TabContentItem', () => TabContentItem);
registerElement('Tabs', () => Tabs);
registerElement('TextField', () => TextField);
registerElement('TextView', () => TextView);
registerElement('TimePicker', () => TimePicker);
registerElement('WebView', () => WebView);
registerElement('WrapLayout', () => WrapLayout);
registerElement('FormattedString', () => FormattedString);
registerElement('Span', () => Span);
registerElement('DetachedContainer', () => ProxyViewContainer, {
    skipAddToDom: true,
});
registerElement('page-router-outlet', () => Frame);
export { ɵ0, ɵ1 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWxlbWVudC1yZWdpc3RyeS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL2VsZW1lbnQtcmVnaXN0cnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsaUJBQWlCLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsa0JBQWtCLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLGdCQUFnQixFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsYUFBYSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLFlBQVksRUFBRSxjQUFjLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsZUFBZSxFQUFFLElBQUksRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBa0IzZixNQUFNLE9BQWdCLGFBQWMsU0FBUSxJQUFJO0lBVS9DO1FBQ0MsS0FBSyxFQUFFLENBQUM7UUFFUixJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQztRQUNsQixJQUFJLENBQUMsUUFBUSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNwQyxDQUFDO0lBRUQsUUFBUTtRQUNQLE9BQU8sR0FBRyxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQztJQUN2QyxDQUFDO0NBQ0Q7QUFFRCxNQUFNLE9BQU8sV0FBWSxTQUFRLGFBQWE7SUFHN0M7UUFDQyxLQUFLLEVBQUUsQ0FBQztRQUVSLElBQUksQ0FBQyxJQUFJLEdBQUc7WUFDWCxZ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SCxlQUFlLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLENBQU0sS0FBSyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWaWV3LCBMYXlvdXRCYXNlLCBQYWdlLCBGcmFtZSwgQWJzb2x1dGVMYXlvdXQsIEFjdGl2aXR5SW5kaWNhdG9yLCBCb3R0b21OYXZpZ2F0aW9uLCBCdXR0b24sIENvbnRlbnRWaWV3LCBEYXRlUGlja2VyLCBEb2NrTGF5b3V0LCBHcmlkTGF5b3V0LCBIdG1sVmlldywgSW1hZ2UsIExhYmVsLCBMaXN0UGlja2VyLCBMaXN0VmlldywgUGxhY2Vob2xkZXIsIFByb2dyZXNzLCBQcm94eVZpZXdDb250YWluZXIsIFJlcGVhdGVyLCBTY3JvbGxWaWV3LCBTZWFyY2hCYXIsIFNlZ21lbnRlZEJhciwgU2VnbWVudGVkQmFySXRlbSwgU2xpZGVyLCBTdGFja0xheW91dCwgRmxleGJveExheW91dCwgU3dpdGNoLCBUYWJWaWV3LCBUYWJTdHJpcCwgVGFiU3RyaXBJdGVtLCBUYWJDb250ZW50SXRlbSwgVGFicywgVGV4dEZpZWxkLCBUZXh0VmlldywgVGltZVBpY2tlciwgV2ViVmlldywgV3JhcExheW91dCwgRm9ybWF0dGVkU3RyaW5nLCBTcGFuIH0gZnJvbSAnQG5hdGl2ZXNjcmlwdC9jb3JlJztcblxuZXhwb3J0IGludGVyZmFjZSBWaWV3Q2xhc3Mge1xuXHRuZXcgKCk6IFZpZXc7XG59XG5leHBvcnQgaW50ZXJmYWNlIFZpZXdFeHRlbnNpb25zIHtcblx0bWV0YTogVmlld0NsYXNzTWV0YTtcblx0bm9kZVR5cGU6IG51bWJlcjtcblx0bm9kZU5hbWU6IHN0cmluZztcblx0cGFyZW50Tm9kZTogTmdWaWV3O1xuXHRuZXh0U2libGluZzogTmdWaWV3O1xuXHRmaXJzdENoaWxkOiBOZ1ZpZXc7XG5cdGxhc3RDaGlsZDogTmdWaWV3O1xuXHRuZ0Nzc0NsYXNzZXM6IE1hcDxzdHJpbmcsIGJvb2xlYW4+O1xufVxuXG5leHBvcnQgdHlwZSBOZ1ZpZXcgPSBWaWV3ICYgVmlld0V4dGVuc2lvbnM7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBJbnZpc2libGVOb2RlIGV4dGVuZHMgVmlldyBpbXBsZW1lbnRzIE5nVmlldyB7XG5cdG1ldGE6IHsgc2tpcEFkZFRvRG9tOiBib29sZWFuIH07XG5cdG5vZGVUeXBlOiBudW1iZXI7XG5cdG5vZGVOYW1lOiBzdHJpbmc7XG5cdHBhcmVudE5vZGU6IE5nVmlldztcblx0bmV4dFNpYmxpbmc6IE5nVmlldztcblx0Zmlyc3RDaGlsZDogTmdWaWV3O1xuXHRsYXN0Q2hpbGQ6IE5nVmlldztcblx0bmdDc3NDbGFzc2VzOiBNYXA8c3RyaW5nLCBib29sZWFuPjtcblxuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHRzdXBlcigpO1xuXG5cdFx0dGhpcy5ub2RlVHlwZSA9IDE7XG5cdFx0dGhpcy5ub2RlTmFtZSA9IGdldENsYXNzTmFtZSh0aGlzKTtcblx0fVxuXG5cdHRvU3RyaW5nKCkge1xuXHRcdHJldHVybiBgJHt0aGlzLm5vZGVOYW1lfSgke3RoaXMuaWR9KWA7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbW1lbnROb2RlIGV4dGVuZHMgSW52aXNpYmxlTm9kZSB7XG5cdHByb3RlY3RlZCBzdGF0aWMgaWQgPSAwO1xuXG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHN1cGVyKCk7XG5cblx0XHR0aGlzLm1ldGEgPSB7XG5cdFx0XHRza2lwQWRkVG9Eb206IHRydWUsXG5cdFx0fTtcblx0XHR0aGlzLmlkID0gQ29tbWVudE5vZGUuaWQudG9TdHJpbmcoKTtcblx0XHRDb21tZW50Tm9kZS5pZCArPSAxO1xuXHR9XG59XG5cbmV4cG9ydCBjbGFzcyBUZXh0Tm9kZSBleHRlbmRzIEludmlzaWJsZU5vZGUge1xuXHRwcm90ZWN0ZWQgc3RhdGljIGlkID0gMDtcblxuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHRzdXBlcigpO1xuXG5cdFx0dGhpcy5tZXRhID0ge1xuXHRcdFx0c2tpcEFkZFRvRG9tOiB0cnVlLFxuXHRcdH07XG5cdFx0dGhpcy5pZCA9IFRleHROb2RlLmlkLnRvU3RyaW5nKCk7XG5cdFx0VGV4dE5vZGUuaWQgKz0gMTtcblx0fVxufVxuXG5jb25zdCBnZXRDbGFzc05hbWUgPSAoaW5zdGFuY2UpID0+IGluc3RhbmNlLmNvbnN0cnVjdG9yLm5hbWU7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmlld0NsYXNzTWV0YSB7XG5cdHNraXBBZGRUb0RvbT86IGJvb2xlYW47XG5cdGluc2VydENoaWxkPzogKHBhcmVudDogYW55LCBjaGlsZDogYW55LCBuZXh0PzogYW55KSA9PiB2b2lkO1xuXHRyZW1vdmVDaGlsZD86IChwYXJlbnQ6IGFueSwgY2hpbGQ6IGFueSkgPT4gdm9pZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRGV0YWNoZWRFbGVtZW50KGVsZW1lbnQpOiBib29sZWFuIHtcblx0cmV0dXJuIGVsZW1lbnQgJiYgZWxlbWVudC5tZXRhICYmIGVsZW1lbnQubWV0YS5za2lwQWRkVG9Eb207XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZpZXcodmlldzogYW55KTogdmlldyBpcyBOZ1ZpZXcge1xuXHRyZXR1cm4gdmlldyBpbnN0YW5jZW9mIFZpZXc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0ludmlzaWJsZU5vZGUodmlldzogYW55KTogdmlldyBpcyBJbnZpc2libGVOb2RlIHtcblx0cmV0dXJuIHZpZXcgaW5zdGFuY2VvZiBJbnZpc2libGVOb2RlO1xufVxuXG5leHBvcnQgdHlwZSBWaWV3UmVzb2x2ZXIgPSAoKSA9PiBhbnk7XG5cbmNvbnN0IGVsZW1lbnRNYXAgPSBuZXcgTWFwPHN0cmluZywgeyByZXNvbHZlcjogVmlld1Jlc29sdmVyOyBtZXRhPzogVmlld0NsYXNzTWV0YSB9PigpO1xuY29uc3QgY2FtZWxDYXNlU3BsaXQgPSAvKFthLXowLTldKShbQS1aXSkvZztcbmNvbnN0IGRlZmF1bHRWaWV3TWV0YTogVmlld0NsYXNzTWV0YSA9IHsgc2tpcEFkZFRvRG9tOiBmYWxzZSB9O1xuXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJFbGVtZW50KGVsZW1lbnROYW1lOiBzdHJpbmcsIHJlc29sdmVyOiBWaWV3UmVzb2x2ZXIsIG1ldGE/OiBWaWV3Q2xhc3NNZXRhKTogdm9pZCB7XG5cdGNvbnN0IGVudHJ5ID0geyByZXNvbHZlciwgbWV0YSB9O1xuXHRlbGVtZW50TWFwLnNldChlbGVtZW50TmFtZSwgZW50cnkpO1xuXHRlbGVtZW50TWFwLnNldChlbGVtZW50TmFtZS50b0xvd2VyQ2FzZSgpLCBlbnRyeSk7XG5cdGVsZW1lbnRNYXAuc2V0KGVsZW1lbnROYW1lLnJlcGxhY2UoY2FtZWxDYXNlU3BsaXQsICckMS0kMicpLnRvTG93ZXJDYXNlKCksIGVudHJ5KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFZpZXdDbGFzcyhlbGVtZW50TmFtZTogc3RyaW5nKTogYW55IHtcblx0Y29uc3QgZW50cnkgPSBlbGVtZW50TWFwLmdldChlbGVtZW50TmFtZSkgfHwgZWxlbWVudE1hcC5nZXQoZWxlbWVudE5hbWUudG9Mb3dlckNhc2UoKSk7XG5cdGlmICghZW50cnkpIHtcblx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKGBObyBrbm93biBjb21wb25lbnQgZm9yIGVsZW1lbnQgJHtlbGVtZW50TmFtZX0uYCk7XG5cdH1cblxuXHR0cnkge1xuXHRcdHJldHVybiBlbnRyeS5yZXNvbHZlcigpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0dGhyb3cgbmV3IFR5cGVFcnJvcihgQ291bGQgbm90IGxvYWQgdmlldyBmb3I6ICR7ZWxlbWVudE5hbWV9LiR7ZX1gKTtcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Vmlld01ldGEobm9kZU5hbWU6IHN0cmluZyk6IFZpZXdDbGFzc01ldGEge1xuXHRjb25zdCBlbnRyeSA9IGVsZW1lbnRNYXAuZ2V0KG5vZGVOYW1lKSB8fCBlbGVtZW50TWFwLmdldChub2RlTmFtZS50b0xvd2VyQ2FzZSgpKTtcblx0cmV0dXJuIChlbnRyeSAmJiBlbnRyeS5tZXRhKSB8fCBkZWZhdWx0Vmlld01ldGE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0tub3duVmlldyhlbGVtZW50TmFtZTogc3RyaW5nKTogYm9vbGVhbiB7XG5cdHJldHVybiBlbGVtZW50TWFwLmhhcyhlbGVtZW50TmFtZSkgfHwgZWxlbWVudE1hcC5oYXMoZWxlbWVudE5hbWUudG9Mb3dlckNhc2UoKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTaW5nbGVWaWV3UmVjdXJzaXZlKG5vZGVzOiBBcnJheTxhbnk+LCBuZXN0TGV2ZWw6IG51bWJlcik6IFZpZXcge1xuXHRjb25zdCBhY3R1YWxOb2RlcyA9IG5vZGVzLmZpbHRlcigobm9kZSkgPT4gIShub2RlIGluc3RhbmNlb2YgSW52aXNpYmxlTm9kZSkpO1xuXG5cdGlmIChhY3R1YWxOb2Rlcy5sZW5ndGggPT09IDApIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoYE5vIHN1aXRhYmxlIHZpZXdzIGZvdW5kIGluIGxpc3QgdGVtcGxhdGUhIGAgKyBgTmVzdGluZyBsZXZlbDogJHtuZXN0TGV2ZWx9YCk7XG5cdH0gZWxzZSBpZiAoYWN0dWFsTm9kZXMubGVuZ3RoID4gMSkge1xuXHRcdHRocm93IG5ldyBFcnJvcihgTW9yZSB0aGFuIG9uZSB2aWV3IGZvdW5kIGluIGxpc3QgdGVtcGxhdGUhYCArIGBOZXN0aW5nIGxldmVsOiAke25lc3RMZXZlbH1gKTtcblx0fVxuXG5cdGNvbnN0IHJvb3RMYXlvdXQgPSBhY3R1YWxOb2Rlc1swXTtcblx0aWYgKCFyb290TGF5b3V0KSB7XG5cdFx0cmV0dXJuIGdldFNpbmdsZVZpZXdSZWN1cnNpdmUocm9vdExheW91dC5jaGlsZHJlbiwgbmVzdExldmVsICsgMSk7XG5cdH1cblxuXHRjb25zdCBwYXJlbnRMYXlvdXQgPSByb290TGF5b3V0LnBhcmVudDtcblx0aWYgKHBhcmVudExheW91dCBpbnN0YW5jZW9mIExheW91dEJhc2UpIHtcblx0XHRsZXQgbm9kZSA9IHJvb3RMYXlvdXQucGFyZW50Tm9kZTtcblx0XHRwYXJlbnRMYXlvdXQucmVtb3ZlQ2hpbGQocm9vdExheW91dCk7XG5cdFx0cm9vdExheW91dC5wYXJlbnROb2RlID0gbm9kZTtcblx0fVxuXG5cdHJldHVybiByb290TGF5b3V0O1xufVxuXG5jb25zdCBmcmFtZU1ldGE6IFZpZXdDbGFzc01ldGEgPSB7XG5cdGluc2VydENoaWxkOiAocGFyZW50OiBGcmFtZSwgY2hpbGQ6IE5nVmlldywgbmV4dDogYW55KSA9PiB7XG5cdFx0Ly8gUGFnZSBjYW5ub3QgYmUgYWRkZWQgdG8gRnJhbWUgd2l0aCBfYWRkQ2hpbGRGcm9tQnVpbGRlciAodGh3b3MgXCJ1c2UgZGVmYXVsdFBhZ2VcIiBlcnJvcilcblx0XHRpZiAoaXNJbnZpc2libGVOb2RlKGNoaWxkKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH0gZWxzZSBpZiAoY2hpbGQgaW5zdGFuY2VvZiBQYWdlKSB7XG5cdFx0XHRwYXJlbnQubmF2aWdhdGUoeyBjcmVhdGU6ICgpID0+IGNoaWxkIH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09ubHkgYSBQYWdlIGNhbiBiZSBhIGNoaWxkIG9mIEZyYW1lJyk7XG5cdFx0fVxuXHR9LFxufTtcblxuLy8gUmVnaXN0ZXIgZGVmYXVsdCBOYXRpdmVTY3JpcHQgY29tcG9uZW50c1xuLy8gTm90ZTogQWN0aW9uQmFyIHJlbGF0ZWQgY29tcG9uZW50cyBhcmUgcmVnaXN0ZXJkIHRvZ2V0aGVyIHdpdGggYWN0aW9uLWJhciBkaXJlY3RpdmVzLlxucmVnaXN0ZXJFbGVtZW50KCdBYnNvbHV0ZUxheW91dCcsICgpID0+IEFic29sdXRlTGF5b3V0KTtcbnJlZ2lzdGVyRWxlbWVudCgnQWN0aXZpdHlJbmRpY2F0b3InLCAoKSA9PiBBY3Rpdml0eUluZGljYXRvcik7XG5yZWdpc3RlckVsZW1lbnQoJ0JvdHRvbU5hdmlnYXRpb24nLCAoKSA9PiBCb3R0b21OYXZpZ2F0aW9uKTtcbnJlZ2lzdGVyRWxlbWVudCgnQnV0dG9uJywgKCkgPT4gQnV0dG9uKTtcbnJlZ2lzdGVyRWxlbWVudCgnQ29udGVudFZpZXcnLCAoKSA9PiBDb250ZW50Vmlldyk7XG5yZWdpc3RlckVsZW1lbnQoJ0RhdGVQaWNrZXInLCAoKSA9PiBEYXRlUGlja2VyKTtcbnJlZ2lzdGVyRWxlbWVudCgnRG9ja0xheW91dCcsICgpID0+IERvY2tMYXlvdXQpO1xucmVnaXN0ZXJFbGVtZW50KCdGcmFtZScsICgpID0+IDxhbnk+RnJhbWUsIGZyYW1lTWV0YSk7XG5yZWdpc3RlckVsZW1lbnQoJ0dyaWRMYXlvdXQnLCAoKSA9PiBHcmlkTGF5b3V0KTtcbnJlZ2lzdGVyRWxlbWVudCgnSHRtbFZpZXcnLCAoKSA9PiBIdG1sVmlldyk7XG5yZWdpc3RlckVsZW1lbnQoJ0ltYWdlJywgKCkgPT4gSW1hZ2UpO1xuLy8gUGFyc2U1IGNoYW5nZXMgPEltYWdlPiB0YWdzIHRvIDxpbWc+LiBXVEYhXG5yZWdpc3RlckVsZW1lbnQoJ2ltZycsICgpID0+IEltYWdlKTtcbnJlZ2lzdGVyRWxlbWVudCgnTGFiZWwnLCAoKSA9PiBMYWJlbCk7XG5yZWdpc3RlckVsZW1lbnQoJ0xpc3RQaWNrZXInLCAoKSA9PiBMaXN0UGlja2VyKTtcbnJlZ2lzdGVyRWxlbWVudCgnTGlzdFZpZXcnLCAoKSA9PiBMaXN0Vmlldyk7XG5yZWdpc3RlckVsZW1lbnQoJ1BhZ2UnLCAoKSA9PiBQYWdlKTtcbnJlZ2lzdGVyRWxlbWVudCgnUGxhY2Vob2xkZXInLCAoKSA9PiBQbGFjZWhvbGRlcik7XG5yZWdpc3RlckVsZW1lbnQoJ1Byb2dyZXNzJywgKCkgPT4gUHJvZ3Jlc3MpO1xucmVnaXN0ZXJFbGVtZW50KCdQcm94eVZpZXdDb250YWluZXInLCAoKSA9PiBQcm94eVZpZXdDb250YWluZXIpO1xucmVnaXN0ZXJFbGVtZW50KCdSZXBlYXRlcicsICgpID0+IFJlcGVhdGVyKTtcbnJlZ2lzdGVyRWxlbWVudCgnU2Nyb2xsVmlldycsICgpID0+IFNjcm9sbFZpZXcpO1xucmVnaXN0ZXJFbGVtZW50KCdTZWFyY2hCYXInLCAoKSA9PiBTZWFyY2hCYXIpO1xucmVnaXN0ZXJFbGVtZW50KCdTZWdtZW50ZWRCYXInLCAoKSA9PiBTZWdtZW50ZWRCYXIpO1xucmVnaXN0ZXJFbGVtZW50KCdTZWdtZW50ZWRCYXJJdGVtJywgKCkgPT4gPGFueT5TZWdtZW50ZWRCYXJJdGVtKTtcbnJlZ2lzdGVyRWxlbWVudCgnU2xpZGVyJywgKCkgPT4gU2xpZGVyKTtcbnJlZ2lzdGVyRWxlbWVudCgnU3RhY2tMYXlvdXQnLCAoKSA9PiBTdGFja0xheW91dCk7XG5yZWdpc3RlckVsZW1lbnQoJ0ZsZXhib3hMYXlvdXQnLCAoKSA9PiBGbGV4Ym94TGF5b3V0KTtcbnJlZ2lzdGVyRWxlbWVudCgnU3dpdGNoJywgKCkgPT4gU3dpdGNoKTtcbnJlZ2lzdGVyRWxlbWVudCgnVGFiVmlldycsICgpID0+IFRhYlZpZXcpO1xucmVnaXN0ZXJFbGVtZW50KCdUYWJTdHJpcCcsICgpID0+IFRhYlN0cmlwKTtcbnJlZ2lzdGVyRWxlbWVudCgnVGFiU3RyaXBJdGVtJywgKCkgPT4gVGFiU3RyaXBJdGVtKTtcbnJlZ2lzdGVyRWxlbWVudCgnVGFiQ29udGVudEl0ZW0nLCAoKSA9PiBUYWJDb250ZW50SXRlbSk7XG5yZWdpc3RlckVsZW1lbnQoJ1RhYnMnLCAoKSA9PiBUYWJzKTtcbnJlZ2lzdGVyRWxlbWVudCgnVGV4dEZpZWxkJywgKCkgPT4gVGV4dEZpZWxkKTtcbnJlZ2lzdGVyRWxlbWVudCgnVGV4dFZpZXcnLCAoKSA9PiBUZXh0Vmlldyk7XG5yZWdpc3RlckVsZW1lbnQoJ1RpbWVQaWNrZXInLCAoKSA9PiBUaW1lUGlja2VyKTtcbnJlZ2lzdGVyRWxlbWVudCgnV2ViVmlldycsICgpID0+IFdlYlZpZXcpO1xucmVnaXN0ZXJFbGVtZW50KCdXcmFwTGF5b3V0JywgKCkgPT4gV3JhcExheW91dCk7XG5yZWdpc3RlckVsZW1lbnQoJ0Zvcm1hdHRlZFN0cmluZycsICgpID0+IDxhbnk+Rm9ybWF0dGVkU3RyaW5nKTtcbnJlZ2lzdGVyRWxlbWVudCgnU3BhbicsICgpID0+IDxhbnk+U3Bhbik7XG5cbnJlZ2lzdGVyRWxlbWVudCgnRGV0YWNoZWRDb250YWluZXInLCAoKSA9PiBQcm94eVZpZXdDb250YWluZXIsIHtcblx0c2tpcEFkZFRvRG9tOiB0cnVlLFxufSk7XG5cbnJlZ2lzdGVyRWxlbWVudCgncGFnZS1yb3V0ZXItb3V0bGV0JywgKCkgPT4gPGFueT5GcmFtZSk7XG4iXX0=